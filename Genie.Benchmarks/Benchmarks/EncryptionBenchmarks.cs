using BenchmarkDotNet.Attributes;
using Genie.Common.Crypto.Adapters.Curve25519;
using Genie.Common.Crypto.Adapters.Pqc;
using NIST.CVP.ACVTS.Libraries.Crypto.Common.PQC.Dilithium;
using NIST.CVP.ACVTS.Libraries.Crypto.Dilithium;
using NIST.CVP.ACVTS.Libraries.Crypto.SHA.NativeFastSha;
using NIST.CVP.ACVTS.Libraries.Math.Entropy;
using NIST.CVP.ACVTS.Libraries.Math;
using Org.BouncyCastle.Crypto;
using Org.BouncyCastle.Crypto.Parameters;
using Org.BouncyCastle.Pqc.Crypto.Crystals.Kyber;
using System.Collections;
using System.Data.HashFunction.CityHash;
using NIST.CVP.ACVTS.Libraries.Crypto.Common.PQC.Kyber;
using NIST.CVP.ACVTS.Libraries.Crypto.Kyber;


namespace Genie.Benchmarks.Benchmarks
{
    public class EncryptionBenchmarks
    {
        private readonly byte[] hash;
        private readonly byte[] ed25519_signed;
        private readonly byte[] ed448_signed;
        private readonly byte[] dilithium5_signed;
        private readonly byte[] dilithium3_signed;
        private readonly byte[] dilithium2_signed;


        private readonly AsymmetricKeyParameter ed448_private;
        private readonly AsymmetricKeyParameter ed448_public;
        
        private readonly AsymmetricKeyParameter ed25519_private;
        private readonly AsymmetricKeyParameter ed25519_public;

        private readonly AsymmetricKeyParameter dilithium5_private;
        private readonly AsymmetricKeyParameter dilithium5_public;

        private readonly AsymmetricKeyParameter dilithium3_private;
        private readonly AsymmetricKeyParameter dilithium3_public;

        private readonly AsymmetricKeyParameter dilithium2_private;
        private readonly AsymmetricKeyParameter dilithium2_public;

        private readonly AsymmetricCipherKeyPair x25519_alice;
        private readonly AsymmetricCipherKeyPair x25519_bob;

        private readonly AsymmetricCipherKeyPair x448_alice;
        private readonly AsymmetricCipherKeyPair x448_bob;

        private readonly AsymmetricCipherKeyPair kyber512_alice;
        private readonly AsymmetricCipherKeyPair kyber512_bob;

        private readonly AsymmetricCipherKeyPair kyber768_alice;
        private readonly AsymmetricCipherKeyPair kyber768_bob;

        private readonly AsymmetricCipherKeyPair kyber1024_alice;
        private readonly AsymmetricCipherKeyPair kyber1024_bob;

        private readonly byte[] x25519_alice_secret = new byte[32];
        private readonly byte[] x448_alice_secret = new byte[2456];
        private readonly ISecretWithEncapsulation kyber512_alice_secret;
        private readonly ISecretWithEncapsulation kyber768_alice_secret;
        private readonly ISecretWithEncapsulation kyber1024_alice_secret;

        private const int threads = 32;


        public EncryptionBenchmarks()
        {
            var cityhash = CityHashFactory.Instance.Create(new CityHashConfig { HashSizeInBits = 64 });
            hash = cityhash.ComputeHash(File.ReadAllBytes(AppDomain.CurrentDomain.BaseDirectory + @"Keys\Alice\Ed25519SigningAdapter.key")).Hash;


            // Ed25519
            ed25519_private = Ed25519Adapter.Import(new Common.Types.GeoCryptoKey
            {
                X509 = File.ReadAllBytes(AppDomain.CurrentDomain.BaseDirectory + @"Keys\Alice\Ed25519SigningAdapter.key"),
                KeyType = Common.Types.GeoCryptoKey.CryptoKeyType.Ed25519,
                IsPrivate = true
            });

            ed25519_public = Ed25519Adapter.Import(new Common.Types.GeoCryptoKey
            {
                X509 = File.ReadAllBytes(AppDomain.CurrentDomain.BaseDirectory + @"Keys\Alice\Ed25519SigningAdapter.cer"),
                KeyType = Common.Types.GeoCryptoKey.CryptoKeyType.Ed25519,
                IsPrivate = false
            });

            ed25519_signed = Ed25519Adapter.Instance.Sign(hash, ed25519_private);
            var ed_result = Ed25519Adapter.Instance.Verify(hash, ed25519_signed, ed25519_public);

            // Ed448
            ed448_private = Ed448Adapter.Import(new Common.Types.GeoCryptoKey
            {
                X509 = File.ReadAllBytes(AppDomain.CurrentDomain.BaseDirectory + @"Keys\Alice\AliceEd448.key"),
                KeyType = Common.Types.GeoCryptoKey.CryptoKeyType.Ed25519,
                IsPrivate = true
            });
            
            ed448_public = Ed448Adapter.Import(new Common.Types.GeoCryptoKey
            {
                X509 = File.ReadAllBytes(AppDomain.CurrentDomain.BaseDirectory + @"Keys\Alice\AliceEd448.cer"),
                KeyType = Common.Types.GeoCryptoKey.CryptoKeyType.Ed25519,
                IsPrivate = false
            });

            ed448_signed = Ed448Adapter.Instance.Sign(hash, ed448_private);
            var ed448_result = Ed448Adapter.Instance.Verify(hash, ed448_signed, ed448_public);


            // Dilthium
            dilithium3_private = DilithiumAdapter.Import(new Common.Types.GeoCryptoKey
            {
                X509 = File.ReadAllBytes(AppDomain.CurrentDomain.BaseDirectory + @"Keys\Alice\DilithiumAdapter.key"),
                KeyType = Common.Types.GeoCryptoKey.CryptoKeyType.Dilithium,
                IsPrivate = true
            });

            dilithium3_public = DilithiumAdapter.Import(new Common.Types.GeoCryptoKey
            {
                X509 = File.ReadAllBytes(AppDomain.CurrentDomain.BaseDirectory + @"Keys\Alice\DilithiumAdapter.cer"),
                KeyType = Common.Types.GeoCryptoKey.CryptoKeyType.Dilithium,
                IsPrivate = false
            });

            dilithium3_signed = DilithiumAdapter.Instance.Sign(hash, dilithium3_private);
            var dil3_result = DilithiumAdapter.Instance.Verify(hash, dilithium3_signed, dilithium3_public);

            dilithium5_private = DilithiumAdapter.Import(new Common.Types.GeoCryptoKey
            {
                X509 = File.ReadAllBytes(AppDomain.CurrentDomain.BaseDirectory + @"Keys\Alice\AliceDilithium5.key"),
                KeyType = Common.Types.GeoCryptoKey.CryptoKeyType.Dilithium,
                IsPrivate = true
            });

            dilithium5_public = DilithiumAdapter.Import(new Common.Types.GeoCryptoKey
            {
                X509 = File.ReadAllBytes(AppDomain.CurrentDomain.BaseDirectory + @"Keys\Alice\AliceDilithium5.cer"),
                KeyType = Common.Types.GeoCryptoKey.CryptoKeyType.Dilithium,
                IsPrivate = false
            });

            dilithium5_signed = DilithiumAdapter.Instance.Sign(hash, dilithium5_private);
            var dil5_result = DilithiumAdapter.Instance.Verify(hash, dilithium5_signed, dilithium5_public);

            dilithium2_private = DilithiumAdapter.Import(new Common.Types.GeoCryptoKey
            {
                X509 = File.ReadAllBytes(AppDomain.CurrentDomain.BaseDirectory + @"Keys\Alice\AliceDilithium2.key"),
                KeyType = Common.Types.GeoCryptoKey.CryptoKeyType.Dilithium,
                IsPrivate = true
            });

            dilithium2_public = DilithiumAdapter.Import(new Common.Types.GeoCryptoKey
            {
                X509 = File.ReadAllBytes(AppDomain.CurrentDomain.BaseDirectory + @"Keys\Alice\AliceDilithium2.cer"),
                KeyType = Common.Types.GeoCryptoKey.CryptoKeyType.Dilithium,
                IsPrivate = false
            });

            dilithium2_signed = DilithiumAdapter.Instance.Sign(hash, dilithium2_private);
            var dil2_result = DilithiumAdapter.Instance.Verify(hash, dilithium2_signed, dilithium2_public);

            // Kyber
            kyber512_alice = KyberAdapter.GenerateKeyPair();
            kyber512_bob = KyberAdapter.GenerateKeyPair();

            kyber768_alice = KyberAdapter.GenerateKeyPair(Org.BouncyCastle.Pqc.Crypto.Crystals.Kyber.KyberParameters.kyber768);
            kyber768_bob = KyberAdapter.GenerateKeyPair(Org.BouncyCastle.Pqc.Crypto.Crystals.Kyber.KyberParameters.kyber768);

            kyber1024_alice = KyberAdapter.GenerateKeyPair(Org.BouncyCastle.Pqc.Crypto.Crystals.Kyber.KyberParameters.kyber1024);
            kyber1024_bob = KyberAdapter.GenerateKeyPair(Org.BouncyCastle.Pqc.Crypto.Crystals.Kyber.KyberParameters.kyber1024);

            kyber512_alice_secret = KyberAdapter.GenerateSecret((KyberPublicKeyParameters)kyber512_bob.Public);
            kyber768_alice_secret = KyberAdapter.GenerateSecret((KyberPublicKeyParameters)kyber768_bob.Public);
            kyber1024_alice_secret = KyberAdapter.GenerateSecret((KyberPublicKeyParameters)kyber1024_bob.Public);


            // X25519
            x25519_alice = X25519Adapter.GenerateKeyPair();
            x25519_bob = X25519Adapter.GenerateKeyPair();
            var priv = (X25519PrivateKeyParameters)x25519_alice.Private;
            priv.GenerateSecret((X25519PublicKeyParameters)x25519_bob.Public, x25519_alice_secret, 0);

            // X448
            x448_alice = X448Adapter.GenerateKeyPair();
            x448_bob = X448Adapter.GenerateKeyPair();
            var priv2 = (X448PrivateKeyParameters)x448_alice.Private;
            priv2.GenerateSecret((X448PublicKeyParameters)x448_bob.Public, x448_alice_secret, 0);

        }

        private void SetupKyber()
        {

        }

        [Benchmark]
        public void Nist_Dilithium2_KeyGeneration()
        {
            var seed = new BitArray(new BitString(@"fee3fc48931edc08ea5490fcc3f21745719488129bd78cedb3f7e073e1cfd5f3").ToBytes(true));

            var dilithium = new Dilithium(new NIST.CVP.ACVTS.Libraries.Crypto.Common.PQC.Dilithium.DilithiumParameters(DilithiumParameterSet.ML_DSA_44), new NativeShaFactory(), new EntropyProvider(new Random800_90()));

            var key = dilithium.GenerateKey(seed);

        }

        [Benchmark]
        public void Nist_Dilithium2_Signing()
        {
            var message = new BitArray(new BitString("d36af2ae36e15e26779b916d2e9580af5c2aaebe33428e9990f305944d61f9319ebb8b4447bfd4b1df14af17e76578aac85f1ca38a64bea8ad929ba77ec94887bf6cd1f8efdf071a52517cb9ed5e6f17a8f29bce94af19c8d8ca8704677e27bfc111d58f8df665e8efb8a9e33ac06281c5427d7c5f42da7d58a6e7bb323f3064c1e38fdbfb98d603724567fc1fd6384aacdb62de93c30abb0b7f73b5ac16185ca6a40615a8910bc03b4f37b57ec072716e9a850e13def7cd0fe1909c19322e67aad5faa5698ddae1502253a14587b3599d5e29c5aa0aa3627c11a155bfa929671b296736aa20cfcfbd66636ecd2904aaff208e32b23908bbb0af5289b1c6e4d4550412acc9701ea6702417077d5f44e2791d48b444304d2b176355bd31b609a91aa2d27cc635bee298600e7ae554638b81dfe27d8e46ace8bf642810c6cb2c1a230472a077defd3b8c04acbcea50e279dede27d40e24bb54ddb6a8d41d69a2e0713fbb7e87dbaf4e48014a0a4e2f3f3ccd3a9db11ffad38dacacd7264bf937a1d1bca032abae0d548433042ba140201f0f7953331b877d02f03ace8552863c9d52292ee9496f62d753b6dd829dd5e59b2f84c5e7ea84d454fb6de1ad2b60db065d86c17b5b91acf3a659a8a97fcd93beedee9eefec101cfedfaf42ccd96a237fccc681b34cf5014a4e6a8cf9f7f0ec1494f75701c4c4bf72ffa78021fae6d3dbbe9a07d75dd375696d13fe99d0920d66efbd45f71d807ac76d345041d73cece28c6ad4a14bb9eba1c6b712f70fd364a97f6171567bca59122477ec86faef326f44d6548da5b822ee1c4d529e80f6ebb0eb483b27e666406f5a9637cc890308f84dc97c5f5e350ebd858c4fc301edac99f3a5f160ff79744596fa509f2f3639f63761d864c3d653b591a6d37c2d6d4011f91daed828d896c18ecb340067b432ab0fe32dadfbb658500ae28b57fdad0beaa04ea34a76d585a639df40d3a9000bdd4dc405f4103d8f79b8151648f11eeac0720693199bf1e576ed5e848976a08bed94781d59de8f6da6c8b2e0b09330479456f642d0c6a5dc3280d5874dbd887c16e2885f400401a9142edf3fdd813666933254b822fd4b51f69a7395ef80811de7bac89cad69ef40d76024854ae97e4de062d403181d458b26bef1205cef2a75d6aac6cb4912fd2ff50749e13256bb56b20add97d4614f62a73236279ef4985f5de9591ae0a70cc66e9e29fde2129663dc52c48aa00ad734b0c34402daa7642a77a7b54cdd72af7db783ea900f9cac299d959700b7e9b6fafe5929654c904165f2a068b737048738e37d2e68a1b80489e53998c1e6b7ed5cc80eb5957ac97155a466bf49f25c0a87f664fcdf37d7fa77cd8ace96ace8f3fbb60123925b5fc9c112afbbcae7cffd8a734bd9aad814d467908aaaa9d7ea328b30434668da126f8cfeb69c8c2ce6453a607dc37cf6594169abb7af1d15db2015c4445e5b2bfb3e9ebc2b69a4729986c4d4e760e2e4c7c55e06ce9e142e15d3391d8ffd93e8f4fc88c308ddabd67754d39638833e7889b36cc2295e1fa9faa15b414bbe71416afb7b1e79faf112876cc941e20d55bd1e0680eead216bef1a39c2d324471da16e1c70218ac9818250488fade7868bcc7729fff26e7e4c74dc091a85646990fe63c5b37e988c248c47710f02537a7fef5c2779c3f9242eb3400af1ecd315d03762f4f0d670ab6d48454639ec52554bcc487c1d5a6b01bb0fc5b2253708d14e5075b5fd9ffdcf69cfa7471f27b7efb528c50f4ed9a3757de947aa76e7c536a5fae158f17b89174ca2c5706b51bb81c4c2a8265be04bdd50726ad88b40d6123605d074d5874dff7ca160b10bced3af64006d2c0be1f210dc239ece802c1769fab7d7e1912a898cd94cc4f09ccdba9a49e882c3ad5ebfc6a5073155a92ab3f040a4fdab2d9e1ecd1d558c8ad8d19d4f9eea8c5504bcb19879a03401266a9bca20adc8a25dfb1f4da946611c20498bc6ddd5587b7d491fd67d57b3a84856787f3f0cf7bd162046b9ec0e057fe1176abe611f9041d61d221b078d8092ac5690f0f4ae44dbb75cf0c13a5fb6d942d307ab114eb9a65d3c830177c0806818ece3d715c51f03861763d791ad908455b025400bf4ff9cfd1888c496af64332f5f7882e9738a433c9f25499a644a9625599708d0de2eb71c6866d83d608a14dbf1134b68d2605075e868703e8244f7c968e3b309ba1e7b66c6d326148bc8cf2a5f58799fd34cb68e834182f246eea09607d603ad8d00e95d37234db5aa18234703299437d6834b430394874cb25f7bd80f1627e6cd2e9cda476339862638860d9a1e710f9ab66360adaf647c03a6cc1d9a12ef234c18e46a90f5479d31b2e2c6bd7085cde14dbe0c98966656faf1551793ab2b71cd436ea8de97c4130d9b46e75e752548b462a08dbf570db9ffd771d4ee0eb7d6a82c70b6835db4b7197efc5fff012eb9e284c6a1401968e92f6493d04a0f952a8776a7a2987a277f13408b45e1b0427f35493a1147decffccab5127ef1b361003a1cad4c5eab09035acb8e02f9c34a3699967a38f6ce47e12c0c26c8d25cd26e0d27795f2bac8e724197ba3d5bcf0c65db7933ce0d36615cec14ea9eea3c34f1ce1838411d6561664b1696268f528b9255155ae58c8ed161141de399cea89896c8a8f90ffa79fce96f8f4c25dbd78a9c60a041526158c3e8b8c8396bcdcc897161afdd58771578c4d7c6d59062a361c610f635cd50bd54c610888346827fdc9a7253b64d68945b7a244284dd938a0108e61f1e90a7b0a40620b983cd9b133d06da1ce74399181543698d81394d139871b5c8907c959a90696b6e4a4c5b5696504a99600382755c5026b54f068b62c000da7d2041f62f66c81b0418e3482d4e8a44b99f4a729a2d52726753462220fac617ebb3f6b038cd3b4cf2935717216b16144e7f54c9cdf4f7ce4f5e3bc98880d6094b6432f40b965e5485b5b2d0c75a356578a31fd0396ce405bfbf136ca0153c7617fce7812e51e834e36df86dbbb4b3a0a1db2955ee5ebd9c975c90cb228c49ce0c015f571d9cc22dc7ecfe79a8db3b3321b35d8893b34663446b2e660bb76f78c241279e7fdb2770df6e0da0f3cea28139b1f8ca66e46c848e2051c2aae8148f962356b2adb33af95fee608ee7aab1ac835853566fa587").ToBytes(true));
            var sk = new BitString("f863329408f6689cad60bc2d764ac5908a26c0733f92958bf0333388135a2bdd73431f0b8a5bc7e293e99cf1c7690dfcc3b776c79f0442630b220ced9845d4a6980d82abb670bcee7a475cb5b10fac87d8c9fde76cd1ed8019cd3eced883da7cf4bc6ed8b4a01ceaae035fb6b5d8a43ef8f026031cf5859e4a9fcdf806d3dcd6c8004c12234a431404dc40311a4222a1b80412b32463c644d0a681032911c99089a4360ec0103112a041c8b87019210d084251422886c3384e48344812116563101244c80161206a9ab20004370d54468812870d64125223b9881a078cc344100c006a49128e9814695a2046402042c33200a290301c44251823301bb3105b382ae2c88090323004a14053068d00304a1b22495ab6218c144c4a929188168a09384e0b214e0cb53099300d19496d1b10228c143098a88ccb946588006912b14852964918496c00092584a40d5938692049241c4120c11401639860a4b650e2824460444583402203914500a00dca486cda386c1a440164946112296a181120541200cb082a82448c94004814b44d48984da03262483688020111c2246892200cdaa04d9118069402840b08840b19246498510b39890a266d02084d8b28514c8411c92491dc228e10110914192a54287211101190306222c58da24604d1388683247004450e98b2851a967163a85102206a1a24840430401b942849a88111456cc32810d23271e30806cb348608244e23080a138441c39468120640cc36081349441ca00c0a4786489220a2c020ca488403126023c365421650812061da90082187440444925cc485c1060211464dd4346a1194650c4281190312d2946d8c906000830c1ba268102261021901c146610c4760523488409049089889a1c28851a231134570820606e0b84582a60d9c906c59025019496c03956160b88c1028291aa621e114501287700b4012a016485c202d4c3401982080a144601989280bc54c13c7205b404288c025220044ca20460a26050b3786c3126108018292c091cb4605c88604a2a4081a1526c8041284862522c624130950e0c040030584e4b04c8a04414a364e08018850104a4a42314a345012814148920c94144c0ab60803204dd13449ccc20953b83001274dc82491633050ccc48851448490328159424292224c89a604411211043666882824da262e8aa64d1a136912064de0262e8bb645019109d92841a3b48882428cca44240bb8111aa004d2b285db96918a02668a826084bc670a720b0b08d72bac481b3cb4b1bccffbbd9c18c0d138e5b6b6fa50072d3adb84ec4ea8329ae26562d7e30fea3fdf35b0aaface8668fbd8ad14b8b8a411a9d2988a3ace0e464370fecbcf911c76370455d1a65ab60b90c573b7e7acf5ef87d67e431a71fae11f943cf68f6857443c803a6261a8b15ed5e9afda8cf3d8e0ebc448b3d5b05eeb57b492d066b12da638ad99829dbabb6956d8764d462cc1dbccf32e5f09c9095ec82bc781556bfb4ac74cd47d7f5f0e4a2941d269803b91eed12a2ceebcffec5289fa8326a59cfd997a31b1b69a28a18979aec81bef500d205a2dc14f9216622f7b204ab5577ef8a691d4a7adb992e222e103f853de59d948c5d0f77417ae44cd7a35155e34b8730648e9deb9d2c34e17e66666fd4097caddfdc3afde71403c64bbd7e57b2a5e77c5f4e6b2cf37a74aba68adcb4e7a8df8c804f44f420ac1fd8fd25f1481a40f444f244baaf5078608c79f793b7657c7d7bf2270a7fc62eddab73c9ea87e149537ab3fafc5ac98d7bf31cd354e74ffe2a1e3e8600e74b48c34957aabf83ec1f34c661ff412c7cd571fbd3f9156a45dfcd7a2718c41fe25a90f4977158a9156d7f992ced2fb449af3aba852753f7eeced3e87a137ae63737aae5d579ba58084d37fd59be9812c51bf3e523ec7024ec90b5d5466ddc58dd8c35298c3b7692df2539f81b7d7a702834088d6d0c36054a954ad4d516e218f1ec6182897da03bcfa7f9ebf4a41b783e3c3029a16fabff668242260f49430cca5cfc969651369037e499924da4b3e4eba44aa74a0105d972168f87097941cb3fe59c557c10aa8119155413ae97846156a2ac7a90ba25cd9a56ef67ffa0490192af6cd2a200bfb7350d24719922656744ec5823554b6f58288f3c7b9b1a5b7fc44c97520f8b3b208bcae8e0b40a07db5cf2d384dffad43d1bfd6cc1577d674dc7c7ebc40c08fe54125844b44f9c1c9f8bcf3c05bb20f92767c06d921682c111bbea5d8fa9ec1ab6194b2d66d0aec97ef3046cba69a04f76defa6ef778e7d22c24ed359dce548e7f82564667d8c2ef377c6b29aced9f0c5f115b6b1e909466d9b6ccf5091d8a4b2187c33770e33766bad63b6a16ddf8dbdf6f52b0e7f2667f20717d3f1f2863e7e04ac492a7ca7aa032c5a2cd7a49719a9fb169b123e5615c8f2f6acf593243883440894a2424f94703761a0b772b321661310f4269c47cad35b2ec5a70fd27f23224f23e7fe65900441948d2071e4940c48dfa746bf1b59930f12e1b6c160fcc8f3c745b5d08e855abce63f884bfda39cf4cc645b062150a13bba88b48ad68d13dda38f788a92b5649e4a3e3a056d9f35d189e76927246aee2709713afc9f28833f3414d4124bce345a13b45652559049cb440560bde0cffd5db785af5b69597d808f64a36ac4349b1d5aa74453fa859cc6cfa681d35d1c6620faadf6fa9285959d77f1be30b4cb87d56cc8a77423f4e99fc5a5d1039f5dbe9fc3db3c12a54ca2344b349deefcd8b3dbdb1f87363161b148280c02aa6f1dcf12672d97d87a6bf163f5da733c7e37689b65fdc835cf068fc619df49a38838ffeabba63a5d44ced86d442907fc9364e9db3c53afe595d62956304cbccaa23fb961ffc7465152422b01643f2d07634815657dc510f10025267761bc5ddc273678080eda422e750d0df36da9b2b6addeea849af187ba76952fdc6c26b10ec4237c185221e3d7b2a665e7f9391ead1330be1e1d68669b549a8d7e62c1e9aa9a5c173dde833e2fb2ecbe9a2764bed549abf7d366ab5b0af866f34f7d3a0ff15e96135d80d42547eb13c8a70280b16f6c4349db840e779531924de1709468671cec553127001c096bdc426f3520a6b8f542cd0a8caae9214402bff04f6695b6997e86e621e7d7d69a210c1a050bc19ec3e56054590c469687e1bd84ec85cf7fafacc74edb7f59c133b784c5039999dd6a4fce40f765a994c13ee710f96c5b25da3abf3d7a16a9972b32fab85115f72b01d250f07bf763afac148706399f5840c7a609a4c04367d471aac8185f9ff1ecdd21fdb644745d532287edbcd14f621865325445c83f571f6151aebebcbb97d2f67210cdbef3e9e2b74e703a88e6ed01971c5cacc2b362554f154ba834824f1913e76f877e2259ef0451a9ca2c71abd9a6102f7e2ab8bf07035460a5865123f50bc2f3a035ceb3b993297e4dee3ac63610f81c87fe809dfed8a63c1cfc46c1fa0df47d8e95729995e8940c440eb68561b804f0fa057b9b840da0ca54532e4666bb3bfd5f7a4e6a78962604ef3eb53ddac4385dc3c5997a77d051b0164507f74cb8800c52d9ff22c4660ac9a2da0d6a1f").ToBytes();

            var dilithium = new Dilithium(new NIST.CVP.ACVTS.Libraries.Crypto.Common.PQC.Dilithium.DilithiumParameters(DilithiumParameterSet.ML_DSA_44), new NativeShaFactory(), new EntropyProvider(new Random800_90()));
            var signature = dilithium.Sign(sk, message, true);

            bool match = "ae6e4b3131896aac05fe30c098eb0bd0a6be379f13752899a1409aaca0015096567a6352c6a0c837b1ef38471d81513ffaa496ee556e55da825f87e55a4cc53ed4e620463d9d20f1d4e57b3363205ac5434de71a6d9f420a5ac5c2edb094967df105ec43e8a1e6fc36e4cb2a8053a888af20c71400c4311ec33f26dfda80c742bbc5a3fbde30c8ed531f6285c095b62b5fc2951b7d1c82d45df0d92868110d1f4d991270e9c69fe0e9aa1dd855ed933c27738ea0c2771f0028175e1769ab23c5f13f3c4166ce612800997d518ac16580b2499e5dde6b96df3672d4ef9934ae1e4af3855b688101592321ee3063acedf7455a7264a33fc8df103072fd62a92194e61ba87c10bce0697d15ce87e81eb70959f3559c6756d45b71fd3c1e49727da2d265e311c11d78cc449b9089cdd98271c7ab63a81d9fec885173089c0ba080b237185c00435318d0dc1b2ee7ae22fa6d471099004eb3dbdfb36cdacc68f2d2ec7fca4c11a815666a2a07a9f2ca60b9274e17a27ca8641cd12dabdae5ccc216585cb491f8d14f53a0dd91a0a72b728674e177c845a224fc93655729564b4fcbdc0a89f2aee7fde2faf7005ad5268072e316d0dd11dab908ba7572a3b447363d13c18f4697cf38582f4cb501ea06b38a00cd4e7e22c267b156efcdb9cfa22eb125fef5c6eae2fc5df890902d72822b5282fed812873d951bd0d69071e01dda69f3bfe3b6218062136483d7037d0d6c66804ab12ce60df28ae706e49cc6d3340ed4f5b58002f5fb8fbeeb415106aa73eab116a93ac587e4f43f6ec3da2ca887880c1dbd6507d071b10ffa332316995592837fb102814a99f4d974ef2565105ebb9a77cc6797cd81e8afa5a2a2e205f83a610597b62e5cfc07ed749fc2ffaa08733019e79db070a5eb2fa69b52b93a7fa2d2fa65ae91e09de9a1049fc95541acb7df21f1819ab6d5f022f61418465e3a48ee2c5ec7763c88b7ad820318e272b4c34fc62a383681f8bb96ab855e720e71e417a76138a197ee77b845214c71176b321591ad0620a7a40ae7bfa7d246d540ca3517f3f980aeb197359400a913995915cb4c7a45f057460d136dbc4ff63bf963910df65869617a6d735824cf75955daf8f3d0150cea6f99635d3949a99e06d99cc4db873916fc029eea697ef06732921eea0460b22f6faf0e65d382dea67dcd8c3f4a3b24c45631bbef80a0036e7a7b951091f1a33b09b8778b1b10f1dcbf7df19e97cb9553154f1bff15ee66af2bc7380a2a897c6e611c00702920124476b853803f182c21e6250d37227092854f8018323da3741bbb7fa237f74179b6707c73cadaa05bee00613ac5e5c136e1cd4608a3bfeba542f7411d7a75a55b99f5d649114c19d56f3cbb139864affb4b25a8d2ad8b69a892347c7ce6ad0f5bb50fe8c3cfe0d609e4656b4b72cab302c12c2fa2e04396d3807a1928b28fc0d9f75950d87e9a13ed627f20c9bc19f0df8918e07f15526ae81bda4125868fe5572e3b70ef5eef4f81d1b764a4cabd9cfecfdad336c2a3cefe133b44dadbb49e5341d081d8af986cc878c0e7dd13c60f98c0c2341bfdb71b58873bc56d374591a28480615849a7b87013abe2e62ce7a1be03797922caf0a12797043b17750f798f802e211cc532390c2a2ab52c874584a4be9d17f17b17a6e62ff0addcd0841d8dfd0720836c795dd7301f94d5547861ad16be8c0fe43b5862e6bb99816d4e183b999573389854a7ce5dc0b67f3bd2d9206eb3a1b994c1559704822a190ef481afd824b48f3c35fee62006ccdc6e80757d6bee957002c5185e9a709ebeaf92ac6f50fad1a3e7826fbb3d2d66621734ce212045c9b8b53d28320f60b7e5c785e628d8a411c5eed26a6d905418afb5d418cc18bc9f054bf7930ad8f532d33b73bb64905d969e315341ba70a2fb7a7e8e062609eb7198fc6e0ab0ac1b7bfaef97edf0228d6458f52b526631b8f5aa3cdcea1f69f7f77fba242633077dbf1c277dd105ccd646b207d7e30366b356d951412447ff64b10e676a6312cd805029df7c4b7bc6f389deda9c42f60f01e0452b25be40cb807e49213c9b7b8de497a9a640e073e1dc866da7afab7199447d4d5756d286d2d291f467ef70e21aca30ce276c64902c16075161626aae3ad24cb1595df0b8fdb9ca95e982834ee02620ca770f43e77d6b6b69dade9bf746c3711fe4e7843a9101818ac8f5d80d4600b878a5f8bfdb0eeb457c4100ede4307f5b6ccf8bce97153076089b7657689f3ffba881fb3c01531ad1492fa17127c2162b51b8cbfe797ebfb124408bec59bec9f544e2611b253d6edb3d3967834038356dd691daa38297f7cd2c23f127e37f6f07daaa798082318561ad7396836adae0428ca9207404dd5e944ed5178e22a7467580874e583fed5bc85b9d53d8d89de8a07cecce62c42ac52b657f73623ff5df620a1b9d84263c6423109a1da3839fe0278cc2e7927950135b1f5c0557a1db1cc9cd9f5d96c0cedbce12bd64f49d56bab7feebb995b2101dc356f155a2e9df0540e9ee10896f67422ff8b8e6b0df8207650f3d9c41146ed7784b3572bf5de70430be519d74054572dbd20da3f2bf2039491bdc56915f1a460df19f7e926d1d86d8d8f6ade8c5b440a34a49e5eccaff70ee799caf805365c11426a9947c9143fab2cebb4260acac66f6f5a4cac556e0f59356e793d51ca256ec99352a772ce3c0189c227ddf309ed7b8e5186c2702b418c935df1c52e2dbb3ab9a6f16db0daaf56a3f1b871cbbf0948b58a3235d1e0efa7780774651e82182ac318aea511b02b783b03ca00824474a2c65ddd3dca32882da25c41df2f4795e78d841cecce9b3a6edaabbb80c0a253da5d2e63fbc902e5617482ec5fc5779dab7f3829335ae39ef40a29ca9db1067a7c7cdf37e95930f2fd49ddc5feb84c9d1c746f7c4df768567e19e5b79dc53890f62e56abcb7c73ca259187d3b8a8c4effed4256dd3e2c03aeddd18fb697fb6a40511833476e417ef4d4985e9b26f6f0fba64fbf97c4716391b01f4539ea55b7c3d6b2a45eaf1a2bb5fc6eba041ce565784da560a42ff99f26ae5377cbfb2a34a23af94032b63429247fb820f369f48dae2ef1ba0e58dc3b29ee5d999de419137108d2de9e9fb22a0191d8798f2fcbfbae7b9a5e929ef86a514b86ec13c010d8c9d5f9e0f78a4dcddfc1907566b9464e8b06f80bb3d4815d7b477aabbc6e420b93d47237cfb1e549e4b7ea60d5e55de1e43c32b5dc417e2efb73c801661247714357a5cbe0c0d66c87951b7ca36c7318d3236f0060c1c3a485056646c6d7e838a8eebf60e1f363b435a5e5f6f718ca5adbcc0c9def01029324d68879ed8dfe301060e10212941808689b5c0c7d3fd00000000000000000000000000000000000000000010222c3b".ToUpper()
                == new BitString(signature).ToHex();
        }

        [Benchmark]
        public void Nist_Dilithium2_Verification()
        {
            var message = new BitArray(new BitString("d36af2ae36e15e26779b916d2e9580af5c2aaebe33428e9990f305944d61f9319ebb8b4447bfd4b1df14af17e76578aac85f1ca38a64bea8ad929ba77ec94887bf6cd1f8efdf071a52517cb9ed5e6f17a8f29bce94af19c8d8ca8704677e27bfc111d58f8df665e8efb8a9e33ac06281c5427d7c5f42da7d58a6e7bb323f3064c1e38fdbfb98d603724567fc1fd6384aacdb62de93c30abb0b7f73b5ac16185ca6a40615a8910bc03b4f37b57ec072716e9a850e13def7cd0fe1909c19322e67aad5faa5698ddae1502253a14587b3599d5e29c5aa0aa3627c11a155bfa929671b296736aa20cfcfbd66636ecd2904aaff208e32b23908bbb0af5289b1c6e4d4550412acc9701ea6702417077d5f44e2791d48b444304d2b176355bd31b609a91aa2d27cc635bee298600e7ae554638b81dfe27d8e46ace8bf642810c6cb2c1a230472a077defd3b8c04acbcea50e279dede27d40e24bb54ddb6a8d41d69a2e0713fbb7e87dbaf4e48014a0a4e2f3f3ccd3a9db11ffad38dacacd7264bf937a1d1bca032abae0d548433042ba140201f0f7953331b877d02f03ace8552863c9d52292ee9496f62d753b6dd829dd5e59b2f84c5e7ea84d454fb6de1ad2b60db065d86c17b5b91acf3a659a8a97fcd93beedee9eefec101cfedfaf42ccd96a237fccc681b34cf5014a4e6a8cf9f7f0ec1494f75701c4c4bf72ffa78021fae6d3dbbe9a07d75dd375696d13fe99d0920d66efbd45f71d807ac76d345041d73cece28c6ad4a14bb9eba1c6b712f70fd364a97f6171567bca59122477ec86faef326f44d6548da5b822ee1c4d529e80f6ebb0eb483b27e666406f5a9637cc890308f84dc97c5f5e350ebd858c4fc301edac99f3a5f160ff79744596fa509f2f3639f63761d864c3d653b591a6d37c2d6d4011f91daed828d896c18ecb340067b432ab0fe32dadfbb658500ae28b57fdad0beaa04ea34a76d585a639df40d3a9000bdd4dc405f4103d8f79b8151648f11eeac0720693199bf1e576ed5e848976a08bed94781d59de8f6da6c8b2e0b09330479456f642d0c6a5dc3280d5874dbd887c16e2885f400401a9142edf3fdd813666933254b822fd4b51f69a7395ef80811de7bac89cad69ef40d76024854ae97e4de062d403181d458b26bef1205cef2a75d6aac6cb4912fd2ff50749e13256bb56b20add97d4614f62a73236279ef4985f5de9591ae0a70cc66e9e29fde2129663dc52c48aa00ad734b0c34402daa7642a77a7b54cdd72af7db783ea900f9cac299d959700b7e9b6fafe5929654c904165f2a068b737048738e37d2e68a1b80489e53998c1e6b7ed5cc80eb5957ac97155a466bf49f25c0a87f664fcdf37d7fa77cd8ace96ace8f3fbb60123925b5fc9c112afbbcae7cffd8a734bd9aad814d467908aaaa9d7ea328b30434668da126f8cfeb69c8c2ce6453a607dc37cf6594169abb7af1d15db2015c4445e5b2bfb3e9ebc2b69a4729986c4d4e760e2e4c7c55e06ce9e142e15d3391d8ffd93e8f4fc88c308ddabd67754d39638833e7889b36cc2295e1fa9faa15b414bbe71416afb7b1e79faf112876cc941e20d55bd1e0680eead216bef1a39c2d324471da16e1c70218ac9818250488fade7868bcc7729fff26e7e4c74dc091a85646990fe63c5b37e988c248c47710f02537a7fef5c2779c3f9242eb3400af1ecd315d03762f4f0d670ab6d48454639ec52554bcc487c1d5a6b01bb0fc5b2253708d14e5075b5fd9ffdcf69cfa7471f27b7efb528c50f4ed9a3757de947aa76e7c536a5fae158f17b89174ca2c5706b51bb81c4c2a8265be04bdd50726ad88b40d6123605d074d5874dff7ca160b10bced3af64006d2c0be1f210dc239ece802c1769fab7d7e1912a898cd94cc4f09ccdba9a49e882c3ad5ebfc6a5073155a92ab3f040a4fdab2d9e1ecd1d558c8ad8d19d4f9eea8c5504bcb19879a03401266a9bca20adc8a25dfb1f4da946611c20498bc6ddd5587b7d491fd67d57b3a84856787f3f0cf7bd162046b9ec0e057fe1176abe611f9041d61d221b078d8092ac5690f0f4ae44dbb75cf0c13a5fb6d942d307ab114eb9a65d3c830177c0806818ece3d715c51f03861763d791ad908455b025400bf4ff9cfd1888c496af64332f5f7882e9738a433c9f25499a644a9625599708d0de2eb71c6866d83d608a14dbf1134b68d2605075e868703e8244f7c968e3b309ba1e7b66c6d326148bc8cf2a5f58799fd34cb68e834182f246eea09607d603ad8d00e95d37234db5aa18234703299437d6834b430394874cb25f7bd80f1627e6cd2e9cda476339862638860d9a1e710f9ab66360adaf647c03a6cc1d9a12ef234c18e46a90f5479d31b2e2c6bd7085cde14dbe0c98966656faf1551793ab2b71cd436ea8de97c4130d9b46e75e752548b462a08dbf570db9ffd771d4ee0eb7d6a82c70b6835db4b7197efc5fff012eb9e284c6a1401968e92f6493d04a0f952a8776a7a2987a277f13408b45e1b0427f35493a1147decffccab5127ef1b361003a1cad4c5eab09035acb8e02f9c34a3699967a38f6ce47e12c0c26c8d25cd26e0d27795f2bac8e724197ba3d5bcf0c65db7933ce0d36615cec14ea9eea3c34f1ce1838411d6561664b1696268f528b9255155ae58c8ed161141de399cea89896c8a8f90ffa79fce96f8f4c25dbd78a9c60a041526158c3e8b8c8396bcdcc897161afdd58771578c4d7c6d59062a361c610f635cd50bd54c610888346827fdc9a7253b64d68945b7a244284dd938a0108e61f1e90a7b0a40620b983cd9b133d06da1ce74399181543698d81394d139871b5c8907c959a90696b6e4a4c5b5696504a99600382755c5026b54f068b62c000da7d2041f62f66c81b0418e3482d4e8a44b99f4a729a2d52726753462220fac617ebb3f6b038cd3b4cf2935717216b16144e7f54c9cdf4f7ce4f5e3bc98880d6094b6432f40b965e5485b5b2d0c75a356578a31fd0396ce405bfbf136ca0153c7617fce7812e51e834e36df86dbbb4b3a0a1db2955ee5ebd9c975c90cb228c49ce0c015f571d9cc22dc7ecfe79a8db3b3321b35d8893b34663446b2e660bb76f78c241279e7fdb2770df6e0da0f3cea28139b1f8ca66e46c848e2051c2aae8148f962356b2adb33af95fee608ee7aab1ac835853566fa587").ToBytes(true));
            var signature = new BitString("ae6e4b3131896aac05fe30c098eb0bd0a6be379f13752899a1409aaca0015096567a6352c6a0c837b1ef38471d81513ffaa496ee556e55da825f87e55a4cc53ed4e620463d9d20f1d4e57b3363205ac5434de71a6d9f420a5ac5c2edb094967df105ec43e8a1e6fc36e4cb2a8053a888af20c71400c4311ec33f26dfda80c742bbc5a3fbde30c8ed531f6285c095b62b5fc2951b7d1c82d45df0d92868110d1f4d991270e9c69fe0e9aa1dd855ed933c27738ea0c2771f0028175e1769ab23c5f13f3c4166ce612800997d518ac16580b2499e5dde6b96df3672d4ef9934ae1e4af3855b688101592321ee3063acedf7455a7264a33fc8df103072fd62a92194e61ba87c10bce0697d15ce87e81eb70959f3559c6756d45b71fd3c1e49727da2d265e311c11d78cc449b9089cdd98271c7ab63a81d9fec885173089c0ba080b237185c00435318d0dc1b2ee7ae22fa6d471099004eb3dbdfb36cdacc68f2d2ec7fca4c11a815666a2a07a9f2ca60b9274e17a27ca8641cd12dabdae5ccc216585cb491f8d14f53a0dd91a0a72b728674e177c845a224fc93655729564b4fcbdc0a89f2aee7fde2faf7005ad5268072e316d0dd11dab908ba7572a3b447363d13c18f4697cf38582f4cb501ea06b38a00cd4e7e22c267b156efcdb9cfa22eb125fef5c6eae2fc5df890902d72822b5282fed812873d951bd0d69071e01dda69f3bfe3b6218062136483d7037d0d6c66804ab12ce60df28ae706e49cc6d3340ed4f5b58002f5fb8fbeeb415106aa73eab116a93ac587e4f43f6ec3da2ca887880c1dbd6507d071b10ffa332316995592837fb102814a99f4d974ef2565105ebb9a77cc6797cd81e8afa5a2a2e205f83a610597b62e5cfc07ed749fc2ffaa08733019e79db070a5eb2fa69b52b93a7fa2d2fa65ae91e09de9a1049fc95541acb7df21f1819ab6d5f022f61418465e3a48ee2c5ec7763c88b7ad820318e272b4c34fc62a383681f8bb96ab855e720e71e417a76138a197ee77b845214c71176b321591ad0620a7a40ae7bfa7d246d540ca3517f3f980aeb197359400a913995915cb4c7a45f057460d136dbc4ff63bf963910df65869617a6d735824cf75955daf8f3d0150cea6f99635d3949a99e06d99cc4db873916fc029eea697ef06732921eea0460b22f6faf0e65d382dea67dcd8c3f4a3b24c45631bbef80a0036e7a7b951091f1a33b09b8778b1b10f1dcbf7df19e97cb9553154f1bff15ee66af2bc7380a2a897c6e611c00702920124476b853803f182c21e6250d37227092854f8018323da3741bbb7fa237f74179b6707c73cadaa05bee00613ac5e5c136e1cd4608a3bfeba542f7411d7a75a55b99f5d649114c19d56f3cbb139864affb4b25a8d2ad8b69a892347c7ce6ad0f5bb50fe8c3cfe0d609e4656b4b72cab302c12c2fa2e04396d3807a1928b28fc0d9f75950d87e9a13ed627f20c9bc19f0df8918e07f15526ae81bda4125868fe5572e3b70ef5eef4f81d1b764a4cabd9cfecfdad336c2a3cefe133b44dadbb49e5341d081d8af986cc878c0e7dd13c60f98c0c2341bfdb71b58873bc56d374591a28480615849a7b87013abe2e62ce7a1be03797922caf0a12797043b17750f798f802e211cc532390c2a2ab52c874584a4be9d17f17b17a6e62ff0addcd0841d8dfd0720836c795dd7301f94d5547861ad16be8c0fe43b5862e6bb99816d4e183b999573389854a7ce5dc0b67f3bd2d9206eb3a1b994c1559704822a190ef481afd824b48f3c35fee62006ccdc6e80757d6bee957002c5185e9a709ebeaf92ac6f50fad1a3e7826fbb3d2d66621734ce212045c9b8b53d28320f60b7e5c785e628d8a411c5eed26a6d905418afb5d418cc18bc9f054bf7930ad8f532d33b73bb64905d969e315341ba70a2fb7a7e8e062609eb7198fc6e0ab0ac1b7bfaef97edf0228d6458f52b526631b8f5aa3cdcea1f69f7f77fba242633077dbf1c277dd105ccd646b207d7e30366b356d951412447ff64b10e676a6312cd805029df7c4b7bc6f389deda9c42f60f01e0452b25be40cb807e49213c9b7b8de497a9a640e073e1dc866da7afab7199447d4d5756d286d2d291f467ef70e21aca30ce276c64902c16075161626aae3ad24cb1595df0b8fdb9ca95e982834ee02620ca770f43e77d6b6b69dade9bf746c3711fe4e7843a9101818ac8f5d80d4600b878a5f8bfdb0eeb457c4100ede4307f5b6ccf8bce97153076089b7657689f3ffba881fb3c01531ad1492fa17127c2162b51b8cbfe797ebfb124408bec59bec9f544e2611b253d6edb3d3967834038356dd691daa38297f7cd2c23f127e37f6f07daaa798082318561ad7396836adae0428ca9207404dd5e944ed5178e22a7467580874e583fed5bc85b9d53d8d89de8a07cecce62c42ac52b657f73623ff5df620a1b9d84263c6423109a1da3839fe0278cc2e7927950135b1f5c0557a1db1cc9cd9f5d96c0cedbce12bd64f49d56bab7feebb995b2101dc356f155a2e9df0540e9ee10896f67422ff8b8e6b0df8207650f3d9c41146ed7784b3572bf5de70430be519d74054572dbd20da3f2bf2039491bdc56915f1a460df19f7e926d1d86d8d8f6ade8c5b440a34a49e5eccaff70ee799caf805365c11426a9947c9143fab2cebb4260acac66f6f5a4cac556e0f59356e793d51ca256ec99352a772ce3c0189c227ddf309ed7b8e5186c2702b418c935df1c52e2dbb3ab9a6f16db0daaf56a3f1b871cbbf0948b58a3235d1e0efa7780774651e82182ac318aea511b02b783b03ca00824474a2c65ddd3dca32882da25c41df2f4795e78d841cecce9b3a6edaabbb80c0a253da5d2e63fbc902e5617482ec5fc5779dab7f3829335ae39ef40a29ca9db1067a7c7cdf37e95930f2fd49ddc5feb84c9d1c746f7c4df768567e19e5b79dc53890f62e56abcb7c73ca259187d3b8a8c4effed4256dd3e2c03aeddd18fb697fb6a40511833476e417ef4d4985e9b26f6f0fba64fbf97c4716391b01f4539ea55b7c3d6b2a45eaf1a2bb5fc6eba041ce565784da560a42ff99f26ae5377cbfb2a34a23af94032b63429247fb820f369f48dae2ef1ba0e58dc3b29ee5d999de419137108d2de9e9fb22a0191d8798f2fcbfbae7b9a5e929ef86a514b86ec13c010d8c9d5f9e0f78a4dcddfc1907566b9464e8b06f80bb3d4815d7b477aabbc6e420b93d47237cfb1e549e4b7ea60d5e55de1e43c32b5dc417e2efb73c801661247714357a5cbe0c0d66c87951b7ca36c7318d3236f0060c1c3a485056646c6d7e838a8eebf60e1f363b435a5e5f6f718ca5adbcc0c9def01029324d68879ed8dfe301060e10212941808689b5c0c7d3fd00000000000000000000000000000000000000000010222c3b").ToBytes();
            var pk = new BitString("f863329408f6689cad60bc2d764ac5908a26c0733f92958bf0333388135a2bdd5bebddbf66d4327a7721a9ca47e5aace1c39dc29adae9f74cbb2c0326bd240b0bfea828124f5726307d229ef1eebae4371ae876a0058c246957e889cf5bbc5267efc480159cd454f0ee536a103da6923624a59aa6d100859efc79967ef452cb415b85492760b9b2c63b96ab6739c2c4b8c4bd7179117a7b016cba507f8c91741e0a2b102f22f658942575242dc911c1711581922d3f064908a94997f9c23d73c07b66485feb42c808a328399c5014b43e2f2968543bdc6f8025bc2cffd117ba2c1de32be78a2c9df135f80927bf98588840e637743ceb7381e40d58f92eb045d16f73a874f58b08d295ce26dd0ba5dca0c60078b4e8de821505163ea767bb055b49d0af1139b62b23860352bb4fc46875fcf0828c9470c78bffa7529cc93618581d3a73c99d4e50843738d7830b14302a06b099d7f1df8ad5dd6fc5f1437f146d33793e03b68f807599d4ea2f5a2551d7b036d5b85a3e1f82145c3c2022e46d00e9461a85b32d4561cd5d612af51847b080426dd29968d6eac08cb4f6629802a8f348b1cd11356199cd283fc34ca0118c90e71776b4f23079ad2a1c937e6621484bac885aa2a50b44c94fbcd3195bae885a89f661ad5cf459b3e7e8e70435ef9d15673f369f2f2da38bd4a72d2efd15c1c354898802e20b654e28e6ff1b0c4a06907f7d8879a64b1256c2e74744541d9ab3b0ee5afb1b2c72b9e956cfd50c4e21c71df234e2a8dc03878661382927fafcd2fb7e2519cb23eac8c287eb4234017b0ec73d6c4c6cdf919551aaaa5d904c11701678d68b6ac724ae2bf26e07b5af0785bb6daa3435a73e2dbda9a97ba7bf729d5ea47a95baf7a8850dfe0c71a2f40cda636a3e24ce9c0d20e9fe81f7d9f04c051adf4e85471c2ba9e88c115991c6d7c088437b709e066574d93e7d916f844b0ce524673001728f7778c852543b6b7a75b4e1d49bceae1f087838d701aaca5b4e25fac34938f4de2b3830bf35919e5b8cad54ebc3af7d49224f24dce53b53f4d8516f0d3fb39b4714e51c4e8b2eb09ab39dd2dc137b37d5c736b16bf36a51a127e28d7d9d2e479381a876ec6ba337413107730c3f70784cef3ee10ecc26808c2747a106f07e8b5d3b291a22202c9d57f844502cbb468a925e73979a70c4b27709f75e60acfb7b3d11d8886ecf0949c058775dbbe1d4804e3de073df999b0c779ba6c3e4d35334a0219580de0b892905ec29251a2fb04a10349f6b573e71ce84ce54507935dc1c44b2412c912865b37bc56e73523440a85f623601988192e0a206f060404a1a87ef66a060cc87dc468b1be7aa7661644bcf4a3934063b59ecbfc3198073cf28ae09dc75b4cd9331b4797119190ffe735fdd8b6caef511a4780e07d527053c12d5aa89d19f2bc3767aba1eff65c271086421f6a5e089309c682c2cf614e2f6389b0f6a461f7d4cd54d5ef2bec866e01169783e523c34d2b1b2d25f71a85569b0d5826ef8bd84b132f359ceeef206bd1aa4fe8666b176edbecfb83664dfa7182d328842e62f9b2b551f44001ccb9101726de7092794d4efa39a8d16e52eb32597c640d5be140d05ceb7b90204aeed6a0fdc49547a26f2b97071b144f7588a92d74e99e8474440165fde6b816ff005dfacf994516e396aabaf630b2429d4de0865a48a24d3146481cd09b97744772231da1a337b365ae828c1d0ef535d41101189301dede9e683d3f31b6570dcd94e8db188f2da8922f0914d2bfb10b50a001cf87458e07a336b9a6fc538dcb6eb0caf6cb7b8eed8b974c52bba5aac882845c1f8804c4f8c6d7a48b8746").ToBytes();

            var dilithium = new Dilithium(new NIST.CVP.ACVTS.Libraries.Crypto.Common.PQC.Dilithium.DilithiumParameters(DilithiumParameterSet.ML_DSA_44), new NativeShaFactory(), new EntropyProvider(new Random800_90()));
            var verify = dilithium.Verify(pk, signature, message);
        }

        [Benchmark]
        public void Nist_Dilithium3_KeyGeneration()
        {
            var seed = new BitArray(new BitString(@"fee3fc48931edc08ea5490fcc3f21745719488129bd78cedb3f7e073e1cfd5f3").ToBytes(true));

            var dilithium = new Dilithium(new NIST.CVP.ACVTS.Libraries.Crypto.Common.PQC.Dilithium.DilithiumParameters(DilithiumParameterSet.ML_DSA_65), new NativeShaFactory(), new EntropyProvider(new Random800_90()));

            var key = dilithium.GenerateKey(seed);

        }

        [Benchmark]
        public void Nist_Dilithium3_Signing()
        {
            var message = new BitArray(new BitString("a88e0909a46674fd71f85745af2ba062cb2b17a027f7cb8cc0211ab8640459f970ce7b68a57144af7ac4f8725e1541860deb9ef8136ff91572936b4f65cfcd2fba79cc2e93dbf5e3fe0bd9b58aea94337e6fd96cf22970a76a9c81c8ed788a892100a88056f870d12d35bbcf80a524d93fc1543440bbee81cba460b3ce45aec176cb19c4c7dd0a336f482f601932cf95f4f56db94a23c080d779142d65756d16b1e85afeef68f59404470f6d83b7cdc421a530f4e971760f88005f71da3fddd717f5fa2fdd76511edf7ceacbbd0661ce73e23188c2780ffc3c98d19dd96585673c0fe31b124f5574edccd6db8759707c87f4e3059cd1266f9afdb2852a37b2b9f0a3b5881f3e4be31275e82a49105b1122d926311be22d40aee6103e04715d2690287ab0ea33ae9b6fe8358afc1b5f52f820ad5262d385c052b8f3a6b018d68dfccdb46bbf27b62f0d71d66a79e17da1632bd1c3ef8f6a875b9513cf1cd4bac984bc1f61159bb10bc6e4ced2b4c8e2f9967a5eb3a6412039ea7ec63bacf42f4d4ccdc4442eb20a976657cccd3dbe25b11a4af4cd15f7354916449a76d6328b5f687054fa6ebcf7c623c1606f8ba47c8337c6316bdef842243e218c880b76f08e034c674782eeb93882880ccbe1f27191d79269582689eac1c512b77cdaebcb1dea26773e634d0612bbffe433ee9c8e2776930016a96afe27c33c91cf165868ce403659d8cecee1d8063b2587ba256db3690ce712b1f033171549bab0795023d8b8d7da7b9c0264a3361fc596d7c6faefe65e6f83cae592f4850826dc400efb46a30d33c84d2b8cf000326a3a777d383eb9989844aab9ee6fd7b52e434ab0f4b968d18c62ca73ca4e9fc52c32a52a32e047294991d429c70fb955bcf6811319bbdbda64f3d53db6ca685b8992743927163c1b21bb48c976a47c902b3d95f6c373d3fb8c8a187d13f7f249af4b32460f5a7816cfaeefe6be9677071ab61e87d31a3b475fa282473b98a4c89c7dc2f6b0d00ca11af3b6e678dca0426d6dc2fecf5d87a8ec520b59cbde529b9e3e812d76699210fe259c617f2d6ef00d35b7f2e759471e62bced76de4ba72bd096671916c8258648daf8d34dfa7f31ffbb0a599d994d60ad8bf425123ea64e44b77256b2d51da176ba1dddd4b0b534bd657b2973f16c1e4477a5d52bf0727c052d3434351ab29c19b224f01a1b9477968e444f9d2bdfb24b352b7f9ad5288cdd08e78c983a84a4740c13d5fc3fe69ce44577387cd3f77854cfcb59e419ad72f4b6117b11fe4dbed815104e1a93b8e0a148c28bdf9af3f2a7bffa8098bcd60c7e6a0415d372da2afa76214dae678081f9b917300bcdb03dccae96e8e8d07c40c0c1d8a462c75cd5373dfbf430d01c49d7f65cdfa6b040618dca165869e122a53c6fc02a684f1a2e890a414386ce3eacfb1bda10d057936c13de5c46c0d5dab8ea09e3c1034643da150582a0f04e954fb5318582ecd265f8136679aaa97d3880c9719b7f383c0289a2cd2a106e2eb0d2b6849fe23eaf2a255f14b175ae2071cdc07579fb72eebcd4f93d4715c0fd596d375a23ed6d3f858f2e431fa5ef1b6b018e31ae9f60b993f26db40228a804ac8eafcccc4f96340d43d4df4db96a6051d33e9adc91d06edfa8f6dca514140c0ebe470f0354b8c0aa026f048db889e3eed2af7c445750f4f8d3329a56c67823b6694f2ed8c5ee3fa4213762dc158670fe40c41d9cb18e7eeeb1e5e7628dd4cc43f6fc6712069e117b446df7fb509bc725918b1f75cbf94cdc92e9a67702da3c8453e24ba395a50d2049f21df8cd2b8d74d9d8cce3a1e0ac474f2665d4ce743be22574bf2d7afbdd301beb182e3a6397e57676b9d7ade65828181647877dcc6eedff4d53530f10c417123451f7ac45a326d6dc71888d86d197246d1b2b0e2fd03af5f0cee334879d6a523ce4a4b69222c686d779624f54e1bb0487a695168cf08279f2b5d9deca3555150d1cb6f9178defc8c0de75a2a01dcee1bd6c3db4a395f0057efceded16e9564f762503fed6c35f92e04ae67d5608ec39c3695774cae258ebd803420fdf6173651ec1110d9d2bdc90fe27c39897be352f04a45103e8d804334855e7e08f63932356ae3dbde139f67c2d4e2485be3f833111b3ef2f3c09f14ce5720269d08105bdea6163aabadcbfb9e2be37e7b5e9dbc1b0815eaae1b7e8b70d6c28ffe5f6f35f30d5990ec45801147dde2e66eaf8dd5c6e22ea879f7e88fc2bc9660653d5c308c703aaed1771301c652394cba7928f849efeaed99cfc27139d5587bd35fd81d9c5f3da4bc18ce0ecf576b824e70e4dc2284de01d4b9072be98510685056ee5c668d2b4fc3714897c28d19a9ce9cbd80eb1edf5760a8e4d0c84dc7a82cae33e9c0678443d30dda959eba37c2c898ccb13d4f9a71d79497b35695948b8303acba372fc5b79d7ab2e9b2ced030644b875b75498b19bb94004d20ac561d219fd9d5a6c40bdedc81522b3d332674b69571fb1468caa0e25c03d02f93fa35137f4f4c5607c4c5e693a49e72d5dfd672467efdf5ee1911326eb2a125e26bc97a413d5833330e4994b5faa2fc199a547340e96e30ac0aa7fc557e7ca0e8949b0d6665fabdd0f2f462e22e64397519f1f887851d9b9142a18f26eab097f63394f63facaefbac25589f11ee3df242552ac283e25cb6d491186ba3513c21d0201a5a0846b50b524297548911184d8ff861eb38b8286a17020e47d2dc68d6cf7bf2d90f6a5709960145ba45f5b25d05c978277e69a7c3cec59794078eb71ea2615547901fceabbdca556287971c930750952b884e457ab0ab7334951a8a3d7625ec33f00dccf270eb819d2e482a3b98adc2af0a9181e3a3afd26e441bd354844082a2d323f0ddf739da5d2e683c045862c33c404d0a52d984b9f7d963d9e6a6b77331f78189deafd1d3646864f88ddda107b8e03cb6f198c2cd61238ff7583c1af3cd1cb9e9f291b97a0d048fa4d21695dcf43cd11ddf1229eea4e46502acac626423a726dba05d21b3e44443be9526d0e83ddbc7a975cb687374743f71e893d30768967c9ff78352f4b265f0a60f7fbb7ab43680e2424465b9359d14367faa6c5aaf067aa88125e66a28b56").ToBytes(true));
            var sk = new BitString("44eab878f12f7b1e1cd44ada06dad38ead30d732ad8a1449be32f2ae5699c92a41846e40e1ec5313a2ccc54c6a1418341911f1d57c96ee83ba0b3e6b30531db0de2e6a14e38833cf9e2d906f3546eaec899e444351e88c22ede95dc42d4a48473617bc2362d3499cb7dd1b5e944835d9a4c2f04d67271fab8a0dae49a8c30f2156557823374832202717277108346528648206515086248374254786513254100437532286575476317136241535741887377865118845302084725085315287254784732451264850158837556112543715271508685640886768222883266170231248053162388224744854681571223010842376281155215161701214540014572615781268066343741730410380320434413114731148018566338465728565351532618548616116332333751168010136412600107226647233048225826501066555048581512541860365770328874442421038815517417844362317325830334742266756022155777627208745806182017356138735064240667550222488742021656534621048811333252833128844413422444250526663778280882117622472075725245280447742452617545807463365563486605606001432711466373050330308256012004253504815456237242364430747151715886028618706803078473737617645468000544562516725520854546035840380346481508612482821786046215741206751302704708755240227340832425720384466032642528211500522585817276511836281704550842025558657078367715178523843864070014018101424834184472372002385112254734238030423253148458685166844785505751801564633663118410012301782388611141266155102220556274538676224555406224187734737500177626700311485626731437847187750265663376737602448275845675638115285351710131447440408346310501583345278210240746162420462466303175185702014255520285502570146735035550222340517366050702762206616036771835164031465470842762116618631577440856885876640166712450188063137730743010713008471401047541120174264674163424424065344336722701081018561738236542766144507017562473507384421701536058706222673564362240586365037180546788736220757013665506037786446852435023885246237112163675002331087457874041361274381343183101216816835760765648666357135453483208023647134311038116335128620287471171025724358472232416460552632705883138268750325350656153127707256746427881745173313374115445255053220607631884002266858018365867142622355268802823037548530058843368146327173351426617751765156828087007227841265025358010056362752648601752817345577177021606247110664411686504222167062255160458101450636363155166572226283214045108486140343646131237021544218854225838276042808744215286706566121062877877158635554514555661006403475102671174122614535464858648123070135586460712847682528007484154308058776003070050044816435468628661857746640101287532745814866037183225103031823665858484883610518331776386331502156334105247403802485573188226773726605685887445730124007546351441733516682804112367712012310508780128660008740363458326032124885505653170614216833230140888878711264657854000277312480105188507846540861215385410315778375282351466208647308658576476386535660505024306683687015650407476005522646372577762366155420577010654553111851527375016450085360168755224221631800455520258883024623377636488106377024823068145205226273464871815060253278684643714023301273366236622231254713138207115310325715115855875016355245651026882762504786444874748528637085578527ad7e71ef2d769666a002644caabb0477e9ecad61dbcf253abd34112b7f08796719313f018d8212bb67a23fa9ad282c71b314ac0cb72885e4e597a7dc123104b662e145aa2e46ce7054ac573099d8f840a02f2b8d05e7dc6f13776bdd2b68cba4179cebfc72a8ade7f24f30352f805c9fd52579aa6f2e1c451e1a9580077fe57af69a593912da07a782b728a4465c68ec0ad319fc01365207a9607672943dbec0d797079b22994e674849ddc4fc59344a30b92e72be46deb1e6638694c071d6d3e3a249d7ba022a021b8315247154407f7eb670944f63b7c5e677ffc0b63e1dd3346a02d03e57ec8b70d7e779b2f4d9a3b2c7d4968730a0b1ed909feb4fe8f891ceebf9a2052c90ed13fba2dae5e3a7c07219612d88f8da9d5052bf616a132c9b75e493832fef139e8ea2cd31f1c8743ceb69d24a035611af8645b83a0bcf314360fac58e8c7abd435b1dbf22f896faba14cc7e37e30752d56c1aa6b5842cc6f6494c8767ead1850c4193470d941da49bb5414f490275161d8ee4befefdfd06808a9544c8587dd6752b9d32f237f8711848d11d2fdc8e346c7df58cc99013472746f37921b83b59f70534a9c70918461438cf7f52cfa0792bc2efedc4d72af483eb8e4e5119cbf2460aeb50f6e7fcaadf59978be2f1d0659de270e77766e6b70e8e5aee962b8c896da7c021fd8707eab6b1bcee312b05b9982d656fa128c9733035326cf407b8684d2a055146384fda69bd0769d1de5a8ec87d01459060e34b659b988e00af4db86b92c3768f0c21a1dd502e6609f16a5f4e347023f430a1fd70b2992a6b9ed7babfcb351e54d2fdc49489f245b664cf9813c3b5a806b4d76b791ee4fd954e521bc15d1b3fcd3f81e2e7cdebd2fe371a6856d97793be7c9eea8a2ba950af0274e9991057bfa9c01069c1e711169b8797dd66b02749bd1850b0dc1bd64fda4a6e4dac12efaae640a266dff8ef536c7a13bc89587e8c7af119331a941b634279acbee209ae5ceb246325648f61a4952dd6ab40a9891c3f97ff10ced5b099e30ae5490a640f7d51a478c59c99ef55a9867851c6523830dac0933063bf498ca46c885f397970eb2cc4ac65a48daaa66469152e479699d78fd38fe48427ac2123079ad4809c1d025629fb4fc348a09e616933671400a5a9965a66d66ee681859943de8d80ed087d88f9cf1de4f3c511340ab262357728f33eabb76f83ffcd76e46f1119b1594a5a8d07ec19fa9e24fb29b60c2a4b9d195ab66e08bc6c587328ddc00a913add84fe6f72f723b3b9b00a7adc0b11447e49f3f4a3decac269bcc686db211a1d0d7bbe0662986f5cf4fb2dc866dc1c48fc53cfaa9f39b0c11936ff496f39fbc9ea0511b95a843242e684d81be6c37e526f73470408b929ed295e4ea3ef31b2f52920568ec8e2ac74a3f8c02d528c775cb51da291dba22f9e39a2319fcae98e8862f3e119bcab22d8c39a21977586e2520074c973c2647ab59706a1d97c01bebfe7a4d923572f6b125122182d1f229c4e5073586b3a3b11e9c9b70dff034ebf09520f0c48a668ccfe1c0afb321e57be9f9c13f0bf3577beb630e910e4f1bb810a486e3423a8467674bc533f0f7b5f4d276fb1db3ec431a984a8460ded985a467aeaba409914817b7a1e562d02039880edb0023c466e8ea6ebe1ecdc55a02aa9d99c582dc9ef2c59d6b73b36c9e7216b09e1a7cfbd6c5fa32b4f3c35ba13535efd524b968837d9fcf78f52c0dbdd25e07ffb263cee1187cbcdedae1636388a071b6f7e6daf4d3a4f3753bb337725d716d88143c64c7f0049d84861bc8d65c52ea13df3ceb1935b482c31b36fea43ed293f17793ba705aa11abe6aa8428dca5df899dc0b08ffb09f934cd4ca8268e36a8220a97a6c66b078ed082516fe7d4b1fdf8f044e5b1f965d4133a433a0fcb821fd2b1850a6df132660761b50549541aa29f333d9b7a2bed66b2ec69f8b0e4d9f7207eea94e7f5ab0f98006f3e3621cba64160edfb1b34eaef68174ab40f0d83a96bae02a2add1a0885632e8520aff12ee80addd47097c3af6bb3b5426ef793c5cea1d9706cb0165a03ab9155255b96203f151b87296169377d51fc0034aa7dfd9faa213dd23089fe26784d209e2c8ea9bc2ddc0087a8691a236947fcf08b08b3d84b13cf3f5f12e902ec91699b59b25dc058e8902e8dd1fa3e029dc7e4099fd27282c1a59996d9b751f9d7a5e5d60e9ad3070f19eb1099abc07e1c3fadf692ed3e80298715a2120931f54cbc9d2acc24db20a4b4a4e1908ee284fd2de45bafe16d8a3e55b17fc8f392415d4308103968846243394770c9ec8095af86e26e3d2b8551fda6c75a29d0e6054910a5fcb01a138de5027f04290cf4ab109af9987d01ba7cb83b87dc07c484a4f71d0b1a2d4d034e2ed58632efffa9dd7d01a39c5b8c795aa1224300c5089695ffa03ac837a64463e38ed45fda56129a18f005e34001bdc92a7bd7944c0346943b380ab84836ff1b0a01b7b4284118a3d6bc5a8f4a9b10c5f3d3615bc80867f33fe94580f35de16736bd40fc43320cfa4cff65078d9d093652e88844128e1d54654eabb04487af2dd5367f12a98203f16ad4129d66e5ca9141e7e5446cc6afed6f118de1decb696fba03434204aed5244b322091276a58148f22e64a6e88d0744c908d4156f12f9f20d18e8e28e9019507b3825f02336a35ecd125b37ab9e45189944f91bb13ca003afd967a099f7a4f19a149c25c6c71effe3259d3e777b5a10242dbc10fdd2e89a6d55c9c3436dc09e081fa38bb7f6f77a89a8ec8d0ecef54bb98c8328b928f81ea98de0b8647d149a5936b8e6246c81c1059061dc8e44236acd87db1cbbc27e74031f356796ea30167fe9cf18ee6b35c322d352e1c20e18308cc2965c4a0dcbd3154d082b86216e182d746f074ed62c42af85be83be3e926743bd4309203da5d7deb9e954560b1b012268eb23b7c76d9295b5faa5c460915b709a1c0ace6db9f57ba4dcc52631734ff4f697d473198eb7dab2193fb793540caf58bf9bd6e89a230e88285e633d61ad22e972fbfc333b8239829a1adde54cb2d40aff4e985988deff4759814e76aa36f0290781cf99d3a38bfa567f07119e800dcd3caf0cac6f84c34884a123e7335bbce0162198e089c93cf5f60c59a6fae33d0d56cdcad4fbd88b37b58552aa80cc5bf00704da27a37805dae825fd54e6a86a8b925eafe695b795a7c03e4091f15cb9f72f6c4efb85de787f6c98a84c922e91112e351740a0b8d1b0bc76fb11ad1bf6e800e5daa4ea2f07d71d28ab397c4a94fdfc21b8645d4b9ff075c831789f43c2bf512c34c0abc088228b948617f9025c1bb0f1ad99cd873345c0f1af2e087d64c42255c058e57c387dfc2220877f17b7eb2d1a71a4d7d7384d0eaef6008e62492327541f84953d58411de0d46d7f03699de5b12fb26be8469e58a4872530f26bc6cd5ca215233804c4b81780cd753bf7ca64e73cfedee7c74f3f1c4807a94e5bcaa6f4c8951f35e208209602e319").ToBytes();

            var dilithium = new Dilithium(new NIST.CVP.ACVTS.Libraries.Crypto.Common.PQC.Dilithium.DilithiumParameters(DilithiumParameterSet.ML_DSA_65), new NativeShaFactory(), new EntropyProvider(new Random800_90()));
            var signature = dilithium.Sign(sk, message, true);

            bool match = "AF315ED940585267984CA13053AE9A59878BBBE45AA28F33BEE04A108BB98C7553A0933D1E0932221D3A684271106B43A0171B055ECF97229E6EEF39819BFB1FB99E2495BFD9EAD59B8C707B684D9A8F18B3EA61974338D9B4C6C62B7D9B318A76D83F06A7754AA4C1C4FDDEEE3D27E3D9F2C1778928F5483103DB095F0BED70D480281FD9C0F29BEF4F40F10098516F537E9F3DCA343F413B3EBA69EF0C9780792D9D12D79AA1C84207016D4FD8D4A4E3F83F8F5DF31C71E5BE95668585632494136D2400FA0F5ED2F1A85D416D9725514BEB0EF55CFBE99FB1324F874A3006B51F7F576C9E5F2162052FC16C6F98336E01A34D1766A056C5737250280E6314937C7C89D2FB88397D9202467CE775856476E076DBA2EB5E82EE83FF7EB4C5720ABB0F4E14D4FDDE5C22A2DFEBAC91128EE7EA393BFC0A257175D3785CEACD116F40BC2377B47A689BF9A6AE4D677EF060925E45858C9BDF05B3CE4C7291793FC761131C2C758350A5B056A5DBC5E6031C302068586B18AC86F21784BE912082626AF45DF777B8512A8FDD2C670A38D59BEA889E89FCCA97002482891DACB86E1E3FF8FC27447F7A34215766F1FDE049F1AE190E1F631385105D0254385716885CFF21AA1C26ABF322ACD3927EC0733B7BE4F5F29BFBD229EB7774352B32638C9DC438FF6ED48AEB5EC2316CB9D3E1248F766CE5596795B38A88EFADA28C6A1994E7FAB2EA7A51174D6A2758144DA2602823CE4E919EFEFBAD2C740F0BF5EBE39E1F295CC91CEF7FE14DCB2D161FA7705C7CE677C2D4FE9AA987BD1FFDB75B16077BBB7235B6A32EEF62AD2D4DEFFE0C63AD599EEE8130404000AD0F4A304E5FE73028D623CF4EEA629649D1711CD42FC192C080B24AED69817BD242FA88FF4D92E825B0FB671D7F70F9D68ECDFA58936B76A24057E8B82BA8922A4A0C85886E2F58942BA2025D175C009461509AC617CCCEACA8C84FAC4C0A23A70025FE32AFD3C17F0B62FBF6FF608E031DA265EE23C63FA2B0E2CE32FF9187E98FEDA9DB5A7B4F2CFE9A50815EDACDC1A46CD50D49587116854709E822CD5B7D6B5FC9D7E5B7DE02984AD3843363FF58E303C3EB1E86C0733D80DC9EF16B663D51470BE2B3737479418BAAFB370ADF8FB539C5809F00E390190C9CAD45E30CE1D4E8E868527174078FF2C5A0CF3B40AD8809BD2330FBECEF51A69CEAFEBD7B9E66EA1B67AF5FE9ED98079D3B169BB4EBA477E84ECA326BA2E232A859357283A5A08A0336A8BFD361F05F03FD8A6DF820CA715259377A850BD2AA02B4355F998794B49C1E209B802AF767D1AA44DAA6FE3F943CED4C87F017E06CFA3D27C9ACB7E5189F6C97524DFC050369BD203B3BD78B0D8A042CEEB561365ECE438FDA9310FAEB72A12180DA85185D8CA89CD7BE28B8D6B2CE9FEB985AC0269A30CE1483523A257616945BA24970FB5625D6CFE7E9F41EAE47853E973A9653F6B1668E5D2C90E908B97934A6612BC3D37E0B809FAC21F070A8580C7F284C6BB6E39CE71C331BC321FFA0E19CCDE0A8E2FCE1B26F0850BF4F2CB92801F6666452E41EE7BB53F66E2170F4A0A0636056D18039E5FD5636AFCC33970C81B328D5AE75AF3422EC9539C0041F3A9DA4A6F5F5C0ED6FC2A0B8EA755B167891F4C90059928ADB6D287FD14D70295D9CCADE447514EF549E11585B771C39015EF8984FE00D9D223B5AFF80082B040C1AD0227CA6884EB497E84FDA16A6D97A1A6D4963DB93BF0926A34A445D39AD0FB877BF7CB5D8DF5420E8EE95E83EA7EC4140B1D8DD5A53E54982AA951CA88DA46108347B4EE92F79CE935D14C052E6F7B9D7016E32EE0DEE050B3C7A27D9C6246DF54A8B370A013132839E594731CF55205F634D6DB8E6C23898B33FFD403C672A880A13035570DA733BDA7EA83DA9C459EB274B9F15DD4348C7740480D7411129A7881E9A38F74188C675E90D30E9B3888F74783AE76B1841CDD83D69A1927D24D1D52EC76093BE40ED9942AA65871638052D038A8BB4D98FD603323BF560C61B1FB8147EEBA9EDCD98E2D9C239A9177A0BF80BFFE209C398CC4021A69622B95EFF31EF175445168E45E2D04D573AD314D9686A00743774F86F58B50FE6AC9F23DDF50B2E659A28EB3DC85E1B9576BE0A1817A416E3C38BE89A50F115D47711110AF6FC103CC964FF52C261735627A3C242913BD3169AAE59AAC7CBB5171BB82FAE58576B970A9A1B946B7D374E1971AD07E572D5ABB66289BA0AF9877562CBA7789EAC75F012034264CB4B0B9C49078AB12F98B038D5395102F0944431E2B5870D41D61020EAD5981A8665C9BCB55FDB7C4FABAE6A829C6192563389762FED11B2FABFBEC02080CE3FFC3A6889E407A4BA4EF18A1A809DA38807C78FCF70B932FE50D8FFCBF6341C75141F9DE630C0CFB531184B30A4BE94142780497A88F242FF9BA8561BD10732A87AED1118F9348757F9B026439ED33C650DEA1ED00B3C8690495A5E5D577ED9EE698E7434FD054FE1A92479FE0D72B9B86CC1231CB320C34F2A1C9CED255E7C8806863F925D9441C6D9D0D16AE957B44AB74E9343EFA1AE6AA7B36B55207DD52DD19DCF371BB81DE7A30ED383FDA82F58C6C070EDF9F37939937D4D8A72ED445A7CD0B74B709B193F1DF7E5A13655BAE63BC5628BC347880830AE70B7A789168852DF1FFC432104E878AEA19EAD1C79918FD4D84414631FCA6234A82259C91B45B51C7F7FFCFE163328A463D464580CE9E6258F9A7AADA6212BA1252113593D730D8509BFAAFAAB4392B7401767180DFE40CF0915E959B999854F6BBAFF0CD5B6D7511575E835A4593EA15EFCA48BA98C058227175E6F88A9AB27631FBBA0ADF81664C115CB83A2C9B340D219467CC9162598CFCC3DD3C061A28F49A805584D01425CB460F2646BC099D286776A92392D39987D328CC5A19C9011106DD17527270B5D803660C7865F248B75C59CEA65D7762491B7B04F10E4DB87DB4C6BEE87CF66031F51B26DDB9275AF46B818C4FA81AC67979DABB501D3742A83FC7330E53E08B5C6D9DDA4465961F377949542EBF43F81A777A39656A45B52F3A7B9965D17A80D1744F72DB3C163B1423A1FF5AAB0608487D8B411A3F5AD56DDAE06FEF1AF0885A69CDCFFC36ADF594BA4C1B9A8669FCC345AC7223220B2C55A6D3FFBE4004BBC8F3ED009854A22A91C178F888C4760D2BAFCFFAF66313150CC302E24955E292FBF6B6719D50F83823336571ECAF8912FFB1A61ED78209BD5C2CA704745E2B13C089F5DB398BADACD8C6B4AEF8B2DAA01AE7F0C6EA329757A6A03E70D18C9016C87B7D0058FF84012175DEBB0DD34959AC58E4C5EE49359A6F94B7E1F13EC938216AEB9E8FFBD8C2E07B2DD043A8706AEFD7ADA86DA75FB1472C662AEF8F19C6B49391D6504EB473FB669509531EA5A6BB59F9B46987819D0389A0747864C213E4AD0016A0B83152933F461404147533D74C51DF3B6A59A78CCF0C6AB6A803C6523EE5655877616C7D99690A4005DD26F495EA15FAB69BF4C521C2E23DBCC6A8C956B37496B34082AC8CDC29DEC3289915D261318CC62FF85CE5518D96D253BA41D536C3DE30E51121EFE27703F45D10EAC5153792AC873F2FB3977B965B9A5504431B15D3B8FFD3DB5F279D09D453220D11CE90AAB6C877D7900BA1053E4BA8D19A96AF0C8C32B9542E9CB6D0572E0C6CEE00F6DEAC47C43835265996A28E614147DC2D236BD3EDF35440313AF3525DC5BAA0AA06E33606874DC2A98D894CB8FE992095E84FEE396E32D4EFE1324E649455E78C2729E4322B4F2AE15931E424120255CA7791EDA0B48E582E791B3463DBF96048932E4897AB9B1FB7BF4EA0720D720873B9FD2A7149DE515D45829D65DE7A88507854913D019F043329758D51CC401F1580B727DFD853B110B6201EDEEC2445F4442B8957738FE09028516E85BC6ED80C3D52004389EC13159F668C3A9811209DD467AB0256076924FB956085EC29B8742AD80C4A91D82C9E8C25D10AE9085643693B5244A2E5EAFCC9141CD9BF446D01C02B8156378482FF9A42159676F440201754784FDE54CDA7326AE19F0AA783E086F1434F849CD7848F295E734A42412001CBB0A4CBA8859FDF21B73AA6016551A1279B2D83DE9A1B3CFD224F09A931039979C652F090E47CF7722D516662DD6B3515D79D2FB44C5FC3F983AA759B0C8398906D56F957B58C74060CCEE7F71CAA4E2BA75B1560587CCA193B1EDE8C9A02DB915E581855395FE613C390E55470FE40EF71B961216907805E7D06A18D4C3B0138D65DF6F86EC9A0FB6572AD432839E68704FAE98B71E59ACA4CC0EB31D7C45C2F39A7BE6211B65FDA169BCBFC4B3ED605B3C20D643CC8E12674448B0F441CAE5267A6A9C99A293FE9E0419ACE2ABFD7161953283B581CAB79D4E9898E1B20F545B84001B88BD620679ACAE894E55485022E57BF15410A6712A8D6E855132F1C02376E07372744623AF54291433E62AF19DA94072AF8EAD56E67B59CCDBDBDD99DC8457D1E43E700A0E5A5A3F5D6BDA24FFA85E6396DE1613C8DF549249CEFA4D07A1A4FD1AEFE8A7C188EA5C099B2B507275829FB0CAF71B36587581B11B3780B3B6BBC0CE2C44C6FC0D2B3C4B66838CAACCE4223C4D5C5F818AB8C0D7E900000000000000090F171B2530".ToUpper()
                == new BitString(signature).ToHex();
        }

        [Benchmark]
        public void Nist_Dilithium3_Verification()
        {
            var message = new BitArray(new BitString("a88e0909a46674fd71f85745af2ba062cb2b17a027f7cb8cc0211ab8640459f970ce7b68a57144af7ac4f8725e1541860deb9ef8136ff91572936b4f65cfcd2fba79cc2e93dbf5e3fe0bd9b58aea94337e6fd96cf22970a76a9c81c8ed788a892100a88056f870d12d35bbcf80a524d93fc1543440bbee81cba460b3ce45aec176cb19c4c7dd0a336f482f601932cf95f4f56db94a23c080d779142d65756d16b1e85afeef68f59404470f6d83b7cdc421a530f4e971760f88005f71da3fddd717f5fa2fdd76511edf7ceacbbd0661ce73e23188c2780ffc3c98d19dd96585673c0fe31b124f5574edccd6db8759707c87f4e3059cd1266f9afdb2852a37b2b9f0a3b5881f3e4be31275e82a49105b1122d926311be22d40aee6103e04715d2690287ab0ea33ae9b6fe8358afc1b5f52f820ad5262d385c052b8f3a6b018d68dfccdb46bbf27b62f0d71d66a79e17da1632bd1c3ef8f6a875b9513cf1cd4bac984bc1f61159bb10bc6e4ced2b4c8e2f9967a5eb3a6412039ea7ec63bacf42f4d4ccdc4442eb20a976657cccd3dbe25b11a4af4cd15f7354916449a76d6328b5f687054fa6ebcf7c623c1606f8ba47c8337c6316bdef842243e218c880b76f08e034c674782eeb93882880ccbe1f27191d79269582689eac1c512b77cdaebcb1dea26773e634d0612bbffe433ee9c8e2776930016a96afe27c33c91cf165868ce403659d8cecee1d8063b2587ba256db3690ce712b1f033171549bab0795023d8b8d7da7b9c0264a3361fc596d7c6faefe65e6f83cae592f4850826dc400efb46a30d33c84d2b8cf000326a3a777d383eb9989844aab9ee6fd7b52e434ab0f4b968d18c62ca73ca4e9fc52c32a52a32e047294991d429c70fb955bcf6811319bbdbda64f3d53db6ca685b8992743927163c1b21bb48c976a47c902b3d95f6c373d3fb8c8a187d13f7f249af4b32460f5a7816cfaeefe6be9677071ab61e87d31a3b475fa282473b98a4c89c7dc2f6b0d00ca11af3b6e678dca0426d6dc2fecf5d87a8ec520b59cbde529b9e3e812d76699210fe259c617f2d6ef00d35b7f2e759471e62bced76de4ba72bd096671916c8258648daf8d34dfa7f31ffbb0a599d994d60ad8bf425123ea64e44b77256b2d51da176ba1dddd4b0b534bd657b2973f16c1e4477a5d52bf0727c052d3434351ab29c19b224f01a1b9477968e444f9d2bdfb24b352b7f9ad5288cdd08e78c983a84a4740c13d5fc3fe69ce44577387cd3f77854cfcb59e419ad72f4b6117b11fe4dbed815104e1a93b8e0a148c28bdf9af3f2a7bffa8098bcd60c7e6a0415d372da2afa76214dae678081f9b917300bcdb03dccae96e8e8d07c40c0c1d8a462c75cd5373dfbf430d01c49d7f65cdfa6b040618dca165869e122a53c6fc02a684f1a2e890a414386ce3eacfb1bda10d057936c13de5c46c0d5dab8ea09e3c1034643da150582a0f04e954fb5318582ecd265f8136679aaa97d3880c9719b7f383c0289a2cd2a106e2eb0d2b6849fe23eaf2a255f14b175ae2071cdc07579fb72eebcd4f93d4715c0fd596d375a23ed6d3f858f2e431fa5ef1b6b018e31ae9f60b993f26db40228a804ac8eafcccc4f96340d43d4df4db96a6051d33e9adc91d06edfa8f6dca514140c0ebe470f0354b8c0aa026f048db889e3eed2af7c445750f4f8d3329a56c67823b6694f2ed8c5ee3fa4213762dc158670fe40c41d9cb18e7eeeb1e5e7628dd4cc43f6fc6712069e117b446df7fb509bc725918b1f75cbf94cdc92e9a67702da3c8453e24ba395a50d2049f21df8cd2b8d74d9d8cce3a1e0ac474f2665d4ce743be22574bf2d7afbdd301beb182e3a6397e57676b9d7ade65828181647877dcc6eedff4d53530f10c417123451f7ac45a326d6dc71888d86d197246d1b2b0e2fd03af5f0cee334879d6a523ce4a4b69222c686d779624f54e1bb0487a695168cf08279f2b5d9deca3555150d1cb6f9178defc8c0de75a2a01dcee1bd6c3db4a395f0057efceded16e9564f762503fed6c35f92e04ae67d5608ec39c3695774cae258ebd803420fdf6173651ec1110d9d2bdc90fe27c39897be352f04a45103e8d804334855e7e08f63932356ae3dbde139f67c2d4e2485be3f833111b3ef2f3c09f14ce5720269d08105bdea6163aabadcbfb9e2be37e7b5e9dbc1b0815eaae1b7e8b70d6c28ffe5f6f35f30d5990ec45801147dde2e66eaf8dd5c6e22ea879f7e88fc2bc9660653d5c308c703aaed1771301c652394cba7928f849efeaed99cfc27139d5587bd35fd81d9c5f3da4bc18ce0ecf576b824e70e4dc2284de01d4b9072be98510685056ee5c668d2b4fc3714897c28d19a9ce9cbd80eb1edf5760a8e4d0c84dc7a82cae33e9c0678443d30dda959eba37c2c898ccb13d4f9a71d79497b35695948b8303acba372fc5b79d7ab2e9b2ced030644b875b75498b19bb94004d20ac561d219fd9d5a6c40bdedc81522b3d332674b69571fb1468caa0e25c03d02f93fa35137f4f4c5607c4c5e693a49e72d5dfd672467efdf5ee1911326eb2a125e26bc97a413d5833330e4994b5faa2fc199a547340e96e30ac0aa7fc557e7ca0e8949b0d6665fabdd0f2f462e22e64397519f1f887851d9b9142a18f26eab097f63394f63facaefbac25589f11ee3df242552ac283e25cb6d491186ba3513c21d0201a5a0846b50b524297548911184d8ff861eb38b8286a17020e47d2dc68d6cf7bf2d90f6a5709960145ba45f5b25d05c978277e69a7c3cec59794078eb71ea2615547901fceabbdca556287971c930750952b884e457ab0ab7334951a8a3d7625ec33f00dccf270eb819d2e482a3b98adc2af0a9181e3a3afd26e441bd354844082a2d323f0ddf739da5d2e683c045862c33c404d0a52d984b9f7d963d9e6a6b77331f78189deafd1d3646864f88ddda107b8e03cb6f198c2cd61238ff7583c1af3cd1cb9e9f291b97a0d048fa4d21695dcf43cd11ddf1229eea4e46502acac626423a726dba05d21b3e44443be9526d0e83ddbc7a975cb687374743f71e893d30768967c9ff78352f4b265f0a60f7fbb7ab43680e2424465b9359d14367faa6c5aaf067aa88125e66a28b56").ToBytes(true));
            var signature = new BitString("AF315ED940585267984CA13053AE9A59878BBBE45AA28F33BEE04A108BB98C7553A0933D1E0932221D3A684271106B43A0171B055ECF97229E6EEF39819BFB1FB99E2495BFD9EAD59B8C707B684D9A8F18B3EA61974338D9B4C6C62B7D9B318A76D83F06A7754AA4C1C4FDDEEE3D27E3D9F2C1778928F5483103DB095F0BED70D480281FD9C0F29BEF4F40F10098516F537E9F3DCA343F413B3EBA69EF0C9780792D9D12D79AA1C84207016D4FD8D4A4E3F83F8F5DF31C71E5BE95668585632494136D2400FA0F5ED2F1A85D416D9725514BEB0EF55CFBE99FB1324F874A3006B51F7F576C9E5F2162052FC16C6F98336E01A34D1766A056C5737250280E6314937C7C89D2FB88397D9202467CE775856476E076DBA2EB5E82EE83FF7EB4C5720ABB0F4E14D4FDDE5C22A2DFEBAC91128EE7EA393BFC0A257175D3785CEACD116F40BC2377B47A689BF9A6AE4D677EF060925E45858C9BDF05B3CE4C7291793FC761131C2C758350A5B056A5DBC5E6031C302068586B18AC86F21784BE912082626AF45DF777B8512A8FDD2C670A38D59BEA889E89FCCA97002482891DACB86E1E3FF8FC27447F7A34215766F1FDE049F1AE190E1F631385105D0254385716885CFF21AA1C26ABF322ACD3927EC0733B7BE4F5F29BFBD229EB7774352B32638C9DC438FF6ED48AEB5EC2316CB9D3E1248F766CE5596795B38A88EFADA28C6A1994E7FAB2EA7A51174D6A2758144DA2602823CE4E919EFEFBAD2C740F0BF5EBE39E1F295CC91CEF7FE14DCB2D161FA7705C7CE677C2D4FE9AA987BD1FFDB75B16077BBB7235B6A32EEF62AD2D4DEFFE0C63AD599EEE8130404000AD0F4A304E5FE73028D623CF4EEA629649D1711CD42FC192C080B24AED69817BD242FA88FF4D92E825B0FB671D7F70F9D68ECDFA58936B76A24057E8B82BA8922A4A0C85886E2F58942BA2025D175C009461509AC617CCCEACA8C84FAC4C0A23A70025FE32AFD3C17F0B62FBF6FF608E031DA265EE23C63FA2B0E2CE32FF9187E98FEDA9DB5A7B4F2CFE9A50815EDACDC1A46CD50D49587116854709E822CD5B7D6B5FC9D7E5B7DE02984AD3843363FF58E303C3EB1E86C0733D80DC9EF16B663D51470BE2B3737479418BAAFB370ADF8FB539C5809F00E390190C9CAD45E30CE1D4E8E868527174078FF2C5A0CF3B40AD8809BD2330FBECEF51A69CEAFEBD7B9E66EA1B67AF5FE9ED98079D3B169BB4EBA477E84ECA326BA2E232A859357283A5A08A0336A8BFD361F05F03FD8A6DF820CA715259377A850BD2AA02B4355F998794B49C1E209B802AF767D1AA44DAA6FE3F943CED4C87F017E06CFA3D27C9ACB7E5189F6C97524DFC050369BD203B3BD78B0D8A042CEEB561365ECE438FDA9310FAEB72A12180DA85185D8CA89CD7BE28B8D6B2CE9FEB985AC0269A30CE1483523A257616945BA24970FB5625D6CFE7E9F41EAE47853E973A9653F6B1668E5D2C90E908B97934A6612BC3D37E0B809FAC21F070A8580C7F284C6BB6E39CE71C331BC321FFA0E19CCDE0A8E2FCE1B26F0850BF4F2CB92801F6666452E41EE7BB53F66E2170F4A0A0636056D18039E5FD5636AFCC33970C81B328D5AE75AF3422EC9539C0041F3A9DA4A6F5F5C0ED6FC2A0B8EA755B167891F4C90059928ADB6D287FD14D70295D9CCADE447514EF549E11585B771C39015EF8984FE00D9D223B5AFF80082B040C1AD0227CA6884EB497E84FDA16A6D97A1A6D4963DB93BF0926A34A445D39AD0FB877BF7CB5D8DF5420E8EE95E83EA7EC4140B1D8DD5A53E54982AA951CA88DA46108347B4EE92F79CE935D14C052E6F7B9D7016E32EE0DEE050B3C7A27D9C6246DF54A8B370A013132839E594731CF55205F634D6DB8E6C23898B33FFD403C672A880A13035570DA733BDA7EA83DA9C459EB274B9F15DD4348C7740480D7411129A7881E9A38F74188C675E90D30E9B3888F74783AE76B1841CDD83D69A1927D24D1D52EC76093BE40ED9942AA65871638052D038A8BB4D98FD603323BF560C61B1FB8147EEBA9EDCD98E2D9C239A9177A0BF80BFFE209C398CC4021A69622B95EFF31EF175445168E45E2D04D573AD314D9686A00743774F86F58B50FE6AC9F23DDF50B2E659A28EB3DC85E1B9576BE0A1817A416E3C38BE89A50F115D47711110AF6FC103CC964FF52C261735627A3C242913BD3169AAE59AAC7CBB5171BB82FAE58576B970A9A1B946B7D374E1971AD07E572D5ABB66289BA0AF9877562CBA7789EAC75F012034264CB4B0B9C49078AB12F98B038D5395102F0944431E2B5870D41D61020EAD5981A8665C9BCB55FDB7C4FABAE6A829C6192563389762FED11B2FABFBEC02080CE3FFC3A6889E407A4BA4EF18A1A809DA38807C78FCF70B932FE50D8FFCBF6341C75141F9DE630C0CFB531184B30A4BE94142780497A88F242FF9BA8561BD10732A87AED1118F9348757F9B026439ED33C650DEA1ED00B3C8690495A5E5D577ED9EE698E7434FD054FE1A92479FE0D72B9B86CC1231CB320C34F2A1C9CED255E7C8806863F925D9441C6D9D0D16AE957B44AB74E9343EFA1AE6AA7B36B55207DD52DD19DCF371BB81DE7A30ED383FDA82F58C6C070EDF9F37939937D4D8A72ED445A7CD0B74B709B193F1DF7E5A13655BAE63BC5628BC347880830AE70B7A789168852DF1FFC432104E878AEA19EAD1C79918FD4D84414631FCA6234A82259C91B45B51C7F7FFCFE163328A463D464580CE9E6258F9A7AADA6212BA1252113593D730D8509BFAAFAAB4392B7401767180DFE40CF0915E959B999854F6BBAFF0CD5B6D7511575E835A4593EA15EFCA48BA98C058227175E6F88A9AB27631FBBA0ADF81664C115CB83A2C9B340D219467CC9162598CFCC3DD3C061A28F49A805584D01425CB460F2646BC099D286776A92392D39987D328CC5A19C9011106DD17527270B5D803660C7865F248B75C59CEA65D7762491B7B04F10E4DB87DB4C6BEE87CF66031F51B26DDB9275AF46B818C4FA81AC67979DABB501D3742A83FC7330E53E08B5C6D9DDA4465961F377949542EBF43F81A777A39656A45B52F3A7B9965D17A80D1744F72DB3C163B1423A1FF5AAB0608487D8B411A3F5AD56DDAE06FEF1AF0885A69CDCFFC36ADF594BA4C1B9A8669FCC345AC7223220B2C55A6D3FFBE4004BBC8F3ED009854A22A91C178F888C4760D2BAFCFFAF66313150CC302E24955E292FBF6B6719D50F83823336571ECAF8912FFB1A61ED78209BD5C2CA704745E2B13C089F5DB398BADACD8C6B4AEF8B2DAA01AE7F0C6EA329757A6A03E70D18C9016C87B7D0058FF84012175DEBB0DD34959AC58E4C5EE49359A6F94B7E1F13EC938216AEB9E8FFBD8C2E07B2DD043A8706AEFD7ADA86DA75FB1472C662AEF8F19C6B49391D6504EB473FB669509531EA5A6BB59F9B46987819D0389A0747864C213E4AD0016A0B83152933F461404147533D74C51DF3B6A59A78CCF0C6AB6A803C6523EE5655877616C7D99690A4005DD26F495EA15FAB69BF4C521C2E23DBCC6A8C956B37496B34082AC8CDC29DEC3289915D261318CC62FF85CE5518D96D253BA41D536C3DE30E51121EFE27703F45D10EAC5153792AC873F2FB3977B965B9A5504431B15D3B8FFD3DB5F279D09D453220D11CE90AAB6C877D7900BA1053E4BA8D19A96AF0C8C32B9542E9CB6D0572E0C6CEE00F6DEAC47C43835265996A28E614147DC2D236BD3EDF35440313AF3525DC5BAA0AA06E33606874DC2A98D894CB8FE992095E84FEE396E32D4EFE1324E649455E78C2729E4322B4F2AE15931E424120255CA7791EDA0B48E582E791B3463DBF96048932E4897AB9B1FB7BF4EA0720D720873B9FD2A7149DE515D45829D65DE7A88507854913D019F043329758D51CC401F1580B727DFD853B110B6201EDEEC2445F4442B8957738FE09028516E85BC6ED80C3D52004389EC13159F668C3A9811209DD467AB0256076924FB956085EC29B8742AD80C4A91D82C9E8C25D10AE9085643693B5244A2E5EAFCC9141CD9BF446D01C02B8156378482FF9A42159676F440201754784FDE54CDA7326AE19F0AA783E086F1434F849CD7848F295E734A42412001CBB0A4CBA8859FDF21B73AA6016551A1279B2D83DE9A1B3CFD224F09A931039979C652F090E47CF7722D516662DD6B3515D79D2FB44C5FC3F983AA759B0C8398906D56F957B58C74060CCEE7F71CAA4E2BA75B1560587CCA193B1EDE8C9A02DB915E581855395FE613C390E55470FE40EF71B961216907805E7D06A18D4C3B0138D65DF6F86EC9A0FB6572AD432839E68704FAE98B71E59ACA4CC0EB31D7C45C2F39A7BE6211B65FDA169BCBFC4B3ED605B3C20D643CC8E12674448B0F441CAE5267A6A9C99A293FE9E0419ACE2ABFD7161953283B581CAB79D4E9898E1B20F545B84001B88BD620679ACAE894E55485022E57BF15410A6712A8D6E855132F1C02376E07372744623AF54291433E62AF19DA94072AF8EAD56E67B59CCDBDBDD99DC8457D1E43E700A0E5A5A3F5D6BDA24FFA85E6396DE1613C8DF549249CEFA4D07A1A4FD1AEFE8A7C188EA5C099B2B507275829FB0CAF71B36587581B11B3780B3B6BBC0CE2C44C6FC0D2B3C4B66838CAACCE4223C4D5C5F818AB8C0D7E900000000000000090F171B2530").ToBytes();
            var pk = new BitString("44eab878f12f7b1e1cd44ada06dad38ead30d732ad8a1449be32f2ae5699c92ad9a5605bee583ebc71e749c7db70c734fdb540c2d3afaac8aa2b0943886d2749f5a3811affc2428fcac1f68807120805b408fa1e1ef33d72fd6443feb2e9e9c4ea1ce8e296de5449356a5b403646ec2f31c15df80e5f986f74961a3eea5196797022d5769f68e6e0a2c438ba8cdc05db8553068c92a745edf8a17da99269457e9661bc9a0f966f2cbc38b4e592936f0cd14df027d125a6fc5a12ba50d381a61e736e8a098ab6afa29f4e2020ef74923bde024e054e82a0e87749f7bb24d3c6a719a01505b57a7e805a3376ac35cb5549b158fdda36e4ce2323e4a4c85dcf10647431d3fb39dee2e699c45b06c8a425e5e4b3a8d3e3670eea65379aee2731488cdf138a31f4831a2549495c160220b0f5634fe24b5c0a45a248aef8a3e57c4a606c25a6dd977b241b065d6da5c0ff15910a4999f698889e2606aabb7441c7a3af3e4743a12c4eea1337a2f17519bebfd6783de848b58d2e66a2e26450a94db23f94e57335ce51efb0caf45d23623c7ebf91cd6a41f4ab85090c93f51dca67e9dfe1c3f38f6da9b518c33d7607954663fbdb9cec59e130e780bf9d2e7b157849bed46be0763efcd70fbcba6bebc75391d019cc4755873a55704455d4159485224d99ba5f34274f954fa14ffb7cc41f72e8b74efcfdd640263722e7a477aed4973a87cd90c672e87b9db0e985fd539b1822273183f2208d5a665810e34f4590ff758ff2362d61af262bc9d1a3ff5b71a2911ebbb4e85bc515e3f90b75082530d90197a7cd104eef54a7f9ae7b42cee7f81917eb1df24d4ebe806e86c4c955598d2f161caa95c7de8e65508914177f5fd91b910129e3fa31d6b3897c5cf317f5c178f027a6b9bce2197536114b61371531ab5ec850e189277ca616b04e4c51eb4d4d7f3710fd63a6cc29ce6478baf7a640e0de62e9461f5495bcc7793eb113dc7cdf94769f4ff5ff734f5c16ab411ca3f74db473b1420cceb5b3e5d713e72f7ca61293647afa3610ba4b278b2e45bb011a2dc2e3d6a6d94d48ea8e4a7941cbf4a566a9adf08c575966daf575d66aae8bedde806c6bad57efa0ff1bf7493701250af407a9ca172b447c8e92645a46e45815a6691b657e3ead6add30d46a6863d981deb28db4be18c37d16febacd1ca5f8143c774dc3f9a7a2233824eb53e189938a28a6a6fed1274b03e9a39d4bc7798de280c2016921b3da14daa4c4597c7e47be8cc3ef4b8cfa2e5987cf24ef8623ac146807a89e3d3f5bf3a6ab0fd9859213230d0e32fd0f0c2d397230a148a3b8eb435e5dca4dcd39da2491df7d73e1d48da01579a3de1f4bdb52ef221490fc7cda8d9cc0f8cae88758118dffc0f977536aca12441921f24acd80f0a754e6492c48581415f1fa99858e32bd8cfef56135b54582e42d31273cb02af0a8f0a2d66c188c547ad63296e082769025bd5a2152684422f8b124299e237610770b08219d609445fe4332ea51f6cf9bc131c6bd254f9dbd85f286251ca128ed395f2e8955460b364a31772f62a6924e2feb1e5df3de601d868828474e81fd0c7722527aeb5730d4905f49d77278f6b90fe8bff9874d5554826787e3aa822f40ea50f3f2ec14615f7a6986a961b116b2e28790b20f88bca2227d1f7d77ff4ec8af0a75ea1390dcbe8416c90c30003e3a787d6fb691ac99988082cedc3fd5cb131e5a2f9de30b8a4daca68b725bbfed32fc0ebcd4527c515268a071b6528cebb6f65ac86f955810950227f7696b45ba61a1b2bf80302631d2848a91e7038c86d7d8151c121d0a8c514f74d7493c9ab0fb8789fc0ad42258b0c157632f9babce1df0c3a52fb35b4e38939b0ea5ce96b9ceb1bc95d2b40498fde7d1414721f8a434be4ccbd4b73bcb6970da915a666d2bf78590f8c690e0829504c2db438adfdd46a761d292f837deda1386d9a5004f3802e8c2c9339ee24020b3032a966ed02af01011ed203dece0ffd69dbdefc66099ebc7c3348552e17acd74f5dee3ccbe5475cd1f03fb32ee2731e8140c1010eed9414561167fa9ddf7443296e2f6a415bc0b9a1c1cde5ba1ddaec30d5b85cc5edf55a4011c804bc0cf38313c0699964fa6c124cd3cb6d409251a79b9696b1dee7bf5c7f2cb444449cfd8e8dc46d333fa8eea1b626756e2a4726303df93a26d68f44b60b4b4893fa5532cb631f8af657e88160c3a4529c92336e3de85515ef1fa45566c687eee5ebd426c8f6793517d4e2ccfa67e2e0c1e3e105542160c80d0e60713bff039586dcd84b4071b7b6d088f161c987cdb1e835df79c1b3e5bc90367e1a37f4ab7af294d75de9ac5ccfc652709a9b9551f3b63ad31f24d5d3880afa912ffb038e6f52fb064e798c519e669e0952f321c487c6a61a4a5d8847006a20e1b89316730cbf97c779edbadad81a7db804a73b8863ce8c3d15e0ace82724169d37774a60df82f5433903231848d145062c7ea33c2ee733ef1c18e892adf003443e6eafed144b6a3a7fda28fc1b29e67755fa11f2f34bb569ec9c21cbdb61ea0116d9234f1ef66822bdf9fd513a907e50308acaf443d1bd2880fda494f6416b83dc348b4f6a6f111a3896992bc8ebd22eeb27bb261db9e34a0bd636909d99a4d8418c75b503426fdca67f3c31af168e4b12dc611b1bfb377de7c235c981b9f17ad180c83e68cf8c9c5d5064ee70b2e0434f2544e508c2d759559bf0e1c0c15ef8a3012b4c986e8a58a68").ToBytes();

            var dilithium = new Dilithium(new NIST.CVP.ACVTS.Libraries.Crypto.Common.PQC.Dilithium.DilithiumParameters(DilithiumParameterSet.ML_DSA_65), new NativeShaFactory(), new EntropyProvider(new Random800_90()));
            var verify = dilithium.Verify(pk, signature, message);
        }

        [Benchmark]
        public void Nist_Dilithium5_KeyGeneration()
        {
            var seed = new BitArray(new BitString(@"fee3fc48931edc08ea5490fcc3f21745719488129bd78cedb3f7e073e1cfd5f3").ToBytes(true));

            var dilithium = new Dilithium(new NIST.CVP.ACVTS.Libraries.Crypto.Common.PQC.Dilithium.DilithiumParameters(DilithiumParameterSet.ML_DSA_87), new NativeShaFactory(), new EntropyProvider(new Random800_90()));

            var key = dilithium.GenerateKey(seed);

        }

        [Benchmark]
        public void Nist_Dilithium5_Signing()
        {
            var message = new BitArray(new BitString("14426334940960773bff65f08d1de489c4c3ed36").ToBytes(true));
            var sk = new BitString("2d1e6bed8452ebf126ede70ca0a2b50d03342d5b13b2ae210f4562a3bf670cb1ad6da76b2c632f1933a8300ceb37d4a0d7152fa8774bb78d1652b805a0853f62b68b9a12161f20ad44ae46f610810be9ce3c7493d0635251fb5e1dd7ff276c7b0424ad8222693cf69dc274d0e0d622638facbfd64c94518cc6bdaac5ff723395d12461cac429082626d94620a1104d521844083724c4088c84c44019895018b26cd2c23003190963200620b0706042881032082398044416081a034ddaa2652201411b4332093726c2226ac0288ca4286100960424144c244952dab490dc92705cb6301c435119b140d4b44d13a2202337262349684bc66163b68119b7456124819136651101325b3690589001d31862c244608232282047200c318818440d53040152908849043212120ea14060d9a049a2b2059ab60143b88954000a988289411431a40602dc181061388d09a8891c256ae4a6415aa809e19661d0420242340912456d03444622234023a2205a14705c387061a84920182121c6890a012840060494986064160a9a80105c004112918121c509a31624c1242de2444641a490c992310b054093a08000228858006203146ae2300203262e18184c52120ed3824cc926008044728b9650014362d8c8105420320a3989c4800894182d18b0519244682282211c422cd4461009328983a01159268a14190e9a124419910420416464448544b820a4b031920291630226532841e0c40da4142ec0c46c08c989e1006490b80c4b422a1c244d912620c04468480408434802d34232129091d1047213c62d12b680e3369164464d814269c2a8311b42245b2002110530092125d24869888064199268a1b28d64082802050a51c2081a154564268a8236421826641b4446843845c924805304626006301382451b16624188258c90640b096e21196214822d143704d4040903084411028d198224d13284c14648dc2491248448094560532442622490ca986c140201dc026a81304661144ec20868e44852089528c232120996449344681b052c4b346509940cda284dc32052018725000492d1b4914a888ca4120a09062411c825e0364581346ca1447148386a1b9445189151e1c02d212609184780490282e24872e1064d8c48054b34609bc689e4364848b68d21986c1c050c50888101c4644b842109244acc283121338e003646ca445263246c223104d01888e4160d5032319c08419c002d00c808c8a200a1b40d13c30501090811b04d1c4286631672c23206d1224e8c228e5998808ab8711c998921c9004a184d0a184ee00264030402c3106ca1a82dca1028a01029cc984804a4650c27711bc189d9c40480b06801a68c88b691d01232222312018450c894900ba14103006299460e20236a0825890a018e08176d1306241c2821c2264d210992d41261a094085a2424e1046e99222453308294846042b624a1202d5c280921a46944449200c660cc10650a098e8a168c91084203c331e1246cc39224e4288dc41646d1406c58846c0c184224470d629088014429c3248a1c260c013664020608d9888549c04049188d19046d019831a2260d8a222853c22064248860c4914c048c0a33680b036919494e0946466310418a446840086d19432ec8b68008942c21438ea4820542148ca1240698045040488e20404c43b829038040621068e23051e492441bc240629290ca262649c085a13446124124d13810da4884db26120b174ae2a8010c4612c928705ba668183185892631a1a69118332e03312814804504397109b3410837401ab66989985161245299064583460e0b1785042001a04242c09845481660c23625c2c6648822040b46320a17101cb17000904418a388231762101351ca486d4a2648904620a142466242649ca62998b42498047009288960324402852dd9086d5930905b044460b26591423019432e4096510492414bb22c133922c03024d84644d420664904925cb208913272d44200c24672e0067288104ce140319b108608861042206951a0498cb46c61226518010d60b460210349d3b2648020024bb01053c86d09068e03a02d03044e48480e0a026e1c440a5a02642314641239485bc68c10408aa0366c13072683306414950d4bc88d00a62400464e5946248442718988680b994c0c188e60b0682414100108499aa62c030086e2b410c18010279ef211330631d2b793c430e28f595db4919e0aa855dfa50bc3474191605e13df24c1af90ffc7fe760a385d2b6187bab2232c8d2c3017590d7be39dc162e840cdc5a30879e151f327e9be86c2908b8635da12a71fd8199eb201dcb6a5056bfd1a096533b2d2c95a7c25c7206362df0e63c20a15c6c5448aa7fdb1d87d9ca301a0891ae0013432d3785bba7f65022a677a6a6afc189aee83f22de36c78cc5d25773b586a596a906a2b6d046bcf43338d0e0eac95a44a8c71ac6886d60d7b69f6d7e0ffdfbcba4b879690ccd2cd13b0c5de9f66a3280fd9ba7840767958679210b530a719e682648f985c707246f0daa5561ffc95fb501ccc92340cec04cea553b6ce130f6a13d006bb938f1f35506341fe6d3c04cc5618754802e3ba72a035265caf87717b0795cfb48f55ea2faf9b190d6767dd39726e01e74fabe5ab2c4c57b868db83b49a40f5fc382239f45a7b681a3b680b13baebe6c3adce77f48d1ee4b217f4bb2b628d6e607dc100655fbecfbe0cc7ec286e6dc7f163606b9223ca2019e84e2d39c3c269a671f559f29d1f5c101675099fca4d31f3d793b62d88e8d4ed471136223eb8cd0b6e0115e02283d15d1b14350ca9921573e93170da8af0e2b6529ff4277f319836cc865c1ade56fd94a6c44c282b5551080eced62136e88d644f5fdb67b843821b9b48f6646042e94c07e92adb030b0fc292e1c80142bc3eaa14d516ac1a965bd5270d3d94f448b499bb55365ebcefb1e42010e34a410a88587671befbf2e84fb282db59fa24372c3aee5281899cd18741d14e528dd3f27723b4b9e951cdedecef4cb712f47555914a58ed1e26093d733adf5b3d10bf592c831fe999e894e890841739fca0250237b373ca976d0f6f8689121734f8864c7e06b22ba550d634aa578b83c252fbd9ac67025c18cd84bd0a451cccd158b52877dd90c655279dd0039134b6ba11e899672409e41333147b6898dc098ca5859e3a207949f35465659f07e61d742ea2e441a29174e1c6bc3bff7cc24f5266d13369fdea026788f359a21179edc58cb7e74bcfca1e3620660541b31a7fce7f7a9a5e391202af6ac1f3705d8eff6964f5c7375bd93fef471bd85a9c1cd0edc930b4d8ef191bc6fba1bd6bcc19b689a510b069b1b91b7e777654f28ad941ebdd97d1bf9a3790fba8a841b2c1ace2af0352eeb67ce001e58585f2c8ab57b1f4978ac00847e1e5f4e260028a6cfb6fea7826e1821fd84bbcf4d49b9363920ac1eda336181f225c1914111f9b3b9e4804428f95877c5bcaa775f5b43d95d88a9aa04a706ff499e258d19a38d0e610c0bb1279b2b185473df7ff3f31a88b864f63d1c2ad8a701f70c99a3aa8d134a562d8f68a0d285f1643e89756800a18694f5df2634ba0fd621187edd19db6387f04f99a081f4ed7d32b3063c8ea0f9e62719094b3af8b5f1f48f33ab3e97777ee6e06815e747221ebbfc26974cc7c6c11cf2db29d70bc820e7ce6b1e246bdb83d75aa5fba511d78e312e09bee38bab44928713f0c99e44a6557fa6017ce7f0777d6280224fae7eef3cedc0bdf4c73a5a6d9464c65637dd38e42af426450bf4ee69c9842de3196353dd2d1915f417fe33909d8b96a363a4ea3f0b5353605414520331992a75f8ab12c8656fb75c2e92e49ba692c82db57800d14e9a59c528b3680f7e7ac71fa7b58bffa923e0bd483501c2d649fbdbc39b93a6ed3b63b98d5fe1ffef3c01229c8d05f30dfe9bc9f434d61fa8f36ca5726d5069938a20d19e8545c487df6a42033b36292b559e200b181e54ad120b650c3661f4a27ca6b13d1800a1d98f7eea521497825efcbf1a752cae52912cd099089dfe81d950da6d668620ca325df22459f76abf0e8c06e051f704f0e27c62a88bfabe62e574779ae791294a8cde7ae1d91608f3b2945c77f100205a077f609cd9e50098e16225e614c0da47b6c01d415b707465b295c73dcd54f00f0b2071e0a23ba6a0a2745ef4dc2d7887de9f718fa16ad41ebd82b2c86ac19ff0db5495d126345d1c56a81993697822da0b874b70995f2e05f6ba14c38bb3a11f756aa10a8bd91dbb3bfd2efb12a6d196c357cd5f8c439f77fc8f587d1eb1bc06f24a330692a131fa2ac3ee9dd392859fb36d0d2a5e60e43ef868898f803580f24cb7ec6f2d10863a18d1d77be3a0ce703334753fc5987955b5170bc8d8ba05f8c00cd26755980ad151907b54cc11991d4a0ef55fa28f5e9b0c89eb98abed4e57cad3308a025a452c94d56ea168363e941656ca2e72818cc83574af22eaeeaef93ec6111833530abef4c225add96381583e257511750a475f93c778c536cb800a5c748bcb14ba0ab41c7daedb092663a6e861d933b45eb73f8fe2af2f19a5f010b7fd844f59d69436d9e2fc0ee2bb4031265bcf9cd51c904c08da39959765e8f79128a1d7935fe0a6b6b3cde71211cc441d45527afa9ed4c1d916478b6c137f40c230353f8c2d3a9e2fe693e5d478d6b4eae46fdca0ebfd3cdac062a5a34dd0e7ab9d38a476105151f27179323b9802ee3f84a85cbd853f9557e3505594cf2979aff8e7ec20372decaff99241c2ded689f811ae5700fac50b44ddffa8146f3b081680cbc1a80126e2143729f2ae02d8a2ab3d34d8f7cdcb286aea72230f0fa0a1e574afef0cfc139530c5922313acd2d705b7bcdc25a5a8938d787593733e3f34010cfc0789d3b8870e5bde947f82d0bd048ec0b640750d424c785811bb41a6d4243826500e1be5983994a61bc8baba22e792300898ebc79e2472601d0fc093c484c5eb2a8696a5db7060ba1b4b988d78bb70471fc4e39b30a673ad3dc1164ad81f6a9f0a26a1c015263f1895efd8d2298fa41e1ce931cc1c190834a63653f970117f7bd658bb9292880963b20b5b40520b6c3f6bf80c8ff9f100dbf76524a410e7da09c1218c57b44685e0e9d7213509e181d3ed469acce8ceda80a9ffa4de9b95422af55570067d2b5c073b00a89185500e64498f507aa4fc1daafa3d7d77c7c8471cc0165d093146154e30c6de15983c9e41247a879571ee1d74b359f7fbd0a0e502101ae25e8611d0c5639aceff8c098e7ce79d08c0c9a45bb387207c4f68bdf1df9311922dcf43ca84d5c23668ae647c10b47b2940fbb1f2f045588835f342fcfc93ca21139536fe67bb6b2f5e0258a166c9965edb1c4dbf9bc6fa781b9a0ee08923b7284051a42192eec48673a64e32c3af6cd660c524bd9d5a2dd5a8ec5d23f00f90263ee7d0da01ca1b74e79b0c5bcba891a68a449a560df65c513df1fa24b2ef93de06dcf846bc58c1f1771527ce1bb988e98110547652f67a91f8bb77c5ab8de07e4921e3f9d8885f2cf7ccc434ef578ec60ad2011afb14cfd99a99f24c04e71142ec863f11dc0a1500746cc84e52ca88a0d52568ed8e5e955b631a40d1417769da21d11d8661a7d3e676c3d4a201f4816f35706703455cc1150c6e3f62450ae59a335d20df5f7251f362e297673cd212cb47bedb129671e1671b1eafee9f0ce3d7b0673e544af494c275c42e5360ad474348422e019b2beb35726c9b973e2e25a021a914be0696f81db0e2cc25750bfeaec24f850524cbf3b24d88a8bfa37d2fb937846b0d1e244f448f5167e3414e702b0688190dc2ebe1b5f65e3152e5bef74be432a19b1b72e23d245759c5382110db0e2b76f428c481391ee12fb75878dbedca336831d42c9eb51667f1d04a4afa7e6b366430980be0b859942a1b7f7b7b43399ccbe0c9a353f4f26b69ce7d699ee0c99d870b41316efb61549bb1580abda37711423289f2a69f6866c146c815f253167e69c164e94c1a4b1f558dfba1d24361faffea8418f13de0251a0f119c310d5e00aae8597b3e2cb5ed6f68a3bc3167060e93ecb9a7d936b476c3dd332a9f9d70114acaa54b2fb47a63619d96b75803affb74600047379947d6fd92502256b440c46a959595d84f45e3b0dc91dfb5709182dd817c040f1c2392ef3d7987150b87c34917254b8932648ba0150b0ab1e2fa915ccdb98cc69dc888b5d8a91b1b81f213cc65c825a9c9d42ce99db96458dcb7d11047ed37e6ed9a172eb4a6a8bd1abbf6a4b5c5dac443db58ab644575f9ff0383e6f7f4f2f7a82de08dd9eb3671c2a9d77a0866280a3281571f848daa202472e8aeb78a2ac3f3065d160e960bbed6212f0312e67198cd5b2cf17e5961dd873b42e1ca9db41ce94036dd7d65d1e1968261b1739fe6b96e24f11cf3d5204e81187d53a50ee6d1aab0471549b7d73881b6ecdfd3b8e88583c56c40cc50ceb068acc22791bf74d4bf679619bc836f45ecd12b227adcdc512c14432fbb34c0341cd8e0e0472d89753eba65d18398a060a013fe12930bb8f0c09ce7065db3a5b83efa094781c667bf8a8a5227b4b34898a759d7f58609724dac75154d469cb944371e4cebfae595793f68cd4406bb7a900bfa085ed1395c3f6d0acaf5e953282c81d9f45a55be950e6fee269f0d53a066d93a7a5f6ad4db81370559b8aecb745c6dec494f56bf46095d53ed72c54f800e003baca3b442244f93e014777266711794c78f0ec09115c508eca4aaaef827b78a910e7cf60e72267493b5ca914a63990473987a4627d9ea279e9a07c315dd2eced84c1c37ed582a101687fcdf53bb2b61cb53af4aebd01fa1af9b035a0e840520dfa70b076231644705f211d7f8efa4c").ToBytes();

            var dilithium = new Dilithium(new NIST.CVP.ACVTS.Libraries.Crypto.Common.PQC.Dilithium.DilithiumParameters(DilithiumParameterSet.ML_DSA_87), new NativeShaFactory(), new EntropyProvider(new Random800_90()));
            var signature = dilithium.Sign(sk, message, true);

            bool match = "13E899EEDCCC0FBA629144E4AC067906B5326B8F9A6CCBABE1444ADD4645160D2257828710D1EE106021B5641E78815575D4F095D015D8465C92D2DDF4ABDFBEBE1EC5DF70C8DAB2E548D3047DEF546BE725F1821AAA8B9F4F4918BE6686C6AFB657E37A3BCBDDB4B484C67A4D9C922003873DD38EE947EDFA681E38272138B8CCBB374172B2339323429C61C15B8C6301998341276A6E904A95E835308AED40CA6B419F796320950E240D6F9EAB1D8E7BD4DA06C372BE26C1A0D858713B361D69C340DD0C639E91263071CFA5E5960CA3232D1164F0238DB96AC848CFD3666086B328FB5BC17340C876C2C94D897F552C1A326151E743755881544488717494B63817B86C849C25410C178AD9C5B1D20043F85E24329953A6B26A1425AD6E496EF79D214616C0576C09F62ED062BCC68A333AC7284E34937DFB5C42D37F83ED29DDEA30D800A0B5385C17B9ED17A5D52752C0F974C4E3E1217843BE5ABF1EB5BEEC30B1D181691E2E935BDA4ADA77627EDEDA5F58973EA3CD467BFBA83B991CC5553B7CB010485652301ED6F5AFAE98CF2A4310ADC8E97384B2928BFF0B191541C5D8C48360898AE13E8367B70F3F918B0D8240008F2A663BDD91D83A4DA1087ED9DC5585EBD263F7B83CF730F86EA6A4FD580F5C44F6AEFDC08A9A98D1A3122E7E4836882D26820D5830AA8AC832A6E181F58EF4BE233710B5160888B70D390EF98B9A4594E045EF58B8C96E98CF6811A51A29F735EA289DA38C21E6AD8262E4601E4DD0F96EB0EDEC68B6623498A331D7A89D424DC2A5A7F6F35552E79631CC2CAFEA13CCADA4C79CDBBC52B178B49065F9BDF2E6763EE6DCB8982C5E79323E67674A8DC7525898D98BE311BD70513566986F731CFBF5CAD9845FC0D1ABA86F0EF83D5DCB2F01C2CFE38E6AE8474A301916CDF5E0D52B45698E790EA3C60EFE5C1F8717B8226B8C07B0420FB1D5440894B25D693FFF12686615B1A03FD5D4E570CAF2B18825574766F6E99737E05510348B5ED4550EBCF8525C634497DE1D8D3A757848DC40172D43135E5071BE3F04782DD9C20C2AE41C8611AAD739A21E6D6FEC570C89FCE146486A61EE1A5B960AF7391A34A73FD4B3041FD9EE3FF99EED3E739429F02BB6A33C525E6809F1104503E245B4AC4F03F7AE767E74D531C5FA83D171E444A167FA40EBF4F1554E454A0026C8011D2B2A998CEC9CF740FBD74081F20AE88666DF71D0130EC60EF9A0D0F977C3D02965AA17CD7F2AE9344985ED6DFD138AB0C7CB03DF9D268DA324EA5E2A5223D32B84082D7794A22CEC939848B9E65F3BB9DD5D0EAF8741800D61B086748ED76073B26C86B69E6C8143610348AFA88C581E455975C70F54C89D259430503DA70DFDF61F718844198CCB7335C0337FDABB854D6BA9847B663A8CF3FE53F85E58AB4501456191278AF6B26C7B4C6421F4771C864F80C9F8022714F5A8F6B3EE55939042516DA5622D5E24D0F0E50718F36BAA58A01AD5B38DAD5391961F4C699AC60326EC41302FA7EFF6A7D5E0ACC0243B526566812C5A7F53384D50B63E29C98D2AD0E4C9C5E01F3E7742D9EF88CCBE5118770D06408242FB86E78D01E81590DC6987244062D2319D6600B26E532093938644638CE759735FDE6FD0C68F3748C6100F78FEE0FEC9B3F085E166D64B64E3DFCA73562F605B578162E45E2E63CE7A4CB696D1243875E45A5F913C42D39BF8C0395327315F2D7B011F2C3E29C981B09770B06DB6BE8AEE09F42AC7492DAB4E165A63C7A5634EECAE93C529D466F0065E2E757CD3BF82A6529594C8742C55361D2F91E98FF6428D95ACE890DCEBD348736BA3EC25F7DFEC95A302A54BBCDD7CBB3AAF968C3CE108D3E99466E0859FBB98293AFDBA900D870E25EACDCA60F9AE9BB22ED336DEE5BCA9DFE2CBA99FF87141D3175908D72087B275DE89346F0AEF49B159ECFB6849840F2D0CB701FCD918EA3BCAC340BF3445C6D0BE06F6EBD15213812FC37DD97B2AA6A363B2CEE6C59F6D713AA0FF474FD86FB9F7DA684563BC9DA806B14C194825AD837DBE4FE518B7C41235FB00BD2C799218030538A0762F383CB2B0A3BB3E57E49577A3DE7B875ED80219C2AF9152E56D7B35D6F8C5533A3DB0C6B8AE1ABEA1DEF563EC3253FF5DD0CA14501DE1DC6A1B9F1BAC7601B8036442F2ED609658D9FD4091FACE68AB8D49D8E4BC0A67C2D33F0C480DA65C046A084FEB5D072478B1E279024D8A2338E92B8E155741DF71679D6A2CD2DD13FB53D09AE5239B1BD42087AE78E0380105A011393FC7A7FF85261DB056DE7E153AF0FCC027DDC8F8A3183E89CE385976895511ABB4B56EDDFD4AD60799BE19D7F4D79039DEAA8E1D7555EC33406CD8B53F524EE17E2906687D1D9FD36B7A18E3CE7D857D22E5A2860FB63A5632561655F4B8D18200DE77B99F6A30006AC47BD8383689D3934E57EEF543848200DD1E6B0669111B2F32613C28FA2F911BF21A348E9464739AEF941ACABD521F3249927DAC8CD8D3C03B103A4685AC29CF2ECD4C83A20028570E75378D5BCA3198DE84A94BBC444DA24D823A4540C07E6E5C98D892FA7929BA7453C0DCD34CDB74FE65B0C732145FCD493C09377DD0109BFCF3C2367C2BCD598B6A99FEFEFAA037AD3CA7BA3519F4056056D5FB502BF02D0D3BCFE3A63D48EE41E468E9EA1F673A5C02D26CB312BAE3ED1B2213ADEF4A31E813FF57495349A7C6B41A0721CA54385CB3DFA5FADDA626CCAE8A04453F409A19E53252389EC32D6384B1584F861FFFA15CF90FD9DC81515DD6A66C04334EB3552D76A596AE6A8A0A3003E39FC2382588FD9D6F701A0DB72DEEE3601BD4FC7452E3CCFACB1E50670F72F2A71183A51F4BC193C18FBF95D0CE336D4916B9F08CFA3F8B96E554CE1B07D5E52733CB92ADCF15C61C0433DEDCE267204C6F4E34273D5E59F7A7E6AC9A7B89E5EF739A0CDDABE56F63FB5E2CC07D03C57411F0FC27D65040BE455DC1F42E4761D6F4DA5FF41CF463D2C3453FE6D5A50A0A54A3217B99F7030CD929CFA3ABB5F3AA262193598AD732B2A295B27B76847D6BC1F36B84302F4B55597367EC25633D46E8BDF80A2DC447A79EF374F996B36540A82323424B9885104204AB614693BDC888F3FC295BBD115A1F7520CF95ED9C8466B3938382EFE4B928EA9A23F63D8D435C8606C869E316E2A5B27AC9EA82109B214CC906BF1C9F480F392D89C6636BA31E259AA215156DCFDBA7D8DD9D9A1D619F53D4EF10BF93862FD2B994B6B6D1E2FF69B5223809538C71736F0B6874C7568380FE7F81BE6B43E3904D7B2A82DFD8631DB3809D02E76370EAFC86A7A0562B65084423FDC38D0B64BC9A34D40C6304E40AF889FFF682DA2F79EEE3CCEAD00AFF370691F8A2B2555D785E5683FF20E9C4A7B6CCB63B9E7362F14C160DDE094FB593E2F4FA410DE049E485696A2A73891A5F230D3D7FCF3B20226338835E24669157D48AFA8994167DE9BCFEDE94FD8E3533C025A774D35980663E86A9A00E25224FA965F4D3A48C1C6ED640915561A7F10EAE35443A3431A63ED1FF223494EF51E2C79AB8481F9D68736470B4B573B145A991F51330AE35CB8BEE3FFEA81DACB977530551C9F3B3A02C70B44A639541C226E0294F1CD092A0FF099795788B23BD7719488ED2DE72F8909D564F591EAE9FCED751C999FBB50325F265D1FEA93A3FE376689DEB18C4CE4F4654536AFF09C33F0D583711614228C429F93A9969F4CBD36469190D5DF70E95494231FF7B21CCBEACB1B81A30D6DA830D0634334EAA4746BF37FE15806E3BEBC4E93B5D1CFF7A68288503F4597D1B07D3471AE598B872AF422DC0BDA0D426882FCFDA947ED9A4DA22598BCA5D0CE84EC6F03EBD5BCB335C9035C8A030E5BD518EADDEEA951BA78F05205F97A1C287958CDBCB62EF6AE16D27FB7B9BF201AD2B6376ECB82F6D20CCA1324A702B3FEDF603144AE844237F86214771C1360F81D3BC3998DF24DA97FD311E3FCB52A49FE14FA6844A05AB1C1BD51D20F85143F9FAFD6CE1BE0BA6E169E65D5234E3BEE5445F8748B10494C739A8C606888C69C77A568860286313BD211881DC82726C1446A9082EB8D90A5715E7E2F5C2532B0B7E2CE37BBF42ACCC475E8CCDBB483D6E07A273EECB174CC3C8BC2E004FDDF9E019711A630AF759F7EA6F5D2F919059E7EBA65BC45D481876E7CD42C1AC2EDCF9C0819AEF13BA89FC712A00FCAE557B8939E8DDE6D70D03FBF92E12A90F386C90ECAD51B36F3FA2B7673620C971D30634DFCBAA3E1139176503D6942DE6C77BBCF6BE9A8595AC664A9278375BD3C45A2A397EB74AD2CA70CEB2A1AD7013357BEAB5964A435F9ED1E820680D599FE1188BB69BBE61533EDE7938BB5E372D81E8C0C5FF2AC26C0BF152F43C1D9EF9DD8A8799CA0A7995368640BEABB55DCD27C50B2A9CF020BFB0D1FC125C53FD7D91D111EDC0B6ECA6D1878BD10B98477E2601E1FA6AAEEF315B80E4C167C2331DB32041F56C633226EFBC23F7E228AF5BE74C7833829F66A8757728CFDB64DBAF98E59171CC650620F72964FFAF09CA98862D4CFF40113455DDE7153346D7E1A7595F8A40FEB0B1527DF9BB8DEF50C4D5EB54AA62FD135E08629B9296E2481419F17B8FB588936AB15CD1089AF6E4F0C9C55F9373C903E47009F41B59BD82A7C9CF9E63F53C3232787968AB606A0318607A2B019268090146730F638F8A376324EA81BDE61DC304FC39B50DA00F21EDC52708E18CD28FB26D5F793FC8D4B38FAC45D3D4BD383D1504DF32E80342FF93D23407C1B8B2EB96F48EB5C3380B44D12DFD8B8FE2396A6C288ED66815B423B7439D97485D7399ADBCC714FD87BC76FB72EE474722E5443A04FAA1FD34A85894DF13F99916F768B4D1C55D32059DC9E9C06A47DB3C1F6DF75A0ED6C84743E9AF757A87AE9BD6261B959DF6ADB4D3A8C795D577D06213E5064E17B962C85C3C43401ECEC7366E402727E1036CFFC6E4CDB04A292456BBEA8C340B5311ACD04608B168F3C5E73A15FF528D1EA8A19D75FA796CEB10B62A2E65C2FE914D0205E5C30A1F8818314E64F2B4C9546D0637461AAA3116EDA83E92567E7D0B4364DF7031B4A86FED3C003A5E1980CE8A5E9FAD1969258C66E559E0282A65F9BDE8AECA743E1C0DA0FB4E08A2488355E34B421A1F9EAA9A7835D2C6E33C7DF02262E2AF6D17736D4BE3F6C9CCD66D5F126346C1BE5742EBA1AF850C3D99B4FACE7EFDD087693590ECCDFC10E1D76E202F945D001E1668FC5578FA3384212CE6D9F9BD1C7E239EEDC787FD5B883D0CEE824C10C6791F707CD368F74522041E727B1247248116C65DE97B282B4CA684F619E0EC263408B958672F914CA11745FD48167F0DAE38B42E2479C7E83E6E519DF534141858A026B2270433D2C9364BDBD3ABAE95FF6953DB43701D480CDEACAF2BD1CAA1DE60741BA9AAFB37E823BB246A4F74BE63E4A1AD2F865DB87806478E770B7D1E2AA95E73C13B71AEDCD1C5DDEEDE1C69505975A235F4F73E81AA69935956212B17FB2C3EE10B5EAB09A4C77D4DD7557F34C2165F62A4E6806AC0961E77C6A88528D71437592ECB755B48BEFDB78C107DB4A707FDC7BB338A48650DAEE504D9BF50070584DAD540A72193E0B11BBF93490F0EF5C9796CA44E23F6EBBE000AAAC5817B7B650D879C783F6D201A3F6D3E07EA0EAAFCBF66C52E374BCF821FAF03680A89BC67B85D7740536326338F94A9D92E1B415B26AAE5317D6298A659B4526B03BD3532698E883BA4F418BD2F006B5DCE6F7FF14FADAC9E89D6E6E203A956E305156E56709634E85CE19AB3BB5098F48970ACCA4834F3D2F8FF14AF385A11E5405430018442ACCEE92528C1B30E6A23C90B00D9117F9CEFC9C1DAF1D3ECDFCF8F952EF81BFCD3C96800DB7EBAB8985CA45EBE0BBFB0984948D852CF540F2E8E23649EAF1D9F24E4175541B81A1FEF2AD105EF59DCB23AD0E90606CD95DB202335924AC8439C478346DD9FCBB1483BD73D674C805198DF2800D7F67900D40D544D40AA80068B79DE56D2885F1D8760734F993568EB80CD23B6CE145B52EEEF1837030451C76EA6BB743EAFC8DC47BF1F421AD3387FCF3DD891BD95904524FDBF338BB2BFC185B81E6E10E2EA6F7611EE26F9F96073BF2DFD10718776AE0C0CB6BD4BF9D5711782B89F59C6788985F303398A03387D937007FE4D5AFADEDF7030C6E5EDB6C3F42C870FFC7687AAD96B247C824D0613F92007399113135D2D78B8B7DAABF037D9FB1FC14BA14C59244515ABA7C5D8CE3819487C8DF61ECAA1FCB2D9E9DBC01375C06A87F86E72C590AAF0F86C3105A03E61B5805BB2BEA0FA7E36364A8B019E9E7F594F791B656E8CB2F2CEDD2ED0387E0F31F693EC77469817B1DF0B97AF136272896C246369F5CFE8180B484D78D5DA304DD1E3F15C9DC2243B3E4653555B5C667185A45072737E9047526F7ECFD0E9F90C4F79A2B1CAFCFE2849506C7C829DD7D9E2E80000000000000000000000000000000000060B0E1A1F272F3A".ToUpper()
                == new BitString(signature).ToHex();
        }

        [Benchmark]
        public void Nist_Dilithium5_Verification()
        {
            var message = new BitArray(new BitString("14426334940960773bff65f08d1de489c4c3ed36").ToBytes(true));
            var signature = new BitString("13E899EEDCCC0FBA629144E4AC067906B5326B8F9A6CCBABE1444ADD4645160D2257828710D1EE106021B5641E78815575D4F095D015D8465C92D2DDF4ABDFBEBE1EC5DF70C8DAB2E548D3047DEF546BE725F1821AAA8B9F4F4918BE6686C6AFB657E37A3BCBDDB4B484C67A4D9C922003873DD38EE947EDFA681E38272138B8CCBB374172B2339323429C61C15B8C6301998341276A6E904A95E835308AED40CA6B419F796320950E240D6F9EAB1D8E7BD4DA06C372BE26C1A0D858713B361D69C340DD0C639E91263071CFA5E5960CA3232D1164F0238DB96AC848CFD3666086B328FB5BC17340C876C2C94D897F552C1A326151E743755881544488717494B63817B86C849C25410C178AD9C5B1D20043F85E24329953A6B26A1425AD6E496EF79D214616C0576C09F62ED062BCC68A333AC7284E34937DFB5C42D37F83ED29DDEA30D800A0B5385C17B9ED17A5D52752C0F974C4E3E1217843BE5ABF1EB5BEEC30B1D181691E2E935BDA4ADA77627EDEDA5F58973EA3CD467BFBA83B991CC5553B7CB010485652301ED6F5AFAE98CF2A4310ADC8E97384B2928BFF0B191541C5D8C48360898AE13E8367B70F3F918B0D8240008F2A663BDD91D83A4DA1087ED9DC5585EBD263F7B83CF730F86EA6A4FD580F5C44F6AEFDC08A9A98D1A3122E7E4836882D26820D5830AA8AC832A6E181F58EF4BE233710B5160888B70D390EF98B9A4594E045EF58B8C96E98CF6811A51A29F735EA289DA38C21E6AD8262E4601E4DD0F96EB0EDEC68B6623498A331D7A89D424DC2A5A7F6F35552E79631CC2CAFEA13CCADA4C79CDBBC52B178B49065F9BDF2E6763EE6DCB8982C5E79323E67674A8DC7525898D98BE311BD70513566986F731CFBF5CAD9845FC0D1ABA86F0EF83D5DCB2F01C2CFE38E6AE8474A301916CDF5E0D52B45698E790EA3C60EFE5C1F8717B8226B8C07B0420FB1D5440894B25D693FFF12686615B1A03FD5D4E570CAF2B18825574766F6E99737E05510348B5ED4550EBCF8525C634497DE1D8D3A757848DC40172D43135E5071BE3F04782DD9C20C2AE41C8611AAD739A21E6D6FEC570C89FCE146486A61EE1A5B960AF7391A34A73FD4B3041FD9EE3FF99EED3E739429F02BB6A33C525E6809F1104503E245B4AC4F03F7AE767E74D531C5FA83D171E444A167FA40EBF4F1554E454A0026C8011D2B2A998CEC9CF740FBD74081F20AE88666DF71D0130EC60EF9A0D0F977C3D02965AA17CD7F2AE9344985ED6DFD138AB0C7CB03DF9D268DA324EA5E2A5223D32B84082D7794A22CEC939848B9E65F3BB9DD5D0EAF8741800D61B086748ED76073B26C86B69E6C8143610348AFA88C581E455975C70F54C89D259430503DA70DFDF61F718844198CCB7335C0337FDABB854D6BA9847B663A8CF3FE53F85E58AB4501456191278AF6B26C7B4C6421F4771C864F80C9F8022714F5A8F6B3EE55939042516DA5622D5E24D0F0E50718F36BAA58A01AD5B38DAD5391961F4C699AC60326EC41302FA7EFF6A7D5E0ACC0243B526566812C5A7F53384D50B63E29C98D2AD0E4C9C5E01F3E7742D9EF88CCBE5118770D06408242FB86E78D01E81590DC6987244062D2319D6600B26E532093938644638CE759735FDE6FD0C68F3748C6100F78FEE0FEC9B3F085E166D64B64E3DFCA73562F605B578162E45E2E63CE7A4CB696D1243875E45A5F913C42D39BF8C0395327315F2D7B011F2C3E29C981B09770B06DB6BE8AEE09F42AC7492DAB4E165A63C7A5634EECAE93C529D466F0065E2E757CD3BF82A6529594C8742C55361D2F91E98FF6428D95ACE890DCEBD348736BA3EC25F7DFEC95A302A54BBCDD7CBB3AAF968C3CE108D3E99466E0859FBB98293AFDBA900D870E25EACDCA60F9AE9BB22ED336DEE5BCA9DFE2CBA99FF87141D3175908D72087B275DE89346F0AEF49B159ECFB6849840F2D0CB701FCD918EA3BCAC340BF3445C6D0BE06F6EBD15213812FC37DD97B2AA6A363B2CEE6C59F6D713AA0FF474FD86FB9F7DA684563BC9DA806B14C194825AD837DBE4FE518B7C41235FB00BD2C799218030538A0762F383CB2B0A3BB3E57E49577A3DE7B875ED80219C2AF9152E56D7B35D6F8C5533A3DB0C6B8AE1ABEA1DEF563EC3253FF5DD0CA14501DE1DC6A1B9F1BAC7601B8036442F2ED609658D9FD4091FACE68AB8D49D8E4BC0A67C2D33F0C480DA65C046A084FEB5D072478B1E279024D8A2338E92B8E155741DF71679D6A2CD2DD13FB53D09AE5239B1BD42087AE78E0380105A011393FC7A7FF85261DB056DE7E153AF0FCC027DDC8F8A3183E89CE385976895511ABB4B56EDDFD4AD60799BE19D7F4D79039DEAA8E1D7555EC33406CD8B53F524EE17E2906687D1D9FD36B7A18E3CE7D857D22E5A2860FB63A5632561655F4B8D18200DE77B99F6A30006AC47BD8383689D3934E57EEF543848200DD1E6B0669111B2F32613C28FA2F911BF21A348E9464739AEF941ACABD521F3249927DAC8CD8D3C03B103A4685AC29CF2ECD4C83A20028570E75378D5BCA3198DE84A94BBC444DA24D823A4540C07E6E5C98D892FA7929BA7453C0DCD34CDB74FE65B0C732145FCD493C09377DD0109BFCF3C2367C2BCD598B6A99FEFEFAA037AD3CA7BA3519F4056056D5FB502BF02D0D3BCFE3A63D48EE41E468E9EA1F673A5C02D26CB312BAE3ED1B2213ADEF4A31E813FF57495349A7C6B41A0721CA54385CB3DFA5FADDA626CCAE8A04453F409A19E53252389EC32D6384B1584F861FFFA15CF90FD9DC81515DD6A66C04334EB3552D76A596AE6A8A0A3003E39FC2382588FD9D6F701A0DB72DEEE3601BD4FC7452E3CCFACB1E50670F72F2A71183A51F4BC193C18FBF95D0CE336D4916B9F08CFA3F8B96E554CE1B07D5E52733CB92ADCF15C61C0433DEDCE267204C6F4E34273D5E59F7A7E6AC9A7B89E5EF739A0CDDABE56F63FB5E2CC07D03C57411F0FC27D65040BE455DC1F42E4761D6F4DA5FF41CF463D2C3453FE6D5A50A0A54A3217B99F7030CD929CFA3ABB5F3AA262193598AD732B2A295B27B76847D6BC1F36B84302F4B55597367EC25633D46E8BDF80A2DC447A79EF374F996B36540A82323424B9885104204AB614693BDC888F3FC295BBD115A1F7520CF95ED9C8466B3938382EFE4B928EA9A23F63D8D435C8606C869E316E2A5B27AC9EA82109B214CC906BF1C9F480F392D89C6636BA31E259AA215156DCFDBA7D8DD9D9A1D619F53D4EF10BF93862FD2B994B6B6D1E2FF69B5223809538C71736F0B6874C7568380FE7F81BE6B43E3904D7B2A82DFD8631DB3809D02E76370EAFC86A7A0562B65084423FDC38D0B64BC9A34D40C6304E40AF889FFF682DA2F79EEE3CCEAD00AFF370691F8A2B2555D785E5683FF20E9C4A7B6CCB63B9E7362F14C160DDE094FB593E2F4FA410DE049E485696A2A73891A5F230D3D7FCF3B20226338835E24669157D48AFA8994167DE9BCFEDE94FD8E3533C025A774D35980663E86A9A00E25224FA965F4D3A48C1C6ED640915561A7F10EAE35443A3431A63ED1FF223494EF51E2C79AB8481F9D68736470B4B573B145A991F51330AE35CB8BEE3FFEA81DACB977530551C9F3B3A02C70B44A639541C226E0294F1CD092A0FF099795788B23BD7719488ED2DE72F8909D564F591EAE9FCED751C999FBB50325F265D1FEA93A3FE376689DEB18C4CE4F4654536AFF09C33F0D583711614228C429F93A9969F4CBD36469190D5DF70E95494231FF7B21CCBEACB1B81A30D6DA830D0634334EAA4746BF37FE15806E3BEBC4E93B5D1CFF7A68288503F4597D1B07D3471AE598B872AF422DC0BDA0D426882FCFDA947ED9A4DA22598BCA5D0CE84EC6F03EBD5BCB335C9035C8A030E5BD518EADDEEA951BA78F05205F97A1C287958CDBCB62EF6AE16D27FB7B9BF201AD2B6376ECB82F6D20CCA1324A702B3FEDF603144AE844237F86214771C1360F81D3BC3998DF24DA97FD311E3FCB52A49FE14FA6844A05AB1C1BD51D20F85143F9FAFD6CE1BE0BA6E169E65D5234E3BEE5445F8748B10494C739A8C606888C69C77A568860286313BD211881DC82726C1446A9082EB8D90A5715E7E2F5C2532B0B7E2CE37BBF42ACCC475E8CCDBB483D6E07A273EECB174CC3C8BC2E004FDDF9E019711A630AF759F7EA6F5D2F919059E7EBA65BC45D481876E7CD42C1AC2EDCF9C0819AEF13BA89FC712A00FCAE557B8939E8DDE6D70D03FBF92E12A90F386C90ECAD51B36F3FA2B7673620C971D30634DFCBAA3E1139176503D6942DE6C77BBCF6BE9A8595AC664A9278375BD3C45A2A397EB74AD2CA70CEB2A1AD7013357BEAB5964A435F9ED1E820680D599FE1188BB69BBE61533EDE7938BB5E372D81E8C0C5FF2AC26C0BF152F43C1D9EF9DD8A8799CA0A7995368640BEABB55DCD27C50B2A9CF020BFB0D1FC125C53FD7D91D111EDC0B6ECA6D1878BD10B98477E2601E1FA6AAEEF315B80E4C167C2331DB32041F56C633226EFBC23F7E228AF5BE74C7833829F66A8757728CFDB64DBAF98E59171CC650620F72964FFAF09CA98862D4CFF40113455DDE7153346D7E1A7595F8A40FEB0B1527DF9BB8DEF50C4D5EB54AA62FD135E08629B9296E2481419F17B8FB588936AB15CD1089AF6E4F0C9C55F9373C903E47009F41B59BD82A7C9CF9E63F53C3232787968AB606A0318607A2B019268090146730F638F8A376324EA81BDE61DC304FC39B50DA00F21EDC52708E18CD28FB26D5F793FC8D4B38FAC45D3D4BD383D1504DF32E80342FF93D23407C1B8B2EB96F48EB5C3380B44D12DFD8B8FE2396A6C288ED66815B423B7439D97485D7399ADBCC714FD87BC76FB72EE474722E5443A04FAA1FD34A85894DF13F99916F768B4D1C55D32059DC9E9C06A47DB3C1F6DF75A0ED6C84743E9AF757A87AE9BD6261B959DF6ADB4D3A8C795D577D06213E5064E17B962C85C3C43401ECEC7366E402727E1036CFFC6E4CDB04A292456BBEA8C340B5311ACD04608B168F3C5E73A15FF528D1EA8A19D75FA796CEB10B62A2E65C2FE914D0205E5C30A1F8818314E64F2B4C9546D0637461AAA3116EDA83E92567E7D0B4364DF7031B4A86FED3C003A5E1980CE8A5E9FAD1969258C66E559E0282A65F9BDE8AECA743E1C0DA0FB4E08A2488355E34B421A1F9EAA9A7835D2C6E33C7DF02262E2AF6D17736D4BE3F6C9CCD66D5F126346C1BE5742EBA1AF850C3D99B4FACE7EFDD087693590ECCDFC10E1D76E202F945D001E1668FC5578FA3384212CE6D9F9BD1C7E239EEDC787FD5B883D0CEE824C10C6791F707CD368F74522041E727B1247248116C65DE97B282B4CA684F619E0EC263408B958672F914CA11745FD48167F0DAE38B42E2479C7E83E6E519DF534141858A026B2270433D2C9364BDBD3ABAE95FF6953DB43701D480CDEACAF2BD1CAA1DE60741BA9AAFB37E823BB246A4F74BE63E4A1AD2F865DB87806478E770B7D1E2AA95E73C13B71AEDCD1C5DDEEDE1C69505975A235F4F73E81AA69935956212B17FB2C3EE10B5EAB09A4C77D4DD7557F34C2165F62A4E6806AC0961E77C6A88528D71437592ECB755B48BEFDB78C107DB4A707FDC7BB338A48650DAEE504D9BF50070584DAD540A72193E0B11BBF93490F0EF5C9796CA44E23F6EBBE000AAAC5817B7B650D879C783F6D201A3F6D3E07EA0EAAFCBF66C52E374BCF821FAF03680A89BC67B85D7740536326338F94A9D92E1B415B26AAE5317D6298A659B4526B03BD3532698E883BA4F418BD2F006B5DCE6F7FF14FADAC9E89D6E6E203A956E305156E56709634E85CE19AB3BB5098F48970ACCA4834F3D2F8FF14AF385A11E5405430018442ACCEE92528C1B30E6A23C90B00D9117F9CEFC9C1DAF1D3ECDFCF8F952EF81BFCD3C96800DB7EBAB8985CA45EBE0BBFB0984948D852CF540F2E8E23649EAF1D9F24E4175541B81A1FEF2AD105EF59DCB23AD0E90606CD95DB202335924AC8439C478346DD9FCBB1483BD73D674C805198DF2800D7F67900D40D544D40AA80068B79DE56D2885F1D8760734F993568EB80CD23B6CE145B52EEEF1837030451C76EA6BB743EAFC8DC47BF1F421AD3387FCF3DD891BD95904524FDBF338BB2BFC185B81E6E10E2EA6F7611EE26F9F96073BF2DFD10718776AE0C0CB6BD4BF9D5711782B89F59C6788985F303398A03387D937007FE4D5AFADEDF7030C6E5EDB6C3F42C870FFC7687AAD96B247C824D0613F92007399113135D2D78B8B7DAABF037D9FB1FC14BA14C59244515ABA7C5D8CE3819487C8DF61ECAA1FCB2D9E9DBC01375C06A87F86E72C590AAF0F86C3105A03E61B5805BB2BEA0FA7E36364A8B019E9E7F594F791B656E8CB2F2CEDD2ED0387E0F31F693EC77469817B1DF0B97AF136272896C246369F5CFE8180B484D78D5DA304DD1E3F15C9DC2243B3E4653555B5C667185A45072737E9047526F7ECFD0E9F90C4F79A2B1CAFCFE2849506C7C829DD7D9E2E80000000000000000000000000000000000060B0E1A1F272F3A").ToBytes();
            var pk = new BitString("2d1e6bed8452ebf126ede70ca0a2b50d03342d5b13b2ae210f4562a3bf670cb15ce925fd22f26242bae310b3aa413b6e78d442d935d1728a3248cc205ccd8d3fd834955520cdfb2c73e90e608b2c3fa8b7d179fddcc88111c9e84171e9709b535933e492b6819c6a92eda25ac407771a8fedb4e711fb89eb7bdfcceac53b4ef46b6fbee132a9d7adb436e74a6d671183af311a7a31429b012117527585f7920f348a6911885a0208b66de30793b13fe1d57bd951f7aac0349a785d26dbf1f0a91e5c9f4fa7435c44a943f1381145edeb1c8a05eeffab202cf62cee7742363ee69d8e450ff67c3962d6ff97bc3d02d6df4a35da3f89a48833cdf290f0e9372f65a58865fd4044ad090992aa159eeef72b0da7cb3a5e0aedd67d828bbacfe59ee462ab696bbad0e5a9bb1f5a51e0fa5dd44d8ec0dc4306df2367b24aa2fb752f82d844e4c0ce159e3fd6b4705f3bd0563e0a7a4b94bfba012b9c8b9135f2db4c8c8dd6eec8658df30559be3a17a772105614efb8c1be18110be670f839a5727df947fbacfd1fc37133584415d37c932e7092fabbf2d09d25c4cf4ab8ecbe5d8b7fa47cabade71e938392861e8d15a41c5b4225da3d16d393f28550860a86356b14ab5f22d0cf037cebb40eac87a24142a0219300b6476f96d041d1c30e3c52d245ab6ae7a1e5fd73c5829d60628b6d87fc889c3eefaeaab61c18eed7511a96c4932505d3833dd83316144488e2afc4ec591812b999c1c95f31790003f6c95514aa29087824af1d991236d94ad950ef66fc7ff4bc3ba0f6fdf262caa59d2b55b833bca67aa51ee1145f94e2dcf05bbd4307d8b1e0813f845490bf2359923ca598ab7d99d2f0ed8e0bc99fafb013edc7ddb86172073dcc3573a0cf0cd97e93dc63b882ecf430ce4392ea5ed8c8a1ec79dcae64d433eb538cfc4979bf7a28651e8cd521b08ecaadf8969a981000356d589aef84848672bacd3866969bc283b065c1abcf638c2dc342b27df6b8f03d26218fae4e96f25566bc6fede719d38dc0cd55205f10cada09ed914a4333d382115c2f5deccd54f96ce4e5f268bce927b21dcab5cd04011e92f5f601862b20209bb0f956d933d50aec1bf4ced2b2c2d43f9a25768e29875264864aa57b5a91726ebe6d730a8d89538233704420bee0b01b763043a55b8fab7eb8615f43701b1a716156f913312a643314009872ec328809fb64463d5602d976d3aa900fbdf0f996437b621926226a9391ec0734f52232b36566e06b117f979f1a8946ce8fbdfd2fcc3dbff283a430e10272f874e6219677e1578af79eb331afd8c5d720dcfdcf79060f1fe5843d0b9cb3c7abb8f1c0d0b5c701e20e3baf7eac445a75500a761c13db25d40d19754c02d9f3df6dbbcf47a6aef6d1fbf4b455d3a587a155fbbfcdf6a1645712759a11a3ce427084549312e13a0ffacaf22591f14d8f84b1b535ace98177344d6f5d149db9e1f03f3ce7ad48e68c5186f44ab4d098ec3a4eab582f089e5a9d4530b085df4ae792c6c8189308ce9a8ce2918d91577b37c880a231100d4eef5107948ef83c3c2ed50326b8727fb9bcd795c43108ec6fee11afc0a2ecd7c80bbe15aec917be37e2408365deb34eb415b35c14f65fa91f70b5239378b947f91d2b1e8db1257ee5853c169fd0c2678b0dd2724e7430e1afb866cb53dfc4fba56d03f2aeee90fed730af339809eb75c73ec82fe7225f2f0abda42288281935831286ee72b426892fc7116edd149822e7733efa4675f940c18422bc7536c782d3ae6e0dbf6fc34b674919f34b12f283fd395644053a246a356912cfe493fe26ccd601a04a84a81d85e6830f3ce66dd2cbb1148cec10b3634b9cf511e0f9866fa7c03b9d25d754ca404d26ba718e25f5a7e39b25207f2905b6271417672610ada30603fe82855d01044de06438385e831e219a3902f8f9698552e5ec6aac9686a78869b5b57e031da968ca450ff914d67bcf9c036fd1d96f013df8f311f3291790e89bed589bf0bcc7baf460c8aa30b42f228fd3ac18c2b7c47b319e0f7e9dbfd463c28b1b585033536d79bbf80d9133d907e7b081d4b4476193f0fb68bc1b41c2f543307e76f9b1a3d6d426ea7775127ac8309bcf45be747d8a8beced11e6a1d1b8f190ad6d6ac654e9dbad4c9739c8d844a91a37167e68450cbb10f4ae8e2b69fa953ea5c991d3f1a3893f9086931bf1a089c7f22357d48e2fd571cd36f190b3983e19eac80f129dbf58eddc6b9a7984fcf04cc3b40db87a8dad7540d5d5dec8ca393e45e4bcf433ea64e15e944291abbc422ab3d06023ce578effada22b64d994a0800f8e5017081d16cf51d0b928b659ef78ccc996f9ca877aeed9155edf5dbcc258e604ee17dcb3f990f988329ea1db1c3856539030692e52002cf30fd5802e025b99bfcd1112645b56c60ae638e74d21e598789de6cb60b42ee49856cbade6dd53f4c567a29fa05c7cfb245aa772d0e763f25dbfd8e9f16bb429a628e693d387b6d93c398dea28c0963df5c23c29f280218a039d64f8ba81c1dda2882a842e3cb50395edaa6ee26f5e993c63eeb84f6632774223362989b0ed5ff25a65663fd28b486865dce0b0c27273f1a4c6562c5dd8c65c41ce308959a9d64596d08e7b25e013fbfe7ceaf3670db29a213cce9975a913cef4236e64003087709cad6181710e951926ca55297199a608ae545875cdc38fe383c14562b48dca6602ea34055d983f38e61cce531ad93f58ec162845f538ce4843871d3c4adf05f35e297ea62efcdd5ef9401ba042a235150a09d9474a3fb03aaa19e7e37a228d5f5b07414c3da2ad2e5c75ecf04c112b90769e19960e975e8d1917b3bfda84fdc6d2326fb8a3b00f95d9c52650111572bec21b12127ca570d8a98ab977ebd8d79a59375ee14f64b5b04fd969feb03d0af73489e3baefe7c7bc8dc7e85483ee62f02398580f83b96dd84477b9c48f0bb39f5406a37036d6f36e2b1b6b53fe6ff61c327b29d4e05dd2b81174c60b59c79cb1976bc06e7ac34df3e38f7d2c1c0e3151b7147ab831774770143b927b5fec5df776c1d72db6bc9981d65867713cf297c8b0f1e98d0e16f0cc227a39e47e50ba0116156d5b5467536604be05cc2ef40abce852f15dfa2cacf86a789e5b7b0e5bb4b777cd7cc9f654779b102f78b5aa4b94c3b4fde55fa7f7bf54ac225e1f26165b65f16d0321669fd9f6e47fca1dd347096df5dda86466a57c5b068d9c67b7320366ea19c8993ff90bd8fb0693fba370e66d2b203b997011b0d15b94e28baa2ebf01774f7ae78f84edbdad9f65a450427a4774c60cc89a020b37da21c791dac8f7a7457e30d08b01375160039c301b6051a965e8a7cca2aef93bd52f82c020bece90a129024efea4b2fa21270f8eb5ed6aaae55929aac599a577972957660cc47ac4e3ce772bbf10052de7edb1b8a44941f884c9f8be13174669945629f46de2467444f3106a73fa279cf02a800a047e20bd4d820b389c3bb6a868a5384cf5724c204cefb1a6a1beb9723e36ddddd9c707c8f63e8bc26683cc8b43c7dfdaa408ac4dd2ba9aecbc3b6ddaedce094aab58ff732b196638d8b8efc428bba9615793c4dd9f00f90d62c676d127a0e18c14c6ee9c990510b054adb4b4170ac7127f93175c1eb22512").ToBytes();

            var dilithium = new Dilithium(new NIST.CVP.ACVTS.Libraries.Crypto.Common.PQC.Dilithium.DilithiumParameters(DilithiumParameterSet.ML_DSA_87), new NativeShaFactory(), new EntropyProvider(new Random800_90()));
            var verify = dilithium.Verify(pk, signature, message);
        }

        [Benchmark]
        public void Nist_Kyber512_KeyGeneration()
        {
            var z = new BitString("d988083c094c62d5b82289621ba96c212033633ab33b69a57590017b6c5f5279").ToBytes();
            var d = new BitString("d988083c094c62d5b82289621ba96c212033633ab33b69a57590017b6c5f5279").ToBytes();
            var ek = new BitString("6C42BF90F65D1A13B3F83721D23B6B92B53EE03A690421B8411877C7B5A2201A0217D41C62C51AEB116FD3769EFC15733AA5CBF2F92E905275482CC03129033617B7551B3A581A95FD2A77F56661E2B664D8545D70DC264F1941945082B94B8BC6CC93283826B6594C22150FF850CAB5CABAED0B074DBA545E371D1E156AF0B2306BC8B4A42104DE818D42D892C0E52660E1872B9A2B3DAA4DFCC4B3321CBD628C6D29457073A989B2B46A978772E1C5CEDD3941D6C50D419589E003A9DC5068B98C1B87EABFA581B9DD454BE5361D28A3242214175F60AE31BA4E916373A559BF87B8C297E371E7A62539B2211FB0A6E60A72D3CB73EAB632B9213337AB0D3079174696134C876059B3C57FEAC6B14B9979078C0A082D0FAA9995F893E5C951CD6BB4E2D10C737146AD3C83A39449F9CC9B02B6BF3848544417B13A0B442AEC44B5D66E0D053A8E16A614BC8C32C9113AD59F123B168F37649AF3C18E2B62675686A4E41294CCA2D3272459BBAD446CB9DADB502C225F06613ADD4777A7A411FB82C9B569678784B446F777B0E825CE08CC8E86BDE6539E12522F64BA2E5F5839245101ABD7870105704946CD4C197B1106A2C2162471A73B32F04C1568AE1CCB827203469A636389549DC39B11193261DFA91ACE29488581840203553187B3B93BBE3D54612D4152F13CAAFA3284EB093EF0D7970F7A22524665C3EB9173317EBCA57BB8BB1F9133C89499246DC1102B7B79DE121041450E5EEA16AE512CB1363E86D228ADB997A68191CF843F1F47A358E57FE7B3B797B246B6120CA380719FA3923F206994DAAD8B0C74C869762084259BA91114617988E3984FC661F10A5C62816AA9CC7D9FDC0E55039A439ABD0E6580EC60082FF83A51DBC9B4A442AEA16B03A562C08534F8CAA7E34A1E6BD045289588FD4B333F544C4F346BAC169E85022B9771BB1B6A62A1333DBB9489F03B3E2325C3162A349F68B90B0C716FAA0D9D2CA8F035C12D70CA134A4C658C0D37AC54F695367BA1B3A0E40275DC16E2D25BDAF8BAFC8639A3E34C47760D02785A779682623CC8F7B2B644BC214707A254567D4151CB2ED415142902833CB03C96526767B6D3EA742AF97441423293A8694D778DB75134B6C91B16012300DC3ACBE43C0F07B68D42AC06B40A19662D0664AD70C89518A4732DB24B5CCA94A96179447BC8BE410E86509F5A229FAA19C99F64B62E88853F01620C5365BE463BE35015B6255812971AEE1148B979594CC0A725A9C456EBB63EB3B3D4423875F10AD5433DF0C781019196FAD081CB9C8E9F44CD0EC1ADE9C20948B8580E184D44D85976579257DB084867800FA915A992605F72414BF31FA8420D2DF3A21BA411861175FB202328BB261D757EE63B2CB793470017AF8CE05CDCC2310608C6F6260C2D8B927AA6B398C155CAC007085C4ED9666885794C38E67C00002C3FD8BE27D4073B93AE96DA2FEFFC15205032D3C857F97349BE415945AB7665CCB522D71051E160D66148EAC16B1EC0CE27920921966EB4A8A4E60707D62394DD784FE6E86024CA49E8FC1CFFB456ED866AB348AD5A4A46B092A65E252AF71459751153F92620B2F28AE3E1875573A3F5E07D6EF357F3E1BFB6604730EA545A7B12617B6CE09409BD86512DAB98CC82A8CBD8473E0C9BC4BBAFA667166EC643D8EAC74040C4BB480C77B3A359203EE5C9951202A2665B70A56240E4378EB4DB21563BC6D40ACF1272B144D68E34035206897DA0A366ED7223F2BB9B39AB6B76C518B9155504D3BB1D580FE55073DAC90B4867C80C349721D7A38B40C4ABC038B7151B154098A971C014CC2DEDBA341521794F61C718D83D6CD8234AA4765A94695FFA4D456A4AE8322B4962BD70081C42B70A67028EEB6CAA6EF8313B0150A77C2D44EA791276AC7D85B9125B0EFB352903D14522F2BACD42ACF00393907AA4B14AA288A3B41B242A296325AD757111F9B2A8E32F8B1110BAD7762E8CBA83B8B5BD5C6831033B8AB7813EB38687054212759EEFE19B54644ABEB633983C13A1D692FEFC309C996C7B3805DEDC102DA20870494509358F1537111BF24726513AB66A5A727A910AA4245DC27CB8328EB8F01581B074C7503FC90121DD763BC90A3C7CD8B50E5766F7F461A27102D3C2C5F94A0DC9EC2D2A7402D20B8EABED229CB0C049A38FAF4F872CA90ACAA38008839EFBCD9969B0").ToBytes();
            var dk = new BitString("573B2607671C5C245613A6C95A096C9471784F66B205B71D677428B5F248CCC8A966A5AE44116A909CA1ED35B891B0B72A0B6EC1E67CB531486BB4CEEDAC344C633C2E3C9C73C97973099DF2AB69DD730716BCBE47087A4D46621BD901B596426B318177B9850465CC027928F99A0A2F014312B452A58440131A3758A8B96AFB324735B5150C18CB81842D6C9B18A8526CE253B9779816B2066F732F1FEA98BEE93D6C8513588B51EA2BC912114F52624C36D064D9465777D281EA949C3D01250E38AEA29B2129E5974F417294691D02D85E216B9F57D455EC0455AB9B77FC841C67FC53F52275633CC422E185573AB7EC47C87243B5B9E80692E8289DFA5D66A265E3F57EF8D2723FEB09EF45A267C2CDC0491058754BB03C497BAA4BB3E28E65576DA8509F0A473B097B3BB76B551B8AAB4C7B35355CA8CC886A560C454778069A49B05A544D53B84945B627556209255A17FB1B689693BDF2F6BC57957662137468C224AFFB09376368FB5A789C55CD16660FA41835B97867F7882CA7A41364A774B28C75CA9A8363EA41A716111DF89B2BE22CF88776775AA16D88B14864A5FB3C0CCC1B1AE01167B7567680F41355D5515A15256CD04FCD541161B10349F8875D60336BA622C3C037A6568DEDD32B9BB7A88068A389207F026C4CAD450F5E346358C5821AFBA620897B52C77FB1C79D972386B472A69F4422D2D14BADB6951136CE3E811552279BA97A22C893353D59680DC00C8D3C5F04CB116264B248273F2651851A443CD45B1F575554805C56EA4C6F37C2BBB8E79532A60380682660D4BB7A4CB05A340EE42B5022689D8E18C022F65ED65B9D031056C05A672E001B2A314E85BB54F2591AA22747D7D814F3F3C285C2852ABC189CE19113EACB27C0A61B44359D0BCE8937C89987CA7A9B83976B7D059B73F2A1909CA3BC117AC30AA7CA8B4B30F1BA894896625214C1DAC5BB5C31B5AFE67E0B70190A8B1293B00B1230786CE88BD5D8824EDB9DF4F9BCC792370FA76E84E6CC35759D8D20CDECB69FE7C8C4658B02F6834D47B971809A64436398ED511587D32DB0084515A56F62FC1DFCDAC2859434669732B3EBAAF1B422516575E0A6A7308291F326B53C2B60C2C0ABA28A09E78746A72644672048597967ED497B564319ED21027F7A39BFA51CB2A69904D514090B3342F6A2AB908FE0BC6300F1C87F43C9AA96668650A811096FD738C973895F18039ED4717997E04AAE348F8460C47CA870EFB14AF8677251367C95152A346A031DDB06EE927C4D66C95AC049AE1093D71C4BFA7C31C951B755A442E018B7DB97B13D8C01D14A7E96BC889731C00CC31C6F6C9B5AEC1F3A59606FCC9AD7094F9E2A038ED2402218888373433FFBC1FB270DF11816AE561E87A5BE65375D5F14001A7BC2A1357172613789C92290AC576F59264A00208AC11A578B8846D18E17E49426635312F0475887042B5340E00955ACD28A27F23D7AE37E66184B7F96374DF163B882877C500EABA00DA6C8388DB3924930B0EB6C1FDDA454A77A6E4BB4C744A811B0791A9B5B0B78809D3CD6B09D46BE638990236CAE30985872BC901BD0A621879E3C2B27B59478AA9B67B5D330C2D69C0A99A156251D8F4B01C96BBB51BABA8B776A6E65C15CF39074920D6CA4A4E5ECAA8910B073478B9203391ADA3327668288BA600A5122DDCA7CF5625798EA4DFB32374FC98826B4CBF3CA0D2CB580E9156EEAF055DDF5595CBA0176BC39A61776EED8908A0026FFF30241DCB0F664072A718EF255C793808414BB1C9A7300A875765F451628B774BA4110C96932F1EAAC0F29346A977B9DF7224339766D8936710661A45055521934884A66C05870ECF95B4423BBEDF61A2B893EE5204B2FC13228F8354348A2D77A60544771CB73ADB5C73E1FCB6E0C47471D2228B7217DD2D9223F928983D6809290B39E1565D9C092084620F0A539B3B5B658814496C8449D30CBDC7B33FA422E64FCAED54ABF115B603803B0EFA7238908528C4021070C0D1C73B8125925DDCB2719F23F68316D5006C2A61967B45093061925A5419920445E64D51FAFE886CF578599039609C58161F627B1589F32E12BA0669AB019C5E0BC2EAD26A73EC596954C628362298AA01F26B878AF9ACCDBE0C5E0B7C4A1B851A4CC556C42BF90F65D1A13B3F83721D23B6B92B53EE03A690421B8411877C7B5A2201A0217D41C62C51AEB116FD3769EFC15733AA5CBF2F92E905275482CC03129033617B7551B3A581A95FD2A77F56661E2B664D8545D70DC264F1941945082B94B8BC6CC93283826B6594C22150FF850CAB5CABAED0B074DBA545E371D1E156AF0B2306BC8B4A42104DE818D42D892C0E52660E1872B9A2B3DAA4DFCC4B3321CBD628C6D29457073A989B2B46A978772E1C5CEDD3941D6C50D419589E003A9DC5068B98C1B87EABFA581B9DD454BE5361D28A3242214175F60AE31BA4E916373A559BF87B8C297E371E7A62539B2211FB0A6E60A72D3CB73EAB632B9213337AB0D3079174696134C876059B3C57FEAC6B14B9979078C0A082D0FAA9995F893E5C951CD6BB4E2D10C737146AD3C83A39449F9CC9B02B6BF3848544417B13A0B442AEC44B5D66E0D053A8E16A614BC8C32C9113AD59F123B168F37649AF3C18E2B62675686A4E41294CCA2D3272459BBAD446CB9DADB502C225F06613ADD4777A7A411FB82C9B569678784B446F777B0E825CE08CC8E86BDE6539E12522F64BA2E5F5839245101ABD7870105704946CD4C197B1106A2C2162471A73B32F04C1568AE1CCB827203469A636389549DC39B11193261DFA91ACE29488581840203553187B3B93BBE3D54612D4152F13CAAFA3284EB093EF0D7970F7A22524665C3EB9173317EBCA57BB8BB1F9133C89499246DC1102B7B79DE121041450E5EEA16AE512CB1363E86D228ADB997A68191CF843F1F47A358E57FE7B3B797B246B6120CA380719FA3923F206994DAAD8B0C74C869762084259BA91114617988E3984FC661F10A5C62816AA9CC7D9FDC0E55039A439ABD0E6580EC60082FF83A51DBC9B4A442AEA16B03A562C08534F8CAA7E34A1E6BD045289588FD4B333F544C4F346BAC169E85022B9771BB1B6A62A1333DBB9489F03B3E2325C3162A349F68B90B0C716FAA0D9D2CA8F035C12D70CA134A4C658C0D37AC54F695367BA1B3A0E40275DC16E2D25BDAF8BAFC8639A3E34C47760D02785A779682623CC8F7B2B644BC214707A254567D4151CB2ED415142902833CB03C96526767B6D3EA742AF97441423293A8694D778DB75134B6C91B16012300DC3ACBE43C0F07B68D42AC06B40A19662D0664AD70C89518A4732DB24B5CCA94A96179447BC8BE410E86509F5A229FAA19C99F64B62E88853F01620C5365BE463BE35015B6255812971AEE1148B979594CC0A725A9C456EBB63EB3B3D4423875F10AD5433DF0C781019196FAD081CB9C8E9F44CD0EC1ADE9C20948B8580E184D44D85976579257DB084867800FA915A992605F72414BF31FA8420D2DF3A21BA411861175FB202328BB261D757EE63B2CB793470017AF8CE05CDCC2310608C6F6260C2D8B927AA6B398C155CAC007085C4ED9666885794C38E67C00002C3FD8BE27D4073B93AE96DA2FEFFC15205032D3C857F97349BE415945AB7665CCB522D71051E160D66148EAC16B1EC0CE27920921966EB4A8A4E60707D62394DD784FE6E86024CA49E8FC1CFFB456ED866AB348AD5A4A46B092A65E252AF71459751153F92620B2F28AE3E1875573A3F5E07D6EF357F3E1BFB6604730EA545A7B12617B6CE09409BD86512DAB98CC82A8CBD8473E0C9BC4BBAFA667166EC643D8EAC74040C4BB480C77B3A359203EE5C9951202A2665B70A56240E4378EB4DB21563BC6D40ACF1272B144D68E34035206897DA0A366ED7223F2BB9B39AB6B76C518B9155504D3BB1D580FE55073DAC90B4867C80C349721D7A38B40C4ABC038B7151B154098A971C014CC2DEDBA341521794F61C718D83D6CD8234AA4765A94695FFA4D456A4AE8322B4962BD70081C42B70A67028EEB6CAA6EF8313B0150A77C2D44EA791276AC7D85B9125B0EFB352903D14522F2BACD42ACF00393907AA4B14AA288A3B41B242A296325AD757111F9B2A8E32F8B1110BAD7762E8CBA83B8B5BD5C6831033B8AB7813EB38687054212759EEFE19B54644ABEB633983C13A1D692FEFC309C996C7B3805DEDC102DA20870494509358F1537111BF24726513AB66A5A727A910AA4245DC27CB8328EB8F01581B074C7503FC90121DD763BC90A3C7CD8B50E5766F7F461A27102D3C2C5F94A0DC9EC2D2A7402D20B8EABED229CB0C049A38FAF4F872CA90ACAA38008839EFBCD9969B0CB2958CECABEA4876FDC3C9DA67D1FEDD3C530F9603A3FDBB2C15B5825681226D988083C094C62D5B82289621BA96C212033633AB33B69A57590017B6C5F5279").ToBytes();

            var kyberParameters = new NIST.CVP.ACVTS.Libraries.Crypto.Common.PQC.Kyber.KyberParameters(KyberParameterSet.ML_KEM_512);
            var kyber = new Kyber(kyberParameters, new NativeShaFactory());

            var key = kyber.GenerateKey(z, d);

        }

        [Benchmark]
        public void Nist_Kyber512_Exchange_Sender()
        {
            var ek = new BitString("ff8b0218d34b0a7cb52902bcbee2c2f41878a73509e999090622a404079cd4b29dda058064d2457817758fe468fc76b95b994bee5768d34c3ed60124364ac98e583f405680cbe0c37e016eb5f091093825734c36c2296724e8ca04632caca3a2da293a23606159947d57d97601f43ab278988f509748272d86c2b4d2419af403a5bfa356c788525775b5709ca52727a432f4205966350ff5b14ad0906d2477212166286578c97968e7cc97b15b5186214b54297a3fa522b2f5a0a54c90723c091382585e1725a3b4c98159852be39848d6432e4401e91b3bd136b8eeb15998e31aa5f667d9329586926f540b10dc583b2c6a2571657b91e217504ca4e9938c4d5343eb7b7905939787c6380aa2c67d667e485c8427a8b23daca033cc6e01f5a250865422f43b32f6290a88848d6359ac498f28892293b2a52bc17bbed833561b96b15778fb741b7e4ba889472d1ac58a9537a065e38e6337cfc3115b243953be2467ef3b507de13dad619b657b92ed8b8d46b58746fc6428315478ab1bb8b6b3a37424b74428e6d7819c81aadaf1920770c49b266f7880931128592ac564effc7f896ac1104cae391c9e491730248b25872c58171227fd221b21ac72d96b64327539b1d4351f239027956e8d404b6002b1d36b7b7b430b5c43179578bd4b775c2ab53f9e878f36e2ba6c539c67694f60126423b88581b8bb8e804342850f802a27eb2941547a43fe2292c2cc1e9bc503d4322be036239c112841d140a1d7cd202b3e64806f5fa2964094bf842705765540ea1032b0fc5c57e30b27c17292d1b0f615cb8adc8fb0132dfc6a49c37857880370f4e2b84ff448c30c10ace52ca2ec88c304c00a831a7027239548a67096713e1b0de7898d4df6877e7491449015d7e64b00d5cecbacba0291bd38a43c6dd63a20074556e2b3fb1b285c6185f551b7e906ab8f41102f927cae12981eeba3a2c76e2649a8315c071407bb31c7503ffc5629e9a46d874a60cbc51ed2c71db803f83446bf5709f735c55155766b6461561a4a39813c1cc056f5b8c96ea334aa30562f341752831e7f314f6630829ee2229e8aa9706921f94f6cb2bdcafc0c088a4463cbef9505481bba2d0dafda0eeab0").ToBytes();
            var seedM = new BitString("73c2c2973458560e2ed2123d247ba7f81fae824e5f93596b5759991f79299826").ToBytes();
            var expectedSharedSecretK = new BitString("672b195adc9d5252bea33b59fc53e88943ff35e731c3f74d67187bff83c0befb").ToBytes();
            var expectedCiphertextC = new BitString("4750315128b640a8bf381290871193d1c4a9b77dacb8afecacbe89cf6d92eee08147e96f491687df2eb7c4562b7ff72001ec7fa0864c3512fe0698ce32ac5412d75a80a647ed6a4c15253766ebd8db72e778c45c58caa45b76cd473127525edf7efe5f443c5670f3b4353cdf080e3d589d4cde7dfa7b5604b24c0d7b844bfbee3c7923c33c334bf460ab522d99735c5648a8000d173ba94e22fb212180a2c9f007670e1e7d3d51f4968e648289e634fd36e93aaa2ad1183d30b321cd1f983fe435226c5c9ed11cfe6a8e16469509de853cf80440289febb0b3327c46ee4693cf267f566a7f98864998256488613575674f3927376f31c87ae83eba2627dfc5f14e1d65bfbd26c8e242aaf91aca3db4188856b816dbea36c669082100f4ace32e00683dfe55142aaaf74133d075661f01edacd902a1910949b8d9db4f0a09b443dd7f9089851816d0a8c2b79e6c22154ad79881b5225e2bf7cbfcb101a27cded887494b89a596b2c47eb70d73b5ea5a39322d9f368465b4f45300b7ea5ed8e4c1735d784a8d639bb24fea5b5f3beed83b038671c302ad7c7a82b5000f00079c93b6d6962e43157b6f3a89831630e778101f2a2537ba2fabc0e856d2356a1d79cb5b3e71380efeaf84245ecf7bbf6cf361745a5c7e6817dbe94bad5cfa053e487ce4fba401a015cf340a4aa3be032b0264689e6d9882815dbad83b6f2af97f37376386e65f0dd0b84b824374fee6918c03ec1e419602e47187f3d920437fc4f7570fb0407f6b369844f6961ee97e46226a3bcd695535e4ed5dedfa1d958148609bd9fa6b2e5d81f1ff2bc94c8933a87abf81089bef966e5d7d2a1cd406aa5b4b643247399403c981a274a836dfa60a724c56bedcb98ec7d2ce2c02acddde5ecd53c2809466a6dee9f97f8a1100c305b6fb8128005fc45994fac6ae398b2b43790065e12f262d06bb6c1a01284f36b03bbfe15a044bd363c6574df23cde32adf4be9d68216b17861d1035e6dc9a3a92978220c94d5b71886ffb04e1eb60b44fa33263024ece7afb6467c25a948d95de962e81073e64164820398043d2642d8e9d04").ToBytes();

            var kyberParameters = new NIST.CVP.ACVTS.Libraries.Crypto.Common.PQC.Kyber.KyberParameters(KyberParameterSet.ML_KEM_512);
            var kyber = new Kyber(kyberParameters, new NativeShaFactory());

            var sharedSecret = kyber.Encapsulate(ek, seedM);
        }

        [Benchmark]
        public void Nist_Kyber512_Exchange_Receiver()
        {
            var dk = new BitString("d0bcce7ba24c8f607e482a7f33e134df5a13fe8075f8272e03483c40b65b7d912509bc27b8c52602cba1c96458619aa8df70601d68686a919bb672a405e7017cd6a43db78c10c477ebc17daf68b284b487b2aa76bcfa090d9965de853518dc4a93927017b4b2ccf45cd51226d0f74d63a350578375481b692840a16b2471a64069ae6ac527fb86a57b81ff5067c612aca70a0ed14c3f286b9b8a36041937caff8c5c62dbac272959adb833ef63523e089b5e1327641b1af3d4944454ce1ebc19b4d151ec406b1ea8aa8f6523c0b53ff7a20081f35f222a95ab667141babc8446bc8f728eb9dc98e0852eea1ab4c695a006c338b584b48f104e0bc21dc8905e4582c05dd5226d3cac422cbea0450da8c28bf4e81a872b67d1385d27d54d37293522bb243be14f3869108ed9aaa64384f01b14f2e59ba2e9ae6ddb848885cc623787357022754a4f7b8a6b8d48afbf8a72167c49cb32a3f750ba316cb8c88514b4d56dae87cd510a25994856d68a292ec650360b813e33559d0b9f123326fa574e5c15428d902230018280f73bbdb0cbdac436f2d4bad50286e766991df63bd4b57b432443d075052caab180b0cf42c35897343a1a69ab93910c41766693eb37692bccf1508fef06b5a9d297bf749fc8194de5264daca5920c909a542c419c868e1429a34b7ca47e941f43aa7a6b99c8498a7c5af9c994a367c14182cd64b338f106c33754cda4990ef466ce262766dc191e2b9bffc7258fb878d48b86644223dfa471885c9212811f44d0b6a8602d93b2c1ade1157c5558452193b51202950451157b2612393abeb25b45f70e18a0b612355b004001836b5183ac3904eb8bbc3850926897e5d27d43f1ac466487000d6a6ec79facc35b1dbbb8d02409f92c4dd5c6334c9b878bf01666b3c5a01cce0b18a2ca4910354b6042446a6ed6ce3aa5a844d7cb11aba66c495eafc67fbeda3687350d3096bcfb37965f587467a6b62c7146f1f28769da9244a22003cb17353460788944cc6aa06d6b5f58d0398c3778b326ba12474961fa9ef12cb8bd9963d3ca79a28116886a6bf2b601cee155562997ff8b0218d34b0a7cb52902bcbee2c2f41878a73509e999090622a404079cd4b29dda058064d2457817758fe468fc76b95b994bee5768d34c3ed60124364ac98e583f405680cbe0c37e016eb5f091093825734c36c2296724e8ca04632caca3a2da293a23606159947d57d97601f43ab278988f509748272d86c2b4d2419af403a5bfa356c788525775b5709ca52727a432f4205966350ff5b14ad0906d2477212166286578c97968e7cc97b15b5186214b54297a3fa522b2f5a0a54c90723c091382585e1725a3b4c98159852be39848d6432e4401e91b3bd136b8eeb15998e31aa5f667d9329586926f540b10dc583b2c6a2571657b91e217504ca4e9938c4d5343eb7b7905939787c6380aa2c67d667e485c8427a8b23daca033cc6e01f5a250865422f43b32f6290a88848d6359ac498f28892293b2a52bc17bbed833561b96b15778fb741b7e4ba889472d1ac58a9537a065e38e6337cfc3115b243953be2467ef3b507de13dad619b657b92ed8b8d46b58746fc6428315478ab1bb8b6b3a37424b74428e6d7819c81aadaf1920770c49b266f7880931128592ac564effc7f896ac1104cae391c9e491730248b25872c58171227fd221b21ac72d96b64327539b1d4351f239027956e8d404b6002b1d36b7b7b430b5c43179578bd4b775c2ab53f9e878f36e2ba6c539c67694f60126423b88581b8bb8e804342850f802a27eb2941547a43fe2292c2cc1e9bc503d4322be036239c112841d140a1d7cd202b3e64806f5fa2964094bf842705765540ea1032b0fc5c57e30b27c17292d1b0f615cb8adc8fb0132dfc6a49c37857880370f4e2b84ff448c30c10ace52ca2ec88c304c00a831a7027239548a67096713e1b0de7898d4df6877e7491449015d7e64b00d5cecbacba0291bd38a43c6dd63a20074556e2b3fb1b285c6185f551b7e906ab8f41102f927cae12981eeba3a2c76e2649a8315c071407bb31c7503ffc5629e9a46d874a60cbc51ed2c71db803f83446bf5709f735c55155766b6461561a4a39813c1cc056f5b8c96ea334aa30562f341752831e7f314f6630829ee2229e8aa9706921f94f6cb2bdcafc0c088a4463cbef9505481bba2d0dafda0eeab07aa575f82eb869a4231c3096595bf5ee87ef2c8540865e836799029d25a437ce73c2c2973458560e2ed2123d247ba7f81fae824e5f93596b5759991f79299826").ToBytes();
            var c = new BitString("4750315128b640a8bf381290871193d1c4a9b77dacb8afecacbe89cf6d92eee08147e96f491687df2eb7c4562b7ff72001ec7fa0864c3512fe0698ce32ac5412d75a80a647ed6a4c15253766ebd8db72e778c45c58caa45b76cd473127525edf7efe5f443c5670f3b4353cdf080e3d589d4cde7dfa7b5604b24c0d7b844bfbee3c7923c33c334bf460ab522d99735c5648a8000d173ba94e22fb212180a2c9f007670e1e7d3d51f4968e648289e634fd36e93aaa2ad1183d30b321cd1f983fe435226c5c9ed11cfe6a8e16469509de853cf80440289febb0b3327c46ee4693cf267f566a7f98864998256488613575674f3927376f31c87ae83eba2627dfc5f14e1d65bfbd26c8e242aaf91aca3db4188856b816dbea36c669082100f4ace32e00683dfe55142aaaf74133d075661f01edacd902a1910949b8d9db4f0a09b443dd7f9089851816d0a8c2b79e6c22154ad79881b5225e2bf7cbfcb101a27cded887494b89a596b2c47eb70d73b5ea5a39322d9f368465b4f45300b7ea5ed8e4c1735d784a8d639bb24fea5b5f3beed83b038671c302ad7c7a82b5000f00079c93b6d6962e43157b6f3a89831630e778101f2a2537ba2fabc0e856d2356a1d79cb5b3e71380efeaf84245ecf7bbf6cf361745a5c7e6817dbe94bad5cfa053e487ce4fba401a015cf340a4aa3be032b0264689e6d9882815dbad83b6f2af97f37376386e65f0dd0b84b824374fee6918c03ec1e419602e47187f3d920437fc4f7570fb0407f6b369844f6961ee97e46226a3bcd695535e4ed5dedfa1d958148609bd9fa6b2e5d81f1ff2bc94c8933a87abf81089bef966e5d7d2a1cd406aa5b4b643247399403c981a274a836dfa60a724c56bedcb98ec7d2ce2c02acddde5ecd53c2809466a6dee9f97f8a1100c305b6fb8128005fc45994fac6ae398b2b43790065e12f262d06bb6c1a01284f36b03bbfe15a044bd363c6574df23cde32adf4be9d68216b17861d1035e6dc9a3a92978220c94d5b71886ffb04e1eb60b44fa33263024ece7afb6467c25a948d95de962e81073e64164820398043d2642d8e9d04").ToBytes();
            var expectedSharedSecretK = new BitString("672b195adc9d5252bea33b59fc53e88943ff35e731c3f74d67187bff83c0befb").ToBytes();

            var kyberParameters = new NIST.CVP.ACVTS.Libraries.Crypto.Common.PQC.Kyber.KyberParameters(KyberParameterSet.ML_KEM_512);
            var kyber = new Kyber(kyberParameters, new NativeShaFactory());

            var sharedSecret = kyber.Decapsulate(dk, c);
        }

        [Benchmark]
        public void Nist_Kyber768_KeyGeneration()
        {
            var z = new BitString("f925e8ffe3f1f1f55e479779cc5a101dc016bb917063ad258932167a5fc82c98").ToBytes();
            var d = new BitString("f925e8ffe3f1f1f55e479779cc5a101dc016bb917063ad258932167a5fc82c98").ToBytes();
            var ek = new BitString("E21462911144C8C0A61A46818C072759F48B267C179A9C21F3C13E905918FDC69C15EB9EDBA63E53021493822ED7634C717259BC5C13FC7A4A291CA24AF9062B1202B2BA34DE7A1EC4E93DAE67800FB1CA6A761A6DD34B1FE35743914F64B78CF530776A4B65B8263B179746509B6B15B7CB8266589C8033B7121E68D0C2A5027CE6A1AFFA8C6EDD9B6E5B409B9C5A4EC3160468270766962B7E754332728FBBB92ECFE01D4F0588ECE3BD464AC66B894D808289CCE517FA68AF3B378B43F7C974F1712BB4935944207DAC48A52CA5093947BBF01CAED87F1BB976E987B66242AC03A3AF83E6B78EC62CDC1C1F0BA4A4E8322D8DC563352783B6F166B62A2E8E732819345CD1C034802A041AD3225196B0E5E6C69A37166884B5097C2CDDBC3006311759685F182AAB3114C7E0A99010C659C6D57DAE9A376F53430FF8523306A2214B7AD5599630746B5B68239F302242215370137E846C4DC76516540B91E826B3FBB1B9922708F16A3551BA6EF1F30E5E939284A434B6221E58E8C0A7EA1C1701CDE7F65E1C211880119FACC4340C7653EAE1815009199A984318008F805078C32C80BC460057244668746E718542E9C655EC370E5DB9875BF389580419D6761D6D5AB69B33068F8C3F6887A9DB146C9F91CDADA0267236895991044A13536F054880B9029F94A9D3AAB0FF8C9BB67B2DDEA7B9066696B2DCCAB19579F5503249D094E2544210F67757EBC0CE288A5BA5062E48A512561BB09B95E3C6598DFB11D7933BDF050F35608B2A5B00D011AC92C4689420CCF8F8416BA6947347280E354CDBA87FCEE405E5209C46807178A33CDE7991F0BA9989BC6A541455064A658A45BA85841283158A85C21666F55BB8D6C692C16DCA064C6071BE4D063BD36184A0EA0413B9A46C90978350650FB5ACED4BC17CB2001A114737BAA2240C7146A04341824FDD882CA9982B22CB896AE2B3BDD9C2D541174860083454CF70575B07F22DA4AC44CFB79BCB46972124502675C8E2678F5F31059F521528018285E51755845FBC1879AB25246AB573BBA5463C354161103331E14547876078404865561DA2B163D2E40DE61240E9B0242D331D47B4BBA8D1121D7006863AA1C37004A5168543130B2FF73D1C561F07557E686C9B85828784B6AD5A750D5383206650601650026ABB8CF5D55A52195934658A903BA71357869AB52FA6F765F0C084DB3656EC34825B94A30C9B5A58F66CE82606D0F12DAC0ACAAC3474B641CCF895005D5316A7928137C4879D62838FD91B2EA5CCA52C2BDEC07B25A4BDC2F8AFD456AE74EA6C7B0C30F9F58B5F1188841845B8B0370206ADE35367D3C547DBA672F1680297096292959F49BC188FD1B1190B81BBE1A2D52846CC927517FA776A6170B55B1D8673C712F50BF179B57E636F2D33A9A842A6EA29531CBC5F3B179FCCA2B403C9A3AB29581D062374961179C35516EB61D8729457BC566B612CFFD379C00B7DECC591D379271EE1138B8A3BDA201F9A94C8EFF5C0E6FCB222E91E312850F987CF892550D4F43B709059EF194E19A118DFBBB07BC60F849930F015A63A69714844975F1186D6827FE95041E2A3328100703D63C53C75917D5965F5CA6DD6EE110E0603DC43D458AC3A9EAF8BC70179FE5FB6D87E8C40879467281DF390").ToBytes();
            var dk = new BitString("D9D4757AE0980C9663DB851968B9686BB125C9165BBDA693C485B48969B7BA91ACA7586CC2F13D3F59AEDAD92614672BEEB0B8B9FC2E699A0DD6EBBD1900582F92417ECBA320D132408945FDBC718A291F969469DAC195398B7F7A33CEE28311794B649345C90C954476E859CB29324B5546620B916141ABF1F387BC6B06E5CA0D1DA344B6F914E1A8BC1A9B0421E60572495C414273FBA728DDE5464AB3486663243C8BB3AF90339A17ADB811914664CEF087293E921F2BAC95F0AB33AABA243DD7962675CE23AB73790A5C5829163DFC6699A02E89B48923E7C00FA124E671BECB777DF5C25AD0738540749D8C70A562065B1475299B4919D05CA0AA4C9B2EB57D709416AC51A22414AAD8377745E262AC97209161622AB5609056A390960FBA01737012BDA57666A0127093621E70427495D000B2E03B3DF82F15826408B69BAA60A76BD12B826695A4F7AD76AC96AC294D175C501B3485B62AC8150AAFD8913871710A153625D3872BBEC954EBF13F09274C432ABDE19BAAE1902040341961260D196076FDC001E6298E1EB8A95B1570BD9454108595ACB98B307356CF7B4F0D5349E8273579B507DD66A7349170F7E0A69307A40F08ACB7B708FE4A8CA193A618834C00FB8126C4070BC2B7064C5F0626B88ABB8FCFCABB53506741C0931D98B968D361AE60161AC6B91D26330796006C75CD1BD706793B223698C4BA080956B0414B090DCA7563A2DA8498650BEC8582FC1210C6D0505AD5CE156825AE256C13B9B1D41023376BAD0CB03BBCF51750E21A0D46B29D2A422AE17623CBCF5F154301D826AA70BAA5C33D1CF50E4854CB3535B9428C83EA95B9A35AC6B8F9A6B16A481B119C3DDBB25F95CCA830270D12BE9E014CE7C03356E2BF5CE76C5D16C9AAD9000AA467CF461E25F384E7170AAF60CAE5A19C75982D0709CDBF916B74C39B2EDB8B5EB87CB6AAC038F02C5C68B456C7120F63B59564602CE53B323CAEC1344F210028168CC85A5051A0A1217639CA4BA7B76C7A3F8559B758E26D5F050C5559735EAB1735078863C3074630BB21A0A3526652A9F591C7E3456EB1CF59A037A0E5362779CD440AB6B018ABBEB119CAD031F189867CDB12605065D75637F7775C284029BD176702185E9D8A23EB433D0BA4168339075E51A328D431EBC2011FD8582347C3518BA867691891258F1A2A8FAB9B643C6269946684F53CCD0797031E3274EF8494EFFC69972C24F2C36AC19176F6DA5D32333B76B523F3292A2B184D7947C062A46B600947498B3EB699115498455C05B23CCCC9CFB33C87C8C86C88CA1308908C98378D852CF8023FBC0832E3FCB2C9C1635C3476B0D3C07213CBA622223987495859621909868D956DAB304D41B76327A1ACF49531F8430923D87341E80C7C5387D37AAAE0E859F4269387C76FA78C0330316AFBC7C96C2BB5DE787D94439A76335D2AC756330A5B82413DAECB68C1E461EBE992EB203FEE275BDC479831224426DBB292FC684E4A0DA22933A3A0B4DBCA9F8D9B5BF183A749F55C836152AB020BDA982F59E4ADF9008C62288DA6A56659580009A10AA7C2AB3A1A251916BE3B3AA4D47485FBD92B030C9AF7F4B2AFF57A49F98A376236E21462911144C8C0A61A46818C072759F48B267C179A9C21F3C13E905918FDC69C15EB9EDBA63E53021493822ED7634C717259BC5C13FC7A4A291CA24AF9062B1202B2BA34DE7A1EC4E93DAE67800FB1CA6A761A6DD34B1FE35743914F64B78CF530776A4B65B8263B179746509B6B15B7CB8266589C8033B7121E68D0C2A5027CE6A1AFFA8C6EDD9B6E5B409B9C5A4EC3160468270766962B7E754332728FBBB92ECFE01D4F0588ECE3BD464AC66B894D808289CCE517FA68AF3B378B43F7C974F1712BB4935944207DAC48A52CA5093947BBF01CAED87F1BB976E987B66242AC03A3AF83E6B78EC62CDC1C1F0BA4A4E8322D8DC563352783B6F166B62A2E8E732819345CD1C034802A041AD3225196B0E5E6C69A37166884B5097C2CDDBC3006311759685F182AAB3114C7E0A99010C659C6D57DAE9A376F53430FF8523306A2214B7AD5599630746B5B68239F302242215370137E846C4DC76516540B91E826B3FBB1B9922708F16A3551BA6EF1F30E5E939284A434B6221E58E8C0A7EA1C1701CDE7F65E1C211880119FACC4340C7653EAE1815009199A984318008F805078C32C80BC460057244668746E718542E9C655EC370E5DB9875BF389580419D6761D6D5AB69B33068F8C3F6887A9DB146C9F91CDADA0267236895991044A13536F054880B9029F94A9D3AAB0FF8C9BB67B2DDEA7B9066696B2DCCAB19579F5503249D094E2544210F67757EBC0CE288A5BA5062E48A512561BB09B95E3C6598DFB11D7933BDF050F35608B2A5B00D011AC92C4689420CCF8F8416BA6947347280E354CDBA87FCEE405E5209C46807178A33CDE7991F0BA9989BC6A541455064A658A45BA85841283158A85C21666F55BB8D6C692C16DCA064C6071BE4D063BD36184A0EA0413B9A46C90978350650FB5ACED4BC17CB2001A114737BAA2240C7146A04341824FDD882CA9982B22CB896AE2B3BDD9C2D541174860083454CF70575B07F22DA4AC44CFB79BCB46972124502675C8E2678F5F31059F521528018285E51755845FBC1879AB25246AB573BBA5463C354161103331E14547876078404865561DA2B163D2E40DE61240E9B0242D331D47B4BBA8D1121D7006863AA1C37004A5168543130B2FF73D1C561F07557E686C9B85828784B6AD5A750D5383206650601650026ABB8CF5D55A52195934658A903BA71357869AB52FA6F765F0C084DB3656EC34825B94A30C9B5A58F66CE82606D0F12DAC0ACAAC3474B641CCF895005D5316A7928137C4879D62838FD91B2EA5CCA52C2BDEC07B25A4BDC2F8AFD456AE74EA6C7B0C30F9F58B5F1188841845B8B0370206ADE35367D3C547DBA672F1680297096292959F49BC188FD1B1190B81BBE1A2D52846CC927517FA776A6170B55B1D8673C712F50BF179B57E636F2D33A9A842A6EA29531CBC5F3B179FCCA2B403C9A3AB29581D062374961179C35516EB61D8729457BC566B612CFFD379C00B7DECC591D379271EE1138B8A3BDA201F9A94C8EFF5C0E6FCB222E91E312850F987CF892550D4F43B709059EF194E19A118DFBBB07BC60F849930F015A63A69714844975F1186D6827FE95041E2A3328100703D63C53C75917D5965F5CA6DD6EE110E0603DC43D458AC3A9EAF8BC70179FE5FB6D87E8C40879467281DF39068BF9574C09C05F84AA280E0DC6514E036CED709A383335DFD123F0ECACADB4FF925E8FFE3F1F1F55E479779CC5A101DC016BB917063AD258932167A5FC82C98").ToBytes();

            var kyberParameters = new NIST.CVP.ACVTS.Libraries.Crypto.Common.PQC.Kyber.KyberParameters(KyberParameterSet.ML_KEM_768);
            var kyber = new Kyber(kyberParameters, new NativeShaFactory());

            var key = kyber.GenerateKey(z, d);

        }

        [Benchmark]
        public void Nist_Kyber768_Exchange_Sender()
        {
            var ek = new BitString("7e308d0f161409bba7b4ca0f4027023d69cae1e6b6d5ec4a09a53739e413ff99c1869ccef6c65722dca84f461bc213c600385a7cd2159485855a204c0f048f2fc888f36c497d8c519824461d1253423b502f183115c37fdde70e3215187e9681f43c7ad2bb4d003475f23362d2405643088c5ae465e21827e6fa3ec85a7b5e83a9299b30beeb3da0fca4143b1286acb17780b05f08bf724ba479a389efe6b8bcc9a9f43c13dfb7a25d967cfda73f525149f8146cb6b265208bab438b62519aabdd8b27854a17aab287f07c39699161d8005989099347c670244a197a7abcd9909b20030cd5a402ef956286ac0a76b071a11b7a2a51bbd3f56731cb38f62a5b347467993a8183b6c95d628806a7ca4bc7686481a9c5ecb09d167745b7915910a4ef11ceb2fb0962325a0aaa72ddb12417e5c2e48796927451e83c3ccb0b9a2afb710b090753d04e55ebb0640c4a90a36f8f930bbb7888fce03187e8a2b604418987b3030297d5f73629540d08229a5bf2484be50644fb54a8b2a6cff7822af31054b587db82265d40c276c14565162067620c4ea780b103ce3e695b37d852bd9311fba164342b4b0b37bee8da8e890881e34824d23759256a07005712ad20666b5c958eab233b95188f587650aa0fa7616062292df0b36859b2af410bbc584b545543a777f59d5b79277c693d1a63b127185a980b4a8d5b362c239e5e37ad60202fd3f48155b1998f7456d275083b54576b15552f377e51ac73211a33050300a01b1eb1797a289b4225c2c9a3f64775fcb860502bcab36b59047241b331be2c7c2066869c490fa926808f728e168953dc54a67ba030b7006a79dc4dde050a19e8cfbe7916553278b687c7688aadeaa75079f72728f56df6d355d0a02208f26434186a554a78c572bf884cafeee0a72eabc0e2774aa0eb49be316daeb7acf185ab2fa9c38ed150669abe9657c83f0949c1305833a1886935c491b81e74132a4814c4896a805be80acb3b248e912e185b0ab0bbc4ce39a38f605c22d64db2959e18560b6a211706e0c9d1f7a177643aa87a2e18645290394931796dc2742b57678541768b7a581fbd74acda334dd5c437d068ba93c125f9545d60511d0f4674ac120430165d19374100e573e23b33eb965403db810ccca178917cb53846f9587ffc444382b879a527340a660c865a90c0a5bc59a00c88016e0655afb509af759525db20bfc988ac351943bac8565b108e300a3daf563181a57febf299fd984051236a4fa3a039308e5c5244fdac4a57b4a96f74545d3c23d3ab14ebd89c052b669841872b3969ba11a4db64a0a0d4a87bf5a58e73166069cb51b51a9fabbd128796e4709589c81ba03805d4921f9bb4a4393a82a1b1aa0f83cc591b8901e1bfb546ac7056321e5ba47755485f8624da018783889e3c7b34158488b1f61b95a34c866b7553fb965bea3a63960c71664146240b90d2c38e2628f0041cb5172a58f2385a0342c776b8504bc3dbe65052d22692e45bd200b6973cba64b8268c064fa8b8304dc602a9eb752e2c4f440743ff17614211adc2230adddc9f38da5278588c589987170bcf9a895ca46852ee7a6f14119067ab18410a95dfe4c4c7103cee376b0f5b6073a150f0925bb5763a350a47dcabfaee24f71e85497d5dc8401a328b5e").ToBytes();
            var seedM = new BitString("2958f30d7acd6138645523a82e70e7177f8b1b56456517de9c760b445557e6b0").ToBytes();
            var expectedSharedSecretK = new BitString("6603fdc79333117ae25f661a8a08c8f52b873239a69f5ec2c12eefa209a77406").ToBytes();
            var expectedCiphertextC = new BitString("be1e925d7a859f0f63cf7b1449239d543a9b5a3c4b4df16a87a61397db88c5eb7c1dc12f23069d8c39e707b07132cf40357bb11abac2f9f5274a8c280b77e23e6d5f0380331014be765f1afa0d20b65e2161780672091f453c4b91273d72f1348747e1bef1a6d865582fbcd9c1a74542d614fd9d35fa76bd5ba113c7c944122374a57e14acf149e5878f020fb3198499de3273080db515d628fab265c694e4bc5f5119484d44c8a768ab77c1e0a09108dcc22dfb3d25c67d7eae87b7e02eb84a6250ec2c5becce93a367d994ba6f1ca2ad93577b52e0e6b56583f0b8e659677d6bc351b79f7d159a6a69bd23d21e121be6dfbb03fa3f7421add86acb1ff6b270641a179eb1d661c5922fd3ca022e44ea41238de9b88c2ddfbda82419196a8e945764901cad7175272efe9db7bd9b48932c520ccbdb7ca712b645828324157463fe4b29c79765ec361715f36267b50edacf2fd96c5db2f119550a1524c56e95913332dbc03ba736ddba6f245820ef434960d3db7c523df4903d534f7ddb5c2fd29de3858c992a8c6f07cdeb7dbc8b9e167d73c891b72578806a7c901857ae2288011de3569709f813b48964332837abf41ab9f6af20915de847ff6c3d1961ba0f18831d4ad40a99d620da43f710bc93775b5ea8802690811dc4f04c774bceac939094d260c8807175edfbdcca5a3ab5ec6621b7d8c12c986436b143e6ca395143f9460e143b47650d0e8d331b43f68e9d5530ec1bf14c5d2dcd1a11fa34ec3ae95d7af468b884132f6686beb59e57464bc49e31d59e31de72f163ff22ee2d6dd693d16b98dbe588a40556274ada6446eb920ddae65f8012647558059ebfa06245524b91e1b2ec2b14477ec3d307f8aaace8ef31db0b26a5106ebced4474c18fb019126b4b5299a5fdf6d18ebebc4f1d92145cf61ac5075fceae0ce9407a6c281da1bcdaba01b2998799c099305ac2194f7103c9a35bcad41989df5e562fcdcbf2582a8c2c8cb1a0e9516def1303c6d9c4c1daba3b602c12b9c0d82cf6645ed5723a212d39f8a527ae6c33adbb6bdc2dc952c1d2ebb95560a12cb85e50231809cbe1d87820a9bb6fa81ecb89dc066686007c5421c8ae99c81525a4ab1551a63f026e6d16541c8d8f8f784c3a742908fc353bced369e0cd994cd16e53c248607d6a6a9db6422db36d52826ea3355ffc05b20f444b1bf8decbce539d4b65035f7d553e6cbe192071703a2346d87eeeca5478f7d7d9d4c11ca971733f81ed247f47da4b35a17d77902a2262f1ed8dee857d5bf496f8459a338ee95dbf930ee9bd2eea0154d05b6eb422370437796fb2327119d347a2e634101deef7c56f4371fbd6bc218d6830312c16d12cf50afae3497e016bb05c1f09bcc43f7e545d99e41b265804767234157720156c91ba57b1a641e52ed109b0c3cc7b40244e766270b5c0d0e51cbb2b0304c18c46c22b5f1a2eb6935fa4876c2aae945eb0bb788c595b50d72e315819316efe2ca9895ee50a081c6463546e6e62acb7b0a5fd04d987aae24a").ToBytes();

            var kyberParameters = new NIST.CVP.ACVTS.Libraries.Crypto.Common.PQC.Kyber.KyberParameters(KyberParameterSet.ML_KEM_768);
            var kyber = new Kyber(kyberParameters, new NativeShaFactory());

            var sharedSecret = kyber.Encapsulate(ek, seedM);
        }

        [Benchmark]
        public void Nist_Kyber768_Exchange_Receiver()
        {
            var dk = new BitString("5171385391b9dd553c3726116d55b0bb10971e614257fb473ae93aacab8577bb3f870a194ba37e2d062863092a28291414a5991cb53739b49aa4d5a3dacb2c227912d6f36dc2e03f447b4cfcb8a4a502c72a336b5af9593046b5b49802ae704c0d5043ad3ab0a869cafbf50f8459bec7c7a4bbb9c3812b32448b4ddff928e7ac517d6ccba55835e02c62c09c34de6857d08650d0024db7176712fb2142f065a9703d779267b39495c65695f0c2504d08856d847a53f4b7614b57b594cec4ba72ac7b0846f18690588a0b2bca521a910456576b140370ca2d12e5594298993dfc9f0cb455a5d8c31d8860e404af80476ba443b0c59a5c9738b29af337979b676c0bbc158c0844da23b8d39da5e8821330b5bb13402f0a4974ac3b8f2320b684a505b66e257777aa40b43c31c52a1714466c1a3553a7b8a76cef0049e0472b8abba1b83523c70b3595db7d2cbb329280b16a5ab5ec2593d7742bd987cceb57a035f764e9c48fb00b5014959dc15988bb100ab7c6ab9f8696d35ac2e77b2dc4447f86194a3aa6ae46818a852b8f0f84311c95744d9760da5a635db098f3f10d658bbf8412b8080cc2855b0f754661a1e6c5afb6022f0252817ac527710d92f264a4b00e836180ec12632c594fd61c66c0e85859654772a04d24ab90ddf7157fbcaa471c738cdb90362030471c1a7aaacaf8bbc35e53124b9b89696178c6c68ea66c605f57abbc8535338b40d4d5409846c8c168561fec303ef9a1430a1eb655576faa429c6a1932a598b3304d0511aac5fc9a6430b15e77376a486a2ad293d3c7490859ca489a7400d088c5f66665a974c8e865cdc27317f3b38ee7897c7812f1b5cab2627cf9c48ec840647a5734c23843d9f772a3a90c2d1593a7e7787cc9541bd046be7c1b6dfcae8b78910bb986c6364865cc97658880bbc3637cf998f1538348175a86d25e1ae8c6c9952a94359ead9968cd670a024a3ce9fa30a582321b957c16b0a87cfb332e06b637b617f9e8b2a1aca99b5090735c52a613949e3337149a8c9457083cf12b8ee847e40cb429f3760ba768e42470259c4611b5943f9a61afb3c79b92ae20a10ec7e5cc5614516f4ba51810b3377c2fddf96a5d59771beb38e168407aa03253221b5116320a50aae1f31397f877643158ab3c66105943211c5c1cb4765f46b69a8449bdd0c25b13cd23d263b9404cfa8a9d0a7c33dfe9601e4a79c2fa87806aaaaa135b24668b6f73be9d953294dc17b375a759fc73f922ab88c3ae4b85a67a5bca3ee66ce0bcc023405ec9ba04f94b692b62613c963add65baf2b715a710be1ccc5a95c840da7ba703e0a799403d7657742da326b077bad47b9cd9b165ef31688aa7a20016b0e72246f29220ab0c40443852f151ad284074bc1a7b75350d99715945d54d9c6386c365ad134a74044aa6c52858488474445472a5da0a4183c80872b3efc61744c698e10c989f6c6021178c220c5fa656713aa35a1fba4ff5c944be61aa87ea0789818ebf9a765cc49ead49ab5f10aa47fbc798c05d2be7b5e988731007a506d840d8ec9b10d782e94029f5040245139d2d590bffd9c66a9819ed6776e7f50c1469b77cf76e2dd01a52f615b5959813263b7e308d0f161409bba7b4ca0f4027023d69cae1e6b6d5ec4a09a53739e413ff99c1869ccef6c65722dca84f461bc213c600385a7cd2159485855a204c0f048f2fc888f36c497d8c519824461d1253423b502f183115c37fdde70e3215187e9681f43c7ad2bb4d003475f23362d2405643088c5ae465e21827e6fa3ec85a7b5e83a9299b30beeb3da0fca4143b1286acb17780b05f08bf724ba479a389efe6b8bcc9a9f43c13dfb7a25d967cfda73f525149f8146cb6b265208bab438b62519aabdd8b27854a17aab287f07c39699161d8005989099347c670244a197a7abcd9909b20030cd5a402ef956286ac0a76b071a11b7a2a51bbd3f56731cb38f62a5b347467993a8183b6c95d628806a7ca4bc7686481a9c5ecb09d167745b7915910a4ef11ceb2fb0962325a0aaa72ddb12417e5c2e48796927451e83c3ccb0b9a2afb710b090753d04e55ebb0640c4a90a36f8f930bbb7888fce03187e8a2b604418987b3030297d5f73629540d08229a5bf2484be50644fb54a8b2a6cff7822af31054b587db82265d40c276c14565162067620c4ea780b103ce3e695b37d852bd9311fba164342b4b0b37bee8da8e890881e34824d23759256a07005712ad20666b5c958eab233b95188f587650aa0fa7616062292df0b36859b2af410bbc584b545543a777f59d5b79277c693d1a63b127185a980b4a8d5b362c239e5e37ad60202fd3f48155b1998f7456d275083b54576b15552f377e51ac73211a33050300a01b1eb1797a289b4225c2c9a3f64775fcb860502bcab36b59047241b331be2c7c2066869c490fa926808f728e168953dc54a67ba030b7006a79dc4dde050a19e8cfbe7916553278b687c7688aadeaa75079f72728f56df6d355d0a02208f26434186a554a78c572bf884cafeee0a72eabc0e2774aa0eb49be316daeb7acf185ab2fa9c38ed150669abe9657c83f0949c1305833a1886935c491b81e74132a4814c4896a805be80acb3b248e912e185b0ab0bbc4ce39a38f605c22d64db2959e18560b6a211706e0c9d1f7a177643aa87a2e18645290394931796dc2742b57678541768b7a581fbd74acda334dd5c437d068ba93c125f9545d60511d0f4674ac120430165d19374100e573e23b33eb965403db810ccca178917cb53846f9587ffc444382b879a527340a660c865a90c0a5bc59a00c88016e0655afb509af759525db20bfc988ac351943bac8565b108e300a3daf563181a57febf299fd984051236a4fa3a039308e5c5244fdac4a57b4a96f74545d3c23d3ab14ebd89c052b669841872b3969ba11a4db64a0a0d4a87bf5a58e73166069cb51b51a9fabbd128796e4709589c81ba03805d4921f9bb4a4393a82a1b1aa0f83cc591b8901e1bfb546ac7056321e5ba47755485f8624da018783889e3c7b34158488b1f61b95a34c866b7553fb965bea3a63960c71664146240b90d2c38e2628f0041cb5172a58f2385a0342c776b8504bc3dbe65052d22692e45bd200b6973cba64b8268c064fa8b8304dc602a9eb752e2c4f440743ff17614211adc2230adddc9f38da5278588c589987170bcf9a895ca46852ee7a6f14119067ab18410a95dfe4c4c7103cee376b0f5b6073a150f0925bb5763a350a47dcabfaee24f71e85497d5dc8401a328b5e30eeb431d8517cdc95e7910a6acad589cf517dda895637fe3f939f7bd4b27e8d2958f30d7acd6138645523a82e70e7177f8b1b56456517de9c760b445557e6b0").ToBytes();
            var c = new BitString("be1e925d7a859f0f63cf7b1449239d543a9b5a3c4b4df16a87a61397db88c5eb7c1dc12f23069d8c39e707b07132cf40357bb11abac2f9f5274a8c280b77e23e6d5f0380331014be765f1afa0d20b65e2161780672091f453c4b91273d72f1348747e1bef1a6d865582fbcd9c1a74542d614fd9d35fa76bd5ba113c7c944122374a57e14acf149e5878f020fb3198499de3273080db515d628fab265c694e4bc5f5119484d44c8a768ab77c1e0a09108dcc22dfb3d25c67d7eae87b7e02eb84a6250ec2c5becce93a367d994ba6f1ca2ad93577b52e0e6b56583f0b8e659677d6bc351b79f7d159a6a69bd23d21e121be6dfbb03fa3f7421add86acb1ff6b270641a179eb1d661c5922fd3ca022e44ea41238de9b88c2ddfbda82419196a8e945764901cad7175272efe9db7bd9b48932c520ccbdb7ca712b645828324157463fe4b29c79765ec361715f36267b50edacf2fd96c5db2f119550a1524c56e95913332dbc03ba736ddba6f245820ef434960d3db7c523df4903d534f7ddb5c2fd29de3858c992a8c6f07cdeb7dbc8b9e167d73c891b72578806a7c901857ae2288011de3569709f813b48964332837abf41ab9f6af20915de847ff6c3d1961ba0f18831d4ad40a99d620da43f710bc93775b5ea8802690811dc4f04c774bceac939094d260c8807175edfbdcca5a3ab5ec6621b7d8c12c986436b143e6ca395143f9460e143b47650d0e8d331b43f68e9d5530ec1bf14c5d2dcd1a11fa34ec3ae95d7af468b884132f6686beb59e57464bc49e31d59e31de72f163ff22ee2d6dd693d16b98dbe588a40556274ada6446eb920ddae65f8012647558059ebfa06245524b91e1b2ec2b14477ec3d307f8aaace8ef31db0b26a5106ebced4474c18fb019126b4b5299a5fdf6d18ebebc4f1d92145cf61ac5075fceae0ce9407a6c281da1bcdaba01b2998799c099305ac2194f7103c9a35bcad41989df5e562fcdcbf2582a8c2c8cb1a0e9516def1303c6d9c4c1daba3b602c12b9c0d82cf6645ed5723a212d39f8a527ae6c33adbb6bdc2dc952c1d2ebb95560a12cb85e50231809cbe1d87820a9bb6fa81ecb89dc066686007c5421c8ae99c81525a4ab1551a63f026e6d16541c8d8f8f784c3a742908fc353bced369e0cd994cd16e53c248607d6a6a9db6422db36d52826ea3355ffc05b20f444b1bf8decbce539d4b65035f7d553e6cbe192071703a2346d87eeeca5478f7d7d9d4c11ca971733f81ed247f47da4b35a17d77902a2262f1ed8dee857d5bf496f8459a338ee95dbf930ee9bd2eea0154d05b6eb422370437796fb2327119d347a2e634101deef7c56f4371fbd6bc218d6830312c16d12cf50afae3497e016bb05c1f09bcc43f7e545d99e41b265804767234157720156c91ba57b1a641e52ed109b0c3cc7b40244e766270b5c0d0e51cbb2b0304c18c46c22b5f1a2eb6935fa4876c2aae945eb0bb788c595b50d72e315819316efe2ca9895ee50a081c6463546e6e62acb7b0a5fd04d987aae24a").ToBytes();
            var expectedSharedSecretK = new BitString("6603fdc79333117ae25f661a8a08c8f52b873239a69f5ec2c12eefa209a77406").ToBytes();

            var kyberParameters = new NIST.CVP.ACVTS.Libraries.Crypto.Common.PQC.Kyber.KyberParameters(KyberParameterSet.ML_KEM_768);
            var kyber = new Kyber(kyberParameters, new NativeShaFactory());

            var sharedSecret = kyber.Decapsulate(dk, c);
        }

        [Benchmark]
        public void Nist_Kyber1024_KeyGeneration()
        {
            var z = new BitString("d988083c094c62d5b82289621ba96c212033633ab33b69a57590017b6c5f5279").ToBytes();
            var d = new BitString("d988083c094c62d5b82289621ba96c212033633ab33b69a57590017b6c5f5279").ToBytes();
            var ek = new BitString("6C42BF90F65D1A13B3F83721D23B6B92B53EE03A690421B8411877C7B5A2201A0217D41C62C51AEB116FD3769EFC15733AA5CBF2F92E905275482CC03129033617B7551B3A581A95FD2A77F56661E2B664D8545D70DC264F1941945082B94B8BC6CC93283826B6594C22150FF850CAB5CABAED0B074DBA545E371D1E156AF0B2306BC8B4A42104DE818D42D892C0E52660E1872B9A2B3DAA4DFCC4B3321CBD628C6D29457073A989B2B46A978772E1C5CEDD3941D6C50D419589E003A9DC5068B98C1B87EABFA581B9DD454BE5361D28A3242214175F60AE31BA4E916373A559BF87B8C297E371E7A62539B2211FB0A6E60A72D3CB73EAB632B9213337AB0D3079174696134C876059B3C57FEAC6B14B9979078C0A082D0FAA9995F893E5C951CD6BB4E2D10C737146AD3C83A39449F9CC9B02B6BF3848544417B13A0B442AEC44B5D66E0D053A8E16A614BC8C32C9113AD59F123B168F37649AF3C18E2B62675686A4E41294CCA2D3272459BBAD446CB9DADB502C225F06613ADD4777A7A411FB82C9B569678784B446F777B0E825CE08CC8E86BDE6539E12522F64BA2E5F5839245101ABD7870105704946CD4C197B1106A2C2162471A73B32F04C1568AE1CCB827203469A636389549DC39B11193261DFA91ACE29488581840203553187B3B93BBE3D54612D4152F13CAAFA3284EB093EF0D7970F7A22524665C3EB9173317EBCA57BB8BB1F9133C89499246DC1102B7B79DE121041450E5EEA16AE512CB1363E86D228ADB997A68191CF843F1F47A358E57FE7B3B797B246B6120CA380719FA3923F206994DAAD8B0C74C869762084259BA91114617988E3984FC661F10A5C62816AA9CC7D9FDC0E55039A439ABD0E6580EC60082FF83A51DBC9B4A442AEA16B03A562C08534F8CAA7E34A1E6BD045289588FD4B333F544C4F346BAC169E85022B9771BB1B6A62A1333DBB9489F03B3E2325C3162A349F68B90B0C716FAA0D9D2CA8F035C12D70CA134A4C658C0D37AC54F695367BA1B3A0E40275DC16E2D25BDAF8BAFC8639A3E34C47760D02785A779682623CC8F7B2B644BC214707A254567D4151CB2ED415142902833CB03C96526767B6D3EA742AF97441423293A8694D778DB75134B6C91B16012300DC3ACBE43C0F07B68D42AC06B40A19662D0664AD70C89518A4732DB24B5CCA94A96179447BC8BE410E86509F5A229FAA19C99F64B62E88853F01620C5365BE463BE35015B6255812971AEE1148B979594CC0A725A9C456EBB63EB3B3D4423875F10AD5433DF0C781019196FAD081CB9C8E9F44CD0EC1ADE9C20948B8580E184D44D85976579257DB084867800FA915A992605F72414BF31FA8420D2DF3A21BA411861175FB202328BB261D757EE63B2CB793470017AF8CE05CDCC2310608C6F6260C2D8B927AA6B398C155CAC007085C4ED9666885794C38E67C00002C3FD8BE27D4073B93AE96DA2FEFFC15205032D3C857F97349BE415945AB7665CCB522D71051E160D66148EAC16B1EC0CE27920921966EB4A8A4E60707D62394DD784FE6E86024CA49E8FC1CFFB456ED866AB348AD5A4A46B092A65E252AF71459751153F92620B2F28AE3E1875573A3F5E07D6EF357F3E1BFB6604730EA545A7B12617B6CE09409BD86512DAB98CC82A8CBD8473E0C9BC4BBAFA667166EC643D8EAC74040C4BB480C77B3A359203EE5C9951202A2665B70A56240E4378EB4DB21563BC6D40ACF1272B144D68E34035206897DA0A366ED7223F2BB9B39AB6B76C518B9155504D3BB1D580FE55073DAC90B4867C80C349721D7A38B40C4ABC038B7151B154098A971C014CC2DEDBA341521794F61C718D83D6CD8234AA4765A94695FFA4D456A4AE8322B4962BD70081C42B70A67028EEB6CAA6EF8313B0150A77C2D44EA791276AC7D85B9125B0EFB352903D14522F2BACD42ACF00393907AA4B14AA288A3B41B242A296325AD757111F9B2A8E32F8B1110BAD7762E8CBA83B8B5BD5C6831033B8AB7813EB38687054212759EEFE19B54644ABEB633983C13A1D692FEFC309C996C7B3805DEDC102DA20870494509358F1537111BF24726513AB66A5A727A910AA4245DC27CB8328EB8F01581B074C7503FC90121DD763BC90A3C7CD8B50E5766F7F461A27102D3C2C5F94A0DC9EC2D2A7402D20B8EABED229CB0C049A38FAF4F872CA90ACAA38008839EFBCD9969B0").ToBytes();
            var dk = new BitString("573B2607671C5C245613A6C95A096C9471784F66B205B71D677428B5F248CCC8A966A5AE44116A909CA1ED35B891B0B72A0B6EC1E67CB531486BB4CEEDAC344C633C2E3C9C73C97973099DF2AB69DD730716BCBE47087A4D46621BD901B596426B318177B9850465CC027928F99A0A2F014312B452A58440131A3758A8B96AFB324735B5150C18CB81842D6C9B18A8526CE253B9779816B2066F732F1FEA98BEE93D6C8513588B51EA2BC912114F52624C36D064D9465777D281EA949C3D01250E38AEA29B2129E5974F417294691D02D85E216B9F57D455EC0455AB9B77FC841C67FC53F52275633CC422E185573AB7EC47C87243B5B9E80692E8289DFA5D66A265E3F57EF8D2723FEB09EF45A267C2CDC0491058754BB03C497BAA4BB3E28E65576DA8509F0A473B097B3BB76B551B8AAB4C7B35355CA8CC886A560C454778069A49B05A544D53B84945B627556209255A17FB1B689693BDF2F6BC57957662137468C224AFFB09376368FB5A789C55CD16660FA41835B97867F7882CA7A41364A774B28C75CA9A8363EA41A716111DF89B2BE22CF88776775AA16D88B14864A5FB3C0CCC1B1AE01167B7567680F41355D5515A15256CD04FCD541161B10349F8875D60336BA622C3C037A6568DEDD32B9BB7A88068A389207F026C4CAD450F5E346358C5821AFBA620897B52C77FB1C79D972386B472A69F4422D2D14BADB6951136CE3E811552279BA97A22C893353D59680DC00C8D3C5F04CB116264B248273F2651851A443CD45B1F575554805C56EA4C6F37C2BBB8E79532A60380682660D4BB7A4CB05A340EE42B5022689D8E18C022F65ED65B9D031056C05A672E001B2A314E85BB54F2591AA22747D7D814F3F3C285C2852ABC189CE19113EACB27C0A61B44359D0BCE8937C89987CA7A9B83976B7D059B73F2A1909CA3BC117AC30AA7CA8B4B30F1BA894896625214C1DAC5BB5C31B5AFE67E0B70190A8B1293B00B1230786CE88BD5D8824EDB9DF4F9BCC792370FA76E84E6CC35759D8D20CDECB69FE7C8C4658B02F6834D47B971809A64436398ED511587D32DB0084515A56F62FC1DFCDAC2859434669732B3EBAAF1B422516575E0A6A7308291F326B53C2B60C2C0ABA28A09E78746A72644672048597967ED497B564319ED21027F7A39BFA51CB2A69904D514090B3342F6A2AB908FE0BC6300F1C87F43C9AA96668650A811096FD738C973895F18039ED4717997E04AAE348F8460C47CA870EFB14AF8677251367C95152A346A031DDB06EE927C4D66C95AC049AE1093D71C4BFA7C31C951B755A442E018B7DB97B13D8C01D14A7E96BC889731C00CC31C6F6C9B5AEC1F3A59606FCC9AD7094F9E2A038ED2402218888373433FFBC1FB270DF11816AE561E87A5BE65375D5F14001A7BC2A1357172613789C92290AC576F59264A00208AC11A578B8846D18E17E49426635312F0475887042B5340E00955ACD28A27F23D7AE37E66184B7F96374DF163B882877C500EABA00DA6C8388DB3924930B0EB6C1FDDA454A77A6E4BB4C744A811B0791A9B5B0B78809D3CD6B09D46BE638990236CAE30985872BC901BD0A621879E3C2B27B59478AA9B67B5D330C2D69C0A99A156251D8F4B01C96BBB51BABA8B776A6E65C15CF39074920D6CA4A4E5ECAA8910B073478B9203391ADA3327668288BA600A5122DDCA7CF5625798EA4DFB32374FC98826B4CBF3CA0D2CB580E9156EEAF055DDF5595CBA0176BC39A61776EED8908A0026FFF30241DCB0F664072A718EF255C793808414BB1C9A7300A875765F451628B774BA4110C96932F1EAAC0F29346A977B9DF7224339766D8936710661A45055521934884A66C05870ECF95B4423BBEDF61A2B893EE5204B2FC13228F8354348A2D77A60544771CB73ADB5C73E1FCB6E0C47471D2228B7217DD2D9223F928983D6809290B39E1565D9C092084620F0A539B3B5B658814496C8449D30CBDC7B33FA422E64FCAED54ABF115B603803B0EFA7238908528C4021070C0D1C73B8125925DDCB2719F23F68316D5006C2A61967B45093061925A5419920445E64D51FAFE886CF578599039609C58161F627B1589F32E12BA0669AB019C5E0BC2EAD26A73EC596954C628362298AA01F26B878AF9ACCDBE0C5E0B7C4A1B851A4CC556C42BF90F65D1A13B3F83721D23B6B92B53EE03A690421B8411877C7B5A2201A0217D41C62C51AEB116FD3769EFC15733AA5CBF2F92E905275482CC03129033617B7551B3A581A95FD2A77F56661E2B664D8545D70DC264F1941945082B94B8BC6CC93283826B6594C22150FF850CAB5CABAED0B074DBA545E371D1E156AF0B2306BC8B4A42104DE818D42D892C0E52660E1872B9A2B3DAA4DFCC4B3321CBD628C6D29457073A989B2B46A978772E1C5CEDD3941D6C50D419589E003A9DC5068B98C1B87EABFA581B9DD454BE5361D28A3242214175F60AE31BA4E916373A559BF87B8C297E371E7A62539B2211FB0A6E60A72D3CB73EAB632B9213337AB0D3079174696134C876059B3C57FEAC6B14B9979078C0A082D0FAA9995F893E5C951CD6BB4E2D10C737146AD3C83A39449F9CC9B02B6BF3848544417B13A0B442AEC44B5D66E0D053A8E16A614BC8C32C9113AD59F123B168F37649AF3C18E2B62675686A4E41294CCA2D3272459BBAD446CB9DADB502C225F06613ADD4777A7A411FB82C9B569678784B446F777B0E825CE08CC8E86BDE6539E12522F64BA2E5F5839245101ABD7870105704946CD4C197B1106A2C2162471A73B32F04C1568AE1CCB827203469A636389549DC39B11193261DFA91ACE29488581840203553187B3B93BBE3D54612D4152F13CAAFA3284EB093EF0D7970F7A22524665C3EB9173317EBCA57BB8BB1F9133C89499246DC1102B7B79DE121041450E5EEA16AE512CB1363E86D228ADB997A68191CF843F1F47A358E57FE7B3B797B246B6120CA380719FA3923F206994DAAD8B0C74C869762084259BA91114617988E3984FC661F10A5C62816AA9CC7D9FDC0E55039A439ABD0E6580EC60082FF83A51DBC9B4A442AEA16B03A562C08534F8CAA7E34A1E6BD045289588FD4B333F544C4F346BAC169E85022B9771BB1B6A62A1333DBB9489F03B3E2325C3162A349F68B90B0C716FAA0D9D2CA8F035C12D70CA134A4C658C0D37AC54F695367BA1B3A0E40275DC16E2D25BDAF8BAFC8639A3E34C47760D02785A779682623CC8F7B2B644BC214707A254567D4151CB2ED415142902833CB03C96526767B6D3EA742AF97441423293A8694D778DB75134B6C91B16012300DC3ACBE43C0F07B68D42AC06B40A19662D0664AD70C89518A4732DB24B5CCA94A96179447BC8BE410E86509F5A229FAA19C99F64B62E88853F01620C5365BE463BE35015B6255812971AEE1148B979594CC0A725A9C456EBB63EB3B3D4423875F10AD5433DF0C781019196FAD081CB9C8E9F44CD0EC1ADE9C20948B8580E184D44D85976579257DB084867800FA915A992605F72414BF31FA8420D2DF3A21BA411861175FB202328BB261D757EE63B2CB793470017AF8CE05CDCC2310608C6F6260C2D8B927AA6B398C155CAC007085C4ED9666885794C38E67C00002C3FD8BE27D4073B93AE96DA2FEFFC15205032D3C857F97349BE415945AB7665CCB522D71051E160D66148EAC16B1EC0CE27920921966EB4A8A4E60707D62394DD784FE6E86024CA49E8FC1CFFB456ED866AB348AD5A4A46B092A65E252AF71459751153F92620B2F28AE3E1875573A3F5E07D6EF357F3E1BFB6604730EA545A7B12617B6CE09409BD86512DAB98CC82A8CBD8473E0C9BC4BBAFA667166EC643D8EAC74040C4BB480C77B3A359203EE5C9951202A2665B70A56240E4378EB4DB21563BC6D40ACF1272B144D68E34035206897DA0A366ED7223F2BB9B39AB6B76C518B9155504D3BB1D580FE55073DAC90B4867C80C349721D7A38B40C4ABC038B7151B154098A971C014CC2DEDBA341521794F61C718D83D6CD8234AA4765A94695FFA4D456A4AE8322B4962BD70081C42B70A67028EEB6CAA6EF8313B0150A77C2D44EA791276AC7D85B9125B0EFB352903D14522F2BACD42ACF00393907AA4B14AA288A3B41B242A296325AD757111F9B2A8E32F8B1110BAD7762E8CBA83B8B5BD5C6831033B8AB7813EB38687054212759EEFE19B54644ABEB633983C13A1D692FEFC309C996C7B3805DEDC102DA20870494509358F1537111BF24726513AB66A5A727A910AA4245DC27CB8328EB8F01581B074C7503FC90121DD763BC90A3C7CD8B50E5766F7F461A27102D3C2C5F94A0DC9EC2D2A7402D20B8EABED229CB0C049A38FAF4F872CA90ACAA38008839EFBCD9969B0CB2958CECABEA4876FDC3C9DA67D1FEDD3C530F9603A3FDBB2C15B5825681226D988083C094C62D5B82289621BA96C212033633AB33B69A57590017B6C5F5279").ToBytes();

            var kyberParameters = new NIST.CVP.ACVTS.Libraries.Crypto.Common.PQC.Kyber.KyberParameters(KyberParameterSet.ML_KEM_1024);
            var kyber = new Kyber(kyberParameters, new NativeShaFactory());

            var key = kyber.GenerateKey(z, d);

        }

        [Benchmark]
        public void Nist_Kyber1024_Exchange_Sender()
        {
            var ek = new BitString("64b6519b5316fcea01db6a0b6a297a1559cd52b73a984c589f9c58ee427f3af99c8c59835306ab67d0bb0cb411baca2766537143601f089450e0f8a064d60fc35780bf568a679807d847c29328731530194750940df077ec607c9fc4c581381207fc37de980a4857a9e3250bf1002fb1837634fac78ffb28d48bba64d65c1afc1c38d2b651324fd740a4fa622025f675a46905be76b05b276433e2176fb22dc7aa862c72314c38861e01302c56278c8388292a8754ec173b1bb5fff78aa8a49759244d7c3082eca9194b7a469e9291f9516822a26a82123d7289162f5c396c9781785940caca213116c126e71f98983c7eac761668ab8e911df9c4ba9fe825b0fb0b02613d99d697ddf7c9c9a7c0540a4597312d952142374910b4949fc5c60967464b81282628dbb6d387786e893819173418654e5776a64a212d8a7aa785a59493e38083f81190567ae08a6fb1ebb45f2641417a5b99d151cea994f8e7b4df9a1714b4983d7a0c58c55bf963af7d72cf508bb67d71565946781fb318d2eb31cff01efeb8a4e4bb02f7f32dd3f72f4d642ffc35befc03505417659ce8ca5487886032a8b34b23540b036ae7c93899445e286a5b8530a3967a9bb63b6412c8c0c0a58528bfc6009f04064768975736842749b904134b553995c3f6f26233104311337e62ab9505c97160210047429b79e6c1f6f846acbb45f012c6e0059755a6c56a645d4ab7a9944c1eb28c46235a20366a716a10430ecc6914f85e293764e85c48b6c16b68571cbbfbb073e97795817adf6ac75e4b3bccdaa525b52cc81c262c13c898e084a8c99e13b3b78621a6ceea81cc6c415a465189c6c4c486352d440d4b4b9fca36ca12a87d15535d46d7cfb7bc3138d25ada1a56b327b1e2b472fce2a42afc02ddbb27892526d5c44c65167794c31731c665c562a9d5946b58c4c5512a984a86a41ff1520957ae2d0524804924c3f5482d35671cc7bafa8cc2ab37786273967a856674d73cc143aeb8f5c7542404ba29a720ba4a062284a26c75c3d258cd321484d610241aa87fc54f65496ce9157eb67271617c69cb5151cffb876a46c291f4468b3c1c8487ae218442d8e4cdeab8692d3c95a8e9291e66701f5389e17a1542a25a97005e6d97c4187143f7ec689ee55d39ac4833096a59a6241a38c1f4c17ec2e655f1c539192c04f8738680863106f9bd1b0bbd83894cb1f47c1f3b7fe057a7548a1411b5872081673e208fbf2a21db3352dd8aaa4474b7b1486a58254d9ca74fbf14c991c969560acca8156d9be68d63c680ea279231fb1879a42b4018879d3a13dddb9fb2d98cc342bfaf3469402c67c2401935159bc9b88f742752455028fba25250c0652e48322d704eb19042966674286b3532b28aca870783e00faa825001aab6cfbcb80d22cbedb00062256b51d97940a647141cbc4a187f90432f34663ab9f24d1ee8affab2a093a026077814be79015dd638d116182b952056e03fd24625bc433da013397ebab3bf07540bf42a2e3c1a4083046b7c20b906a55a05ad6ee8949fd3493c976a49e321b59599f3e6a33d87365318256c556abd2344541aaeef30ce1464046187284d21463b254d0f7711c8f79f0e16390699321e54941c9493f697c8139253f5a12c69f770ac54ae92ac440a0c5f09110dedb4b5ffa15ea2c9a97677cbb92948764a6433ea16154c2c26760ca6527faa0b061f33aebc76a2aae658641c80f19345b716bf98b6a8a22b087d045e50d95c377a3d75f5b095276eb231b896176d66779e1d01814398b38e31c3ffdb23ceb553d6f7095b052e519276fc8a82af716d16d42e368003a00b7e85f96ed37a4b13c530d4097d29d7baf175060e8200956c04ef228098a70747a16bf0399dca129c5cc856e8e768432111ef4caf3966823d3283ff63065c68a45b3198605c006751432ed69b66a431a8920a00e23fc9c79a76520fc77618163c16dc8599f912ce83b7b3a6391557b0b081298da6b54c516015b2775de1d90e1c222f05f16f3305739725288e01300bd44830d06e0c7a2836e40ff358a771da754ad78ba6e27f8636702aa1ba4f764587bbab4985b52bf052f68c64e2f93be12c0140a3b662703fb6990aba90cfa4f86e0ee177d90a5e03b36f7d587f9f00a5adf7b2a7840f2a377afb8b80a523eb996fd66dcfc4595e07bb9890c3a68d6b21aa372dfe5403691999").ToBytes();
            var seedM = new BitString("1c2128409429e45849c43aac1a25d40ea77fe81d3e336003f0b59e4769da4e35").ToBytes();
            var expectedSharedSecretK = new BitString("1007bd67163ca5756ed5074033337135f7237af378573d6d4d0cf7d4b165d724").ToBytes();
            var expectedCiphertextC = new BitString("e794491fb4a55f9156bef2fea86d329cea0a9643c7070e6c596854ef7252bb9e9dba19776feaf53b1d447e42581c9c9fc53048c4a319975eee5919873eadbc77272131a20f63f89f0da811a28314dfd442db9a54fa8ae3af5ce980629cc71af25f4d15b815592fd357b79e1afaec75c5496cfb407ab8dfaba2d85e5fe3dec4e1dbba3feb1d74b91484448bcd6f29f1fe63523463e817dd9afc74e7acff1845727a3655d378177a07921f433a33e8e1baf79984e4f762833fc18fd515d94b83a1a39a257108b757120f12f704814262b99f2969443457c709ff6de4fc04bf16b3d3fd021437834cfa6a78238aba4d671564af52fe35857c6becfb8113f9f6116b9ca3e24458d15b2c85131bbc79b441e2a779705a8e18d09023922b994589691c964cdc9a70029f5e97d0e6048bf637fe58d065c2bc64e05ed323d756900858624efcba4182cda5d57cc05bc49bb829ad56c7d9bb67465c6ad1a696dfbb45ff61d72e6186115f8a1ff083f84c4f493683f11aad042008e0fc3ac5e1711c8b4fbbaf0e023cbc1e63670bb28c381b35e425d6d32231859645c9b57c5e1b69dcb1ab5124af3e41c98e32b43b818e5e9284c486892446f6dbb438babb65ebc440a6cd4d8bd9ceb7008563598abf0f50a8531a4a33553749e2a7d9bb6eb02c82dc38cd4e70473a47d2679a9ab805704f9ff9fdefc87b32e100ea11fd881e86c0e8e33442fa3e5088d9aaa109777bdff967a939fd49b8bd012abf567915b5c98a345e1952512a2b6554174a52432fbfea47b76b2b00b2e3469b14e926ec9ccef1352d34a07f6879000162aaab4a016aa1c006ff11f07355d610ada3a5b9748591b1006cdee9be311548afac7b0a8807a7285b49bd571ff0894a3edbcfe8a2abecd9224f5974332aeed20e775cd4b73ac21dac1fc5d08948a67702c7cb19cf98b4ceacb3d4daa5b7f46c2448a12ec625ee604b29eb226ffa93b5fc90b06c0c1a6e5b2eb8efe3637ec7f5a632f721661a5e10a7675c8e7567e06a36ad3b488dc2e71b91a7a73c694627d2ab574caf30ee7fcb6850ddc95e330f51fb725f4c6308817bedd348dd4a2217d5fffbe53d9202a4b173c9a6592df15c7727013971edae32d28c3d9a507047d5c7bac29d7cba48ffc4c22e40d7d07377e71339c0fe7f87449b7a31778cac5cb3fc8b6dc5ede0a9583be936a601258ee87483caa053e0465a5cea1286935427cb94e7e53975b15bd12b56ff56cc081dec561784cd936cf2191390de61f0df27b9ee53c58e1f17db18cb9a36d5f003dcf243dc1ddd48711e86e889f7361be2431d846caa6a245de06c2ff25fc7621ea883d345b3eeabad0fa03533b41d425c62e90af07cf8485eff380f2ecb014f2c3fc65dde82dd8f98cecd96ac160710c2694162e63f401a09fdffaca49b55b7938cec3daaf25939d833bf4be698eeb273afde62b02e3ba88cc75f7fa0d78b13678e25400d9909bb5142bc283539a9332f976a5c5b30b6c239ed58f455bf9fe917c0527f9d716190e99c7210a8c40dea0074f8fbfa6bcec77cabb24989f00a2094586f1277f09ce4c33ee058537144041481642e4f0b3f36f7130fa855543740e9b9b0430f73a38047e177bdd0873513b1438988524e7494cbdc2be135c8bf7ada7a7cf115ecf11fd1e0e746990ce08f6a3845aed46ef32cd455b6d6cb6d8b9563df55ac8477347460eb94df47e24b72284e6397459d8c274aaafc6c948bdabf92db8e033636818847ae454cd2bf98d7491b736e2a24ba5446a81bf56229ba225a645cd91dbcc898a09d7ee5a04ba3bf24e9ecf5d7f49e3be3fb882fe1980faa278597edd981849ab950d1669af008cf1720dd79fe0bf7406c5475a38753dc835483f4e1219c3628b25773a46d859e5006d45746253420b3ab6564d79fde33c21894c4e57dfbd881a78684d789eb83f2937a3171392ecf7a2fd4a003a4fa830e870948c2ebde933b8e803d50aa3804429d06333a2927c4a5376b6e520152f7ff5e042c765c781cf4087bf10bf5b1a730d2d9b0a01e2e8870e81a37e11cfcadf632134afb656f307bd67cc7efe131b5cbf43a3126f29097833394706b522cecbf25f0a10a07dfbd581ac0844abca512bf1a6e2c677eb4f5a34bb4e883ab603d89a9ef339cd29546cbc42fc47e5f7075f674c2a45db5b31e31b3e5819252ec2efeeb2340b84750c3fbb076c4aa728f").ToBytes();

            var kyberParameters = new NIST.CVP.ACVTS.Libraries.Crypto.Common.PQC.Kyber.KyberParameters(KyberParameterSet.ML_KEM_1024);
            var kyber = new Kyber(kyberParameters, new NativeShaFactory());

            var sharedSecret = kyber.Encapsulate(ek, seedM);
        }

        [Benchmark]
        public void Nist_Kyber1024_Exchange_Receiver()
        {
            var dk = new BitString("61315a1e2cad07563708a1476f23250f84187e63c5f693a7202c6114f3ca68dab330181a1ab49fcd49611ed9a2e924aab14958b8729e4ffb497873b52b711aec0a9b18d89c853208d6d4cf3b10ac0c0bc8df919366509d52e97d17720e9efc57c7d18030071648304331059b7bcc12c104236ce073f3f544fba2571f09245c5c1d0fa444617319fbac79b149097f21838f0c8977f5be93e53fece755a2f5b8bda1028f1b038b7c21ab49133351b47a08bb3df1b68be1a8e0c31695322aa7210093ca7ac31992fb603b5ca88c5ba934ec20ae6d34514c26a0bd68373c894054a01386ab3f38aa1009f3c72b6b3522417ffb4210861cbefc525ef1c43cac31b00b0c7869535b4ed807304b7271294c8b7b0b9e51bca7a25f87c7131f56a7884a1909761a1f7b2fc834b602d91cde345c4b9401bfa739791466af8812c07cc118d74e9e07cc1b197ee809c3091c175cf308de489d1b185694326c7f98bbaa694c01ecb2e7d712408472ea1375cfaa2be27b89ed0206d6116579f9b181337844fab678388a36f68abf596f2ce62744a16697f01eab2ccfce6ccab4ac19254bcff1830a36b135566b8fac07939fe47e67f726acd266152b361d68626ddc722309a4207c6c6aa95a6afb75cceb6fdc929628822767db06667a1cc458b30281a212dcbc49f52f4ce6afa2173e440a8493d41d0f05ce4091447691b65b10b3d3c94b098467d7228f351810135085ebc95b6ddc07718688f27b895e1588e31701471c455aa13718d6a23348b4659689d43145fa744dbe0a092d392bb13842db5505dcb3a8e436424705b2f5c094d7799c24342296f02ec64a71ca94b2a1437d39ca394a1115d0921202942b6bc53ba7684f8f787876abcc54749f4a93a62f577c3bda5ca79b0e28771c4ae6655be28dc65789b8685327c24c34d130e3573dd720626aa964565346bdecc165ca05b306ba20c384b54a05a343b13c1a7f8f2c297456b7fc0301bb591a18d93bf2238883d65f24f40b7aa43a5e1c9503124bd0b994225b24c48ca1ecbb1b2f620b61eb5a495946aa54c3700cb028e9408b003ff3dc293b98086f0968a4522fb69caacfc2943fbb3cbcc51894e3ba50278c02547293477293922fb806569824519c585be527c6653a94a9c13bd0603ef197245bb6197f292254fa4cf853b3de4b389a6b705bfb16ac909c50281b464079ab30cc6be27d28c5b7458c94ced1b809d60e9c147c22b1454eab5eef4890c1812da8816b352c2ec8f571f69b3449f1c9202a85a5f7bd7e35b896c9b82b72afd3b8c6b69191ca009c953ab9024a982948c00e14c79086c6b8678cf75a38dc7538fb105d21e2826efb78fb481256880d5e596abaa5449292b335337827292f6f33600d3c2eb61c91e1babcbc2c2e2df55a9be28b2e655d6ae8b3e4267cd0c84373173d94779b0c1092211b913cd114da536698a36eff8c4c3d808207f717b95bc0884142111556b7c5c6af127787428137141c0ea8780d5c0aa83021ae408487245f208b7a29f8512628c0db33c57bfa33bee02282e2a03e493f62e093dfc20ffbb1a22e85cd667b5a165c9d47963d7bf719bad908bcebcc330635b5ea57cb691abd5631fdc81a67d939d8d29008c538a336949687232e73bbd6c686e4fa770788736555a8e9f265c64699806a2d0951784af90573564e4046acb6a4b1cf638a66881b77a544c6b884f0e901d9682c7be04a8d88a7943bc7f35a2e6c39c36d8a5f20d2c53436482856175202b8f6b40db5251747fa15056c612f680f76d00789f73075b5974946ba69a6724fec4cf9b4ba09fc8d58a3931a78645b631b3145a7a26280cf2928575b19397b76f82cbc63c38ce1c044707b7461d20e63980e1fcb90000bbc299b9f0570c39f95a7607a576a957b81191377164bc0206bfc871b822a1364e615e76b20ac8c8f9543a169021d73b3b22725214bc00efce383f8000f7261ca4ee7ad8a866fcb5459ecc5812aca177f36874f246ffdb1676306c1bee620cca3cf8706a469225995f2504639c5bdec741c2263930c47bee9aa8752c60b03855e95cfc92136eff573346162d6479a0fb08edfc404f1d749fcc2400891bb3ff0b928e15a7b88b0b0042731bca304b7c5dbb74738600c1c54abfb35a019082e2575663e95c1d4c45664b6519b5316fcea01db6a0b6a297a1559cd52b73a984c589f9c58ee427f3af99c8c59835306ab67d0bb0cb411baca2766537143601f089450e0f8a064d60fc35780bf568a679807d847c29328731530194750940df077ec607c9fc4c581381207fc37de980a4857a9e3250bf1002fb1837634fac78ffb28d48bba64d65c1afc1c38d2b651324fd740a4fa622025f675a46905be76b05b276433e2176fb22dc7aa862c72314c38861e01302c56278c8388292a8754ec173b1bb5fff78aa8a49759244d7c3082eca9194b7a469e9291f9516822a26a82123d7289162f5c396c9781785940caca213116c126e71f98983c7eac761668ab8e911df9c4ba9fe825b0fb0b02613d99d697ddf7c9c9a7c0540a4597312d952142374910b4949fc5c60967464b81282628dbb6d387786e893819173418654e5776a64a212d8a7aa785a59493e38083f81190567ae08a6fb1ebb45f2641417a5b99d151cea994f8e7b4df9a1714b4983d7a0c58c55bf963af7d72cf508bb67d71565946781fb318d2eb31cff01efeb8a4e4bb02f7f32dd3f72f4d642ffc35befc03505417659ce8ca5487886032a8b34b23540b036ae7c93899445e286a5b8530a3967a9bb63b6412c8c0c0a58528bfc6009f04064768975736842749b904134b553995c3f6f26233104311337e62ab9505c97160210047429b79e6c1f6f846acbb45f012c6e0059755a6c56a645d4ab7a9944c1eb28c46235a20366a716a10430ecc6914f85e293764e85c48b6c16b68571cbbfbb073e97795817adf6ac75e4b3bccdaa525b52cc81c262c13c898e084a8c99e13b3b78621a6ceea81cc6c415a465189c6c4c486352d440d4b4b9fca36ca12a87d15535d46d7cfb7bc3138d25ada1a56b327b1e2b472fce2a42afc02ddbb27892526d5c44c65167794c31731c665c562a9d5946b58c4c5512a984a86a41ff1520957ae2d0524804924c3f5482d35671cc7bafa8cc2ab37786273967a856674d73cc143aeb8f5c7542404ba29a720ba4a062284a26c75c3d258cd321484d610241aa87fc54f65496ce9157eb67271617c69cb5151cffb876a46c291f4468b3c1c8487ae218442d8e4cdeab8692d3c95a8e9291e66701f5389e17a1542a25a97005e6d97c4187143f7ec689ee55d39ac4833096a59a6241a38c1f4c17ec2e655f1c539192c04f8738680863106f9bd1b0bbd83894cb1f47c1f3b7fe057a7548a1411b5872081673e208fbf2a21db3352dd8aaa4474b7b1486a58254d9ca74fbf14c991c969560acca8156d9be68d63c680ea279231fb1879a42b4018879d3a13dddb9fb2d98cc342bfaf3469402c67c2401935159bc9b88f742752455028fba25250c0652e48322d704eb19042966674286b3532b28aca870783e00faa825001aab6cfbcb80d22cbedb00062256b51d97940a647141cbc4a187f90432f34663ab9f24d1ee8affab2a093a026077814be79015dd638d116182b952056e03fd24625bc433da013397ebab3bf07540bf42a2e3c1a4083046b7c20b906a55a05ad6ee8949fd3493c976a49e321b59599f3e6a33d87365318256c556abd2344541aaeef30ce1464046187284d21463b254d0f7711c8f79f0e16390699321e54941c9493f697c8139253f5a12c69f770ac54ae92ac440a0c5f09110dedb4b5ffa15ea2c9a97677cbb92948764a6433ea16154c2c26760ca6527faa0b061f33aebc76a2aae658641c80f19345b716bf98b6a8a22b087d045e50d95c377a3d75f5b095276eb231b896176d66779e1d01814398b38e31c3ffdb23ceb553d6f7095b052e519276fc8a82af716d16d42e368003a00b7e85f96ed37a4b13c530d4097d29d7baf175060e8200956c04ef228098a70747a16bf0399dca129c5cc856e8e768432111ef4caf3966823d3283ff63065c68a45b3198605c006751432ed69b66a431a8920a00e23fc9c79a76520fc77618163c16dc8599f912ce83b7b3a6391557b0b081298da6b54c516015b2775de1d90e1c222f05f16f3305739725288e01300bd44830d06e0c7a2836e40ff358a771da754ad78ba6e27f8636702aa1ba4f764587bbab4985b52bf052f68c64e2f93be12c0140a3b662703fb6990aba90cfa4f86e0ee177d90a5e03b36f7d587f9f00a5adf7b2a7840f2a377afb8b80a523eb996fd66dcfc4595e07bb9890c3a68d6b21aa372dfe54036919997fc9ad8b08ddabf7cb7b3a5fef32d88dc3a06fbb1c20c1ef207571468701cfe61c2128409429e45849c43aac1a25d40ea77fe81d3e336003f0b59e4769da4e35").ToBytes();
            var c = new BitString("e794491fb4a55f9156bef2fea86d329cea0a9643c7070e6c596854ef7252bb9e9dba19776feaf53b1d447e42581c9c9fc53048c4a319975eee5919873eadbc77272131a20f63f89f0da811a28314dfd442db9a54fa8ae3af5ce980629cc71af25f4d15b815592fd357b79e1afaec75c5496cfb407ab8dfaba2d85e5fe3dec4e1dbba3feb1d74b91484448bcd6f29f1fe63523463e817dd9afc74e7acff1845727a3655d378177a07921f433a33e8e1baf79984e4f762833fc18fd515d94b83a1a39a257108b757120f12f704814262b99f2969443457c709ff6de4fc04bf16b3d3fd021437834cfa6a78238aba4d671564af52fe35857c6becfb8113f9f6116b9ca3e24458d15b2c85131bbc79b441e2a779705a8e18d09023922b994589691c964cdc9a70029f5e97d0e6048bf637fe58d065c2bc64e05ed323d756900858624efcba4182cda5d57cc05bc49bb829ad56c7d9bb67465c6ad1a696dfbb45ff61d72e6186115f8a1ff083f84c4f493683f11aad042008e0fc3ac5e1711c8b4fbbaf0e023cbc1e63670bb28c381b35e425d6d32231859645c9b57c5e1b69dcb1ab5124af3e41c98e32b43b818e5e9284c486892446f6dbb438babb65ebc440a6cd4d8bd9ceb7008563598abf0f50a8531a4a33553749e2a7d9bb6eb02c82dc38cd4e70473a47d2679a9ab805704f9ff9fdefc87b32e100ea11fd881e86c0e8e33442fa3e5088d9aaa109777bdff967a939fd49b8bd012abf567915b5c98a345e1952512a2b6554174a52432fbfea47b76b2b00b2e3469b14e926ec9ccef1352d34a07f6879000162aaab4a016aa1c006ff11f07355d610ada3a5b9748591b1006cdee9be311548afac7b0a8807a7285b49bd571ff0894a3edbcfe8a2abecd9224f5974332aeed20e775cd4b73ac21dac1fc5d08948a67702c7cb19cf98b4ceacb3d4daa5b7f46c2448a12ec625ee604b29eb226ffa93b5fc90b06c0c1a6e5b2eb8efe3637ec7f5a632f721661a5e10a7675c8e7567e06a36ad3b488dc2e71b91a7a73c694627d2ab574caf30ee7fcb6850ddc95e330f51fb725f4c6308817bedd348dd4a2217d5fffbe53d9202a4b173c9a6592df15c7727013971edae32d28c3d9a507047d5c7bac29d7cba48ffc4c22e40d7d07377e71339c0fe7f87449b7a31778cac5cb3fc8b6dc5ede0a9583be936a601258ee87483caa053e0465a5cea1286935427cb94e7e53975b15bd12b56ff56cc081dec561784cd936cf2191390de61f0df27b9ee53c58e1f17db18cb9a36d5f003dcf243dc1ddd48711e86e889f7361be2431d846caa6a245de06c2ff25fc7621ea883d345b3eeabad0fa03533b41d425c62e90af07cf8485eff380f2ecb014f2c3fc65dde82dd8f98cecd96ac160710c2694162e63f401a09fdffaca49b55b7938cec3daaf25939d833bf4be698eeb273afde62b02e3ba88cc75f7fa0d78b13678e25400d9909bb5142bc283539a9332f976a5c5b30b6c239ed58f455bf9fe917c0527f9d716190e99c7210a8c40dea0074f8fbfa6bcec77cabb24989f00a2094586f1277f09ce4c33ee058537144041481642e4f0b3f36f7130fa855543740e9b9b0430f73a38047e177bdd0873513b1438988524e7494cbdc2be135c8bf7ada7a7cf115ecf11fd1e0e746990ce08f6a3845aed46ef32cd455b6d6cb6d8b9563df55ac8477347460eb94df47e24b72284e6397459d8c274aaafc6c948bdabf92db8e033636818847ae454cd2bf98d7491b736e2a24ba5446a81bf56229ba225a645cd91dbcc898a09d7ee5a04ba3bf24e9ecf5d7f49e3be3fb882fe1980faa278597edd981849ab950d1669af008cf1720dd79fe0bf7406c5475a38753dc835483f4e1219c3628b25773a46d859e5006d45746253420b3ab6564d79fde33c21894c4e57dfbd881a78684d789eb83f2937a3171392ecf7a2fd4a003a4fa830e870948c2ebde933b8e803d50aa3804429d06333a2927c4a5376b6e520152f7ff5e042c765c781cf4087bf10bf5b1a730d2d9b0a01e2e8870e81a37e11cfcadf632134afb656f307bd67cc7efe131b5cbf43a3126f29097833394706b522cecbf25f0a10a07dfbd581ac0844abca512bf1a6e2c677eb4f5a34bb4e883ab603d89a9ef339cd29546cbc42fc47e5f7075f674c2a45db5b31e31b3e5819252ec2efeeb2340b84750c3fbb076c4aa728f").ToBytes();
            var expectedSharedSecretK = new BitString("1007bd67163ca5756ed5074033337135f7237af378573d6d4d0cf7d4b165d724").ToBytes();

            var kyberParameters = new NIST.CVP.ACVTS.Libraries.Crypto.Common.PQC.Kyber.KyberParameters(KyberParameterSet.ML_KEM_1024);
            var kyber = new Kyber(kyberParameters, new NativeShaFactory());

            var sharedSecret = kyber.Decapsulate(dk, c);
        }

        #region Curve25519_Signing

        [Benchmark]
        public void Ed25519_Signing()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                var signed = Ed25519Adapter.Instance.Sign(hash, ed25519_private);
            });
        }

        [Benchmark]
        public void Ed25519_Verification()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                var result = Ed25519Adapter.Instance.Verify(hash, ed25519_signed, ed25519_public);
            });
        }

        [Benchmark]
        public void Ed25519_KeyGeneration()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                Ed25519Adapter.GenerateKeyPair();
            });
        }

        [Benchmark]
        public void Ed448_Signing()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                var signed = Ed448Adapter.Instance.Sign(hash, ed448_private);
            });
        }

        [Benchmark]
        public void Ed448_Verification()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                var result = Ed448Adapter.Instance.Verify(hash, ed448_signed, ed448_public);
            });
        }

        [Benchmark]
        public void Ed448_KeyGeneration()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                Ed448Adapter.GenerateKeyPair();
            });
        }

        #endregion

        #region Curve25519_Agreement

        [Benchmark]
        public void X25519_KeyGeneration()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                X25519Adapter.GenerateKeyPair();
            });
        }

        [Benchmark]
        public void X25519_Exchange_Sender()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                // Create a secret with Alice's private key and Bob's public Key
                byte[] secret = new byte[32];
                var priv = (X25519PrivateKeyParameters)x25519_alice.Private;
                priv.GenerateSecret((X25519PublicKeyParameters)x25519_bob.Public, secret, 0);
            });
        }

        [Benchmark]
        public void X25519_Exchange_Receiver()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                byte[] secret2 = new byte[32];
                var priv2 = (X25519PrivateKeyParameters)x25519_bob.Private;
                priv2.GenerateSecret((X25519PublicKeyParameters)x25519_alice.Public, secret2, 0);
                var ismatch = Convert.ToBase64String(x25519_alice_secret) == Convert.ToBase64String(secret2);
            });
        }

        [Benchmark]
        public void X448_KeyGeneration()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                X448Adapter.GenerateKeyPair();
            });
        }

        [Benchmark]
        public void X448_Exchange_Sender()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                // Create a secret with Alice's private key and Bob's public Key
                byte[] secret = new byte[2456];
                var priv = (X448PrivateKeyParameters)x448_alice.Private;
                priv.GenerateSecret((X448PublicKeyParameters)x448_bob.Public, secret, 0);
            });
        }

        [Benchmark]
        public void X448_Exchange_Receiver()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                byte[] secret2 = new byte[2456];
                var priv2 = (X448PrivateKeyParameters)x448_bob.Private;
                priv2.GenerateSecret((X448PublicKeyParameters)x448_alice.Public, secret2, 0);
                var ismatch = Convert.ToBase64String(x448_alice_secret) == Convert.ToBase64String(secret2);
            });
        }

        #endregion

        #region Dilithium
        [Benchmark]
        public void Dilithium2_Signing()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                var signed = DilithiumAdapter.Instance.Sign(hash, dilithium2_private);
            });
        }

        [Benchmark]
        public void Dilithium2_Verification()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                var result = DilithiumAdapter.Instance.Verify(hash, dilithium2_signed, dilithium2_public);
            });
        }

        [Benchmark]
        public void Dilithium2_KeyGeneration()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                DilithiumAdapter.GenerateKeyPair(Org.BouncyCastle.Pqc.Crypto.Crystals.Dilithium.DilithiumParameters.Dilithium2);
            });
        }


        [Benchmark]
        public void Dilithium3_Signing()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                var signed = DilithiumAdapter.Instance.Sign(hash, dilithium3_private);
            });
        }

        [Benchmark]
        public void Dilithium3_Verification()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                var result = DilithiumAdapter.Instance.Verify(hash, dilithium3_signed, dilithium3_public);
            });
        }

        [Benchmark]
        public void Dilithium3_KeyGeneration()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                DilithiumAdapter.GenerateKeyPair();
            });
        }

        [Benchmark]
        public void Dilithium5_Signing()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                var signed = DilithiumAdapter.Instance.Sign(hash, dilithium5_private);
            });
        }

        [Benchmark]
        public void Dilithium5_Verification()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                var result = DilithiumAdapter.Instance.Verify(hash, dilithium5_signed, dilithium5_public);
            });
        }

        [Benchmark]
        public void Dilithium5_KeyGeneration()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                DilithiumAdapter.GenerateKeyPair(Org.BouncyCastle.Pqc.Crypto.Crystals.Dilithium.DilithiumParameters.Dilithium5);
            });
        }
        #endregion

        #region Kyber

        [Benchmark]
        public void Kyber512_KeyGeneration()
        {
            Parallel.For(0, threads, new ParallelOptions {  MaxDegreeOfParallelism = -1 }, iter =>
            {
                Mutex mutex = new Mutex(false, "Kyber_KeyGeneration");
                mutex.WaitOne();

                KyberAdapter.GenerateKeyPair();
                mutex.ReleaseMutex();
            });
        }

        [Benchmark]
        public void Kyber512_Exchange_Sender()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                Mutex mutex = new Mutex(false, "Oops");
                mutex.WaitOne();
                // Create a secret with Alice's private key and Bob's public Key
                var priv = (KyberPrivateKeyParameters)kyber512_alice.Private;
                var secret = KyberAdapter.GenerateSecret((KyberPublicKeyParameters)kyber512_bob.Public);

                mutex.ReleaseMutex();
            });
        }

        [Benchmark]
        public void Kyber512_Exchange_Receiver()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                Mutex mutex = new Mutex(false, "Oops");
                mutex.WaitOne();

                var kyber = new KyberKemExtractor((KyberPrivateKeyParameters)kyber512_bob.Private);
                var result = kyber.ExtractSecret(kyber512_alice_secret.GetEncapsulation());
                mutex.ReleaseMutex();

                var ismatch = Convert.ToBase64String(kyber512_alice_secret.GetSecret()) == Convert.ToBase64String(result);
            });
        }


        [Benchmark]
        public void Kyber768_KeyGeneration()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                Mutex mutex = new Mutex(false, "Kyber_KeyGeneration");
                mutex.WaitOne();

                KyberAdapter.GenerateKeyPair(Org.BouncyCastle.Pqc.Crypto.Crystals.Kyber.KyberParameters.kyber768);
                mutex.ReleaseMutex();
            });
        }

        [Benchmark]
        public void Kyber768_Exchange_Sender()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                Mutex mutex = new Mutex(false, "Oops");
                mutex.WaitOne();
                // Create a secret with Alice's private key and Bob's public Key
                var priv = (KyberPrivateKeyParameters)kyber768_alice.Private;
                var secret = KyberAdapter.GenerateSecret((KyberPublicKeyParameters)kyber768_bob.Public);
                mutex.ReleaseMutex();
            });
        }

        [Benchmark]
        public void Kyber768_Exchange_Receiver()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                Mutex mutex = new Mutex(false, "Oops");
                mutex.WaitOne();

                var kyber = new KyberKemExtractor((KyberPrivateKeyParameters)kyber768_bob.Private);
                var result = kyber.ExtractSecret(kyber768_alice_secret.GetEncapsulation());
                mutex.ReleaseMutex();

                var ismatch = Convert.ToBase64String(kyber768_alice_secret.GetSecret()) == Convert.ToBase64String(result);
            });
        }

        [Benchmark]
        public void Kyber1024_KeyGeneration()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                Mutex mutex = new Mutex(false, "Kyber_KeyGeneration");
                mutex.WaitOne();

                KyberAdapter.GenerateKeyPair(Org.BouncyCastle.Pqc.Crypto.Crystals.Kyber.KyberParameters.kyber1024);
                mutex.ReleaseMutex();
            });
        }

        [Benchmark]
        public void Kyber1024_Exchange_Sender()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                Mutex mutex = new Mutex(false, "Oops");
                mutex.WaitOne();
                // Create a secret with Alice's private key and Bob's public Key
                var priv = (KyberPrivateKeyParameters)kyber1024_alice.Private;
                var secret = KyberAdapter.GenerateSecret((KyberPublicKeyParameters)kyber1024_bob.Public);
                mutex.ReleaseMutex();
            });
        }

        [Benchmark]
        public void Kyber1024_Exchange_Receiver()
        {
            Parallel.For(0, threads, new ParallelOptions { MaxDegreeOfParallelism = -1 }, iter =>
            {
                Mutex mutex = new Mutex(false, "Oops");
                mutex.WaitOne();

                var kyber = new KyberKemExtractor((KyberPrivateKeyParameters)kyber1024_bob.Private);
                var result = kyber.ExtractSecret(kyber1024_alice_secret.GetEncapsulation());
                mutex.ReleaseMutex();

                var ismatch = Convert.ToBase64String(kyber1024_alice_secret.GetSecret()) == Convert.ToBase64String(result);
            });
        }
        #endregion
    }
}
